<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>GRLS neoplasia overview</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="GRLS exploratory_files/libs/clipboard/clipboard.min.js"></script>
<script src="GRLS exploratory_files/libs/quarto-html/quarto.js"></script>
<script src="GRLS exploratory_files/libs/quarto-html/popper.min.js"></script>
<script src="GRLS exploratory_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="GRLS exploratory_files/libs/quarto-html/anchor.min.js"></script>
<link href="GRLS exploratory_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="GRLS exploratory_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="GRLS exploratory_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="GRLS exploratory_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="GRLS exploratory_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">GRLS neoplasia overview</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="grls-exploratory-analyses" class="level1">
<h1>GRLS exploratory analyses</h1>
<section id="neoplasia-and-endpoints-datasets" class="level2">
<h2 class="anchored" data-anchor-id="neoplasia-and-endpoints-datasets">Neoplasia and endpoints datasets</h2>
<p>Initial examination of neoplasia and end points datasets from GRLS. Neoplasia dataset includes a record for all dogs for all years there is a study questionaire returned and endpoints is cause of death (any cause) for dogs</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyverse' was built under R version 4.3.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggplot2' was built under R version 4.3.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tibble' was built under R version 4.3.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyr' was built under R version 4.3.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'readr' was built under R version 4.3.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'purrr' was built under R version 4.3.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'dplyr' was built under R version 4.3.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'stringr' was built under R version 4.3.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'forcats' was built under R version 4.3.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'lubridate' was built under R version 4.3.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">#neoplasia file from grls</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"C:/Users/ctaylor18/GitHub/GRLS_analyses/Data"</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">#neoplasia &lt;- read.csv(file="Data/conditions_neoplasia.csv")</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">#having to do absolute directory currently?</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>neoplasia<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"C:/Users/ctaylor18/GitHub/GRLS_analyses/Data/conditions_neoplasia.csv"</span>,<span class="at">na.strings=</span><span class="fu">c</span> (<span class="st">""</span>, <span class="st">"NA"</span>))</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">#end_points &lt;- read.csv(file="Data/study_endpoints.csv")</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>end_points <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file=</span><span class="st">"C:/Users/ctaylor18/GitHub/GRLS_analyses/Data/study_endpoints.csv"</span>,<span class="at">na.strings=</span><span class="fu">c</span> (<span class="st">""</span>, <span class="st">"NA"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="explore-end-points" class="level2">
<h2 class="anchored" data-anchor-id="explore-end-points">Explore end points</h2>
<p>‘malignancy and cause of death’ dataset (‘study_endpoints.csv’)</p>
<p>Major columns of interest:</p>
<ul>
<li><p>date of diagnosis(‘diagnosis_date’ or ‘diagnosis_year_month’)</p></li>
<li><p>condition that has led to death(‘tracked_condition’)</p></li>
<li><p>tier of confidence of diagnosis (‘tier_of_confidence’)</p></li>
<li><p>is this tracked condition the cause of death (‘is_cause_of_death’)</p></li>
<li><p>is the cause of death a recurrence (‘is_recurrence’)</p></li>
</ul>
<p><u>There are 958 dogs in this dataset, I <em>think</em></u> of these 690 of these have confirmed death (remaining maybe are un-enrolled/inactive)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># number of different outcomes and what most common</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>end_points <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(tracked_condition) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Frequency =</span> <span class="fu">n</span>()</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(Frequency))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 157 × 2
   tracked_condition                         Frequency
   &lt;chr&gt;                                         &lt;int&gt;
 1 Mast cell tumor - cutaneous                     129
 2 Hemangiosarcoma - splenic                       109
 3 Hemangiosarcoma - cardiac                       101
 4 Lymphoma - multicentric                          92
 5 Hemangiosarcoma - visceral                       48
 6 Soft tissue sarcoma - other/not specified        40
 7 Histiocytic sarcoma                              39
 8 Hemangiosarcoma - other/not specified            30
 9 Mast cell tumor - subcutaneous                   25
10 Unknown                                          25
# ℹ 147 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>uniqueIDs_endpoints <span class="ot">&lt;-</span> <span class="fu">unique</span>(end_points<span class="sc">$</span>subject_id)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># dogs where the disease is recorded as cause of death</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>died <span class="ot">&lt;-</span> end_points <span class="sc">%&gt;%</span> <span class="fu">filter</span>(is_cause_of_death<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>uniqueID_died <span class="ot">&lt;-</span> <span class="fu">unique</span>(died<span class="sc">$</span>subject_id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Main end points are neoplasia - of these MCT, HSA and lymphoma are major ones. This end points seperates out all different kinds of neoplasias by location so see which are major once grouped. Three groups created here (NB. groups overlap):</p>
<p>- those that died with a neoplasia diagnosis (NOT necessarily that they died of the neoplasia, some have multiple neoplasia at also) = 812 dogs</p>
<p>- those that died due to their diagnosed neoplasia = 526 dogs</p>
<p>- those that died without a neoplasia diagnosis = 164?</p>
<p>Seperate out all those that died of neoplasia:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#make all data lower case as ignore case not working</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>end_points <span class="ot">&lt;-</span> end_points <span class="sc">%&gt;%</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), tolower))</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>uniqueIDs_anydeath <span class="ot">&lt;-</span> <span class="fu">unique</span>(end_points<span class="sc">$</span>subject_id)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"># seperate out only neoplasia deaths with key words</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>neoplasia_at_death <span class="ot">&lt;-</span> end_points <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">'tumor|oma|leuk|neopla'</span>,tracked_condition),<span class="at">ignore.case=</span><span class="cn">TRUE</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>uniqueIDs_neoplasia_at_death <span class="ot">&lt;-</span> <span class="fu">unique</span>(neoplasia_at_death<span class="sc">$</span>subject_id)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co">#812/958 dogs had a diagnosed neoplasia at time of death</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co">#write csv of all dogs that had a neoplasia diagnosis at death</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(neoplasia_at_death, <span class="st">"C:/Users/ctaylor18/GitHub/GRLS_analyses/Data/GRLS_neoplasia_at_death.csv"</span>)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co">#death due to neoplasia</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>neoplasia_death <span class="ot">&lt;-</span> neoplasia_at_death <span class="sc">%&gt;%</span> <span class="fu">filter</span>(is_cause_of_death <span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>uniqueIDs_neoplasia_death <span class="ot">&lt;-</span> <span class="fu">unique</span>(neoplasia_death<span class="sc">$</span>subject_id)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="co">#526 dogs</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="co">#write csv for all dogs that had a neoplasia as cause of death</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(neoplasia_death,<span class="st">"C:/Users/ctaylor18/GitHub/GRLS_analyses/Data/GRLS_neoplasia_death.csv"</span>)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="co"># and non neoplastic deaths</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>non_neoplastic_death <span class="ot">&lt;-</span> end_points <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">'tumor|oma|leuk|neopla'</span>,tracked_condition),<span class="at">ignore.case=</span><span class="cn">TRUE</span>)</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#alternative way to get the non neoplastic deaths but </span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="co">#non_neoplastic_death2 &lt;- merge(non_neoplastic_death,neoplasia_death,  by = "subject_id", all.x = TRUE)</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>non_neoplastic_death <span class="ot">&lt;-</span> non_neoplastic_death <span class="sc">%&gt;%</span> <span class="fu">filter</span>(is_cause_of_death <span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>uniqueIDs_nonneoplasia <span class="ot">&lt;-</span> <span class="fu">unique</span>(non_neoplastic_death<span class="sc">$</span>subject_id)</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a><span class="co">#164 dogs</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(non_neoplastic_death,<span class="st">"C:/Users/ctaylor18/GitHub/GRLS_analyses/Data/GRLS_non_neoplasia_death.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>958 dogs in the endpoints database - of these 526 have neoplasia as cause of death =54%</p>
<section id="dogs-with-a-neoplasia-diagnosis-at-death" class="level3">
<h3 class="anchored" data-anchor-id="dogs-with-a-neoplasia-diagnosis-at-death">Dogs with a neoplasia diagnosis at death</h3>
<p>Split the 812 dogs that had a neoplasia diagnosis at death by what type of neoplasia was diagnosed:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#sort out into types of neoplasia - lymphomas, HSAs, mast cells, sarcomas etc.</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>neoplasia_at_death <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(tracked_condition) <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Frequency =</span> <span class="fu">n</span>()</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(Frequency))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 2
   tracked_condition                         Frequency
   &lt;chr&gt;                                         &lt;int&gt;
 1 mast cell tumor - cutaneous                     129
 2 hemangiosarcoma - splenic                       109
 3 hemangiosarcoma - cardiac                       101
 4 lymphoma - multicentric                          92
 5 hemangiosarcoma - visceral                       48
 6 soft tissue sarcoma - other/not specified        40
 7 histiocytic sarcoma                              39
 8 hemangiosarcoma - other/not specified            30
 9 mast cell tumor - subcutaneous                   25
10 unknown neoplasia                                24
# ℹ 77 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#mast cells</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>mct <span class="ot">&lt;-</span> neoplasia_at_death <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">'mast'</span>,tracked_condition),<span class="at">ignore.case=</span><span class="cn">TRUE</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co">#lymphomas</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>lymphoma <span class="ot">&lt;-</span> neoplasia_at_death <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">'lymph'</span>,tracked_condition),<span class="at">ignore.case=</span><span class="cn">TRUE</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co">#haemangioasarcomas</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>hsa <span class="ot">&lt;-</span> neoplasia_at_death <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">'hema'</span>,tracked_condition),<span class="at">ignore.case=</span><span class="cn">TRUE</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co">#osteosarc</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>osteosarc  <span class="ot">&lt;-</span> neoplasia_at_death <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">'osteo'</span>,tracked_condition),<span class="at">ignore.case=</span><span class="cn">TRUE</span>)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co">#mammary masses</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co">#mammary  &lt;- neoplasia_at_death %&gt;% filter(grepl('mamm',tracked_condition),ignore.case=TRUE)</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="co">#melanoma </span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>melanoma <span class="ot">&lt;-</span> neoplasia_at_death <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">'melan'</span>,tracked_condition),<span class="at">ignore.case=</span><span class="cn">TRUE</span>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="co">#miscellaneous/less frequent tumours</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>lessFreqTumours <span class="ot">&lt;-</span> neoplasia_at_death <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">'mast|lymph|hema|osteo|melan'</span>,tracked_condition),<span class="at">ignore.case=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Within each tumour group what are most common types:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#mct</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>mct <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(tracked_condition) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Proportion =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  tracked_condition                         n Proportion
  &lt;chr&gt;                                 &lt;int&gt;      &lt;dbl&gt;
1 mast cell tumor - cutaneous             129     0.763 
2 mast cell tumor - subcutaneous           25     0.148 
3 mast cell tumor - other/not specified    15     0.0888</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(mct)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 169</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#lypmhoma</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>lymphoma <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(tracked_condition) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Proportion =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  tracked_condition                  n Proportion
  &lt;chr&gt;                          &lt;int&gt;      &lt;dbl&gt;
1 lymphoma - multicentric           92     0.708 
2 lymphoma - gastrointestinal       15     0.115 
3 lymphoma - other/not specified    15     0.115 
4 lymphoma - cutaneous               8     0.0615</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(lymphoma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 130</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#hsa</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>hsa <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(tracked_condition) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Proportion =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  tracked_condition                         n Proportion
  &lt;chr&gt;                                 &lt;int&gt;      &lt;dbl&gt;
1 hemangiosarcoma - splenic               109     0.362 
2 hemangiosarcoma - cardiac               101     0.336 
3 hemangiosarcoma - visceral               48     0.159 
4 hemangiosarcoma - other/not specified    30     0.0997
5 hemangiosarcoma - cutaneous              13     0.0432</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(hsa)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 301</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#osteosarc</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>osteosarc <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(tracked_condition) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Proportion =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  tracked_condition                    n Proportion
  &lt;chr&gt;                            &lt;int&gt;      &lt;dbl&gt;
1 osteosarcoma - appendicular         12      0.632
2 osteosarcoma - axial                 5      0.263
3 osteosarcoma - other/unspecified     2      0.105</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(osteosarc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 19</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#melanoma</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>melanoma <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(tracked_condition) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Proportion =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  tracked_condition      n Proportion
  &lt;chr&gt;              &lt;int&gt;      &lt;dbl&gt;
1 malignant melanoma    20      0.690
2 cutaneous melanoma     6      0.207
3 oral melanoma          3      0.103</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(melanoma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 29</code></pre>
</div>
</div>
</section>
<section id="dogs-that-died-due-to-neoplasia" class="level3">
<h3 class="anchored" data-anchor-id="dogs-that-died-due-to-neoplasia">Dogs that died due to neoplasia</h3>
<p>526 dogs that died due to their neoplasia</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">#sort out into types of neoplasia - lymphomas, HSAs, mast cells, sarcomas etc.</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>neoplasia_death <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(tracked_condition) <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Frequency =</span> <span class="fu">n</span>()</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(Frequency))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 65 × 2
   tracked_condition                     Frequency
   &lt;chr&gt;                                     &lt;int&gt;
 1 hemangiosarcoma - splenic                    92
 2 hemangiosarcoma - cardiac                    88
 3 lymphoma - multicentric                      57
 4 hemangiosarcoma - visceral                   43
 5 histiocytic sarcoma                          33
 6 hemangiosarcoma - other/not specified        24
 7 unknown neoplasia                            19
 8 lymphoma - gastrointestinal                  12
 9 brain tumor                                  10
10 leukemia                                     10
# ℹ 55 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#mast cells</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>mct_death <span class="ot">&lt;-</span> neoplasia_death <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">'mast'</span>,tracked_condition),<span class="at">ignore.case=</span><span class="cn">TRUE</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co">#lymphomas</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>lymphoma_death <span class="ot">&lt;-</span> neoplasia_death <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">'lymph'</span>,tracked_condition),<span class="at">ignore.case=</span><span class="cn">TRUE</span>)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="co">#haemangioasarcomas</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>hsa_death <span class="ot">&lt;-</span> neoplasia_death <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">'hema'</span>,tracked_condition),<span class="at">ignore.case=</span><span class="cn">TRUE</span>)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="co">#osteosarc</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>osteosarc_death  <span class="ot">&lt;-</span> neoplasia_death <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">'osteo'</span>,tracked_condition),<span class="at">ignore.case=</span><span class="cn">TRUE</span>)</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="co">#mammary masses</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="co">#mammary  &lt;- neoplasia_death %&gt;% filter(grepl('mamm',tracked_condition),ignore.case=TRUE)</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="co">#melanoma </span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>melanoma_death <span class="ot">&lt;-</span> neoplasia_death <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">'melan'</span>,tracked_condition),<span class="at">ignore.case=</span><span class="cn">TRUE</span>)</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a><span class="co">#miscellaneous/less frequent tumours</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>lessFreqTumours_death <span class="ot">&lt;-</span> neoplasia_death <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">'mast|lymph|hema|osteo|melan'</span>,tracked_condition),<span class="at">ignore.case=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#mct</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>mct_death <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(tracked_condition) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Proportion =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  tracked_condition                         n Proportion
  &lt;chr&gt;                                 &lt;int&gt;      &lt;dbl&gt;
1 mast cell tumor - cutaneous               8      0.5  
2 mast cell tumor - other/not specified     5      0.312
3 mast cell tumor - subcutaneous            3      0.188</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(mct_death)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">#lypmhoma</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>lymphoma_death <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(tracked_condition) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Proportion =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  tracked_condition                  n Proportion
  &lt;chr&gt;                          &lt;int&gt;      &lt;dbl&gt;
1 lymphoma - multicentric           57     0.704 
2 lymphoma - gastrointestinal       12     0.148 
3 lymphoma - other/not specified    10     0.123 
4 lymphoma - cutaneous               2     0.0247</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(lymphoma_death)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 81</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">#hsa</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>hsa_death <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(tracked_condition) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Proportion =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  tracked_condition                         n Proportion
  &lt;chr&gt;                                 &lt;int&gt;      &lt;dbl&gt;
1 hemangiosarcoma - splenic                92    0.371  
2 hemangiosarcoma - cardiac                88    0.355  
3 hemangiosarcoma - visceral               43    0.173  
4 hemangiosarcoma - other/not specified    24    0.0968 
5 hemangiosarcoma - cutaneous               1    0.00403</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(hsa_death)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 248</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">#osteosarc</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>osteosarc_death <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(tracked_condition) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Proportion =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  tracked_condition                    n Proportion
  &lt;chr&gt;                            &lt;int&gt;      &lt;dbl&gt;
1 osteosarcoma - appendicular          6      0.5  
2 osteosarcoma - axial                 4      0.333
3 osteosarcoma - other/unspecified     2      0.167</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(osteosarc_death)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">#melanoma</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>melanoma_death <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(tracked_condition) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Proportion =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  tracked_condition      n Proportion
  &lt;chr&gt;              &lt;int&gt;      &lt;dbl&gt;
1 malignant melanoma     7          1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(melanoma_death)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7</code></pre>
</div>
</div>
</section>
</section>
<section id="dogs-with-neoplasia-diagnosis-ever" class="level2">
<h2 class="anchored" data-anchor-id="dogs-with-neoplasia-diagnosis-ever">Dogs with neoplasia diagnosis ever?</h2>
<p>Explore neoplasia records (this will include neoplastic end points and also dogs still alive with neoplasia)</p>
<p>(‘conditions_neoplasia.csv’).</p>
<p>Main columns of interest:</p>
<ul>
<li>date of questionaire (‘record_date’)</li>
<li>new or pre-existing neoplasia (‘to_date’) - 0 = neoplasia diagnosed only in that study year 1= all neoplasia diagnosed from baseline to that study year</li>
<li>any co-morbidities (‘any’) - 0= no neoplasia diagnosed, 1= neoplasia diagnosed</li>
<li>columns describing location of tumour (‘adrenal’ -&gt; ‘thyroid’)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">#number of individual dogs in DF (all GRs)</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>uniqueIDs <span class="ot">&lt;-</span> <span class="fu">unique</span>(neoplasia<span class="sc">$</span>subject_id)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="co">#retain only records where 'any' column has a 1 in it</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>neoplasiaAnytime <span class="ot">&lt;-</span> neoplasia <span class="sc">%&gt;%</span> <span class="fu">filter</span>(any<span class="sc">==</span><span class="dv">1</span> <span class="sc">|</span> to_date<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>uniqueNeoplasia <span class="ot">&lt;-</span> <span class="fu">unique</span>(neoplasiaAnytime<span class="sc">$</span>subject_id)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(neoplasiaAnytime)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>3044 dogs with 66968 records (represents up until 05/23, of these 402 dogs, with 2574 records, had cancer at some point in study</p>
<p>Most common neoplasia location (NB. this table just includes each row recording a neoplasia, not seperated out by indiv dogs so some rows will just be same neoplasia max 10x) :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NOT WORKING CURRENTLY</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> each column <span class="cf">in</span> neoplasiaAnytime count the number of unique patient IDs</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>cancer_counts <span class="ot">&lt;-</span> neoplasiaAnytime <span class="sc">%&gt;%</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="sc">~</span><span class="fu">n_distinct</span>(subject_id[.<span class="sc">==</span><span class="dv">1</span>]), <span class="at">.names =</span> <span class="st">"patient_count_{.col}"</span>))</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>neoplasia_anytime <span class="ot">&lt;-</span> neoplasiaAnytime <span class="sc">%&gt;%</span> </span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(subject_id) </span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>count_result <span class="ot">&lt;-</span> neoplasia_anytime <span class="sc">%&gt;%</span></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="fu">across</span>(start_column<span class="sc">:</span>end_column))<span class="sc">%&gt;%</span></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n_distinct</span>(subject_id[. <span class="sc">&gt;=</span> <span class="dv">1</span>]))</span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a><span class="co"># counts for each column of if tumour is in this location (0 or 1)</span></span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>locations <span class="ot">&lt;-</span> neoplasia_anytime <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="fu">across</span>(adrenal_tumor<span class="sc">:</span>other,sum))</span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a><span class="co"># how many records per patient with each tumour type in it </span></span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a>record_per_patient_each_neoplasia <span class="ot">&lt;-</span> locations <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(subject_id) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="fu">across</span>(adrenal_tumor<span class="sc">:</span>other,sum))</span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a><span class="co">#convert the wide locations table to a long table and sort by largest number of neoplasias first</span></span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a>locationsLong <span class="ot">&lt;-</span> locations <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="st">'adrenal_tumor'</span><span class="sc">:</span><span class="st">'other'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span> (<span class="fu">desc</span>(value))</span>
<span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-32"><a href="#cb64-32" aria-hidden="true" tabindex="-1"></a>locationsLong</span>
<span id="cb64-33"><a href="#cb64-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-34"><a href="#cb64-34" aria-hidden="true" tabindex="-1"></a><span class="co"># how many records per patient with each tumour type in it </span></span>
<span id="cb64-35"><a href="#cb64-35" aria-hidden="true" tabindex="-1"></a>record_per_patient_each_neoplasia <span class="ot">&lt;-</span> locationsLong <span class="sc">%&gt;%</span> </span>
<span id="cb64-36"><a href="#cb64-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(value <span class="sc">&gt;</span> <span class="dv">0</span>) </span>
<span id="cb64-37"><a href="#cb64-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-38"><a href="#cb64-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-39"><a href="#cb64-39" aria-hidden="true" tabindex="-1"></a><span class="co">#table with number of dogs with each neoplasia</span></span>
<span id="cb64-40"><a href="#cb64-40" aria-hidden="true" tabindex="-1"></a>no_dogs_each_neoplasia <span class="ot">&lt;-</span> locationsLong <span class="sc">%&gt;%</span></span>
<span id="cb64-41"><a href="#cb64-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span></span>
<span id="cb64-42"><a href="#cb64-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb64-43"><a href="#cb64-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-44"><a href="#cb64-44" aria-hidden="true" tabindex="-1"></a><span class="co">#table with cancer type and patient IDs matching it</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ones we can likely do analyses with (&gt;100 cases) - mast cell tumor, hemangiosarc, lymphoma, soft tissue sarcoma, melanoma, eye tumor</p>
</section>
<section id="medications" class="level2">
<h2 class="anchored" data-anchor-id="medications">Medications</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#load in medications dataset and explore</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>medications <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file=</span><span class="st">"C:/Users/ctaylor18/GitHub/GRLS_analyses/Data/medications.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 42667 Columns: 19
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (15): subject_id, record_date, dose, dose_unit, dose_unit_specify, durat...
dbl  (4): year_in_study, specify_days, specify_hours, any_medications

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>medications <span class="ot">&lt;-</span> medications <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), tolower))</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(medications)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 19
  subject_id year_in_study record_date dose   dose_unit dose_unit_specify
  &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;            
1 094-000019             2 2014-12     500    mg        &lt;NA&gt;             
2 094-000019             2 2014-12     75-100 mg        &lt;NA&gt;             
3 094-000019             2 2014-12     12     ml        &lt;NA&gt;             
4 094-000019             2 2014-12     460    mg        &lt;NA&gt;             
5 094-000019             2 2014-12     1      iu        &lt;NA&gt;             
6 094-000019             4 2016-12     300    mg        &lt;NA&gt;             
# ℹ 13 more variables: duration &lt;chr&gt;, duration_unit &lt;chr&gt;, frequency &lt;chr&gt;,
#   frequency_specify &lt;chr&gt;, specify_days &lt;dbl&gt;, specify_hours &lt;dbl&gt;,
#   administration_method &lt;chr&gt;, administration_method_specify &lt;chr&gt;,
#   medication_name &lt;chr&gt;, medication_name_specify &lt;chr&gt;, status &lt;chr&gt;,
#   medication_ingredients &lt;chr&gt;, any_medications &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co">#missing data</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>missing.values_meds <span class="ot">&lt;-</span> medications <span class="sc">%&gt;%</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"key"</span>, <span class="at">value =</span> <span class="st">"val"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">is.missing =</span> <span class="fu">is.na</span>(val)) <span class="sc">%&gt;%</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(key, is.missing) <span class="sc">%&gt;%</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">num.missing =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(is.missing<span class="sc">==</span>T) <span class="sc">%&gt;%</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>is.missing) <span class="sc">%&gt;%</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>((num.missing)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'key'. You can override using the `.groups`
argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>missing_value_meds <span class="ot">&lt;-</span> missing.values_meds <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Proportion =</span> num.missing <span class="sc">/</span> <span class="fu">nrow</span>(medications) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>missing_value_meds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 3
# Groups:   key [15]
   key                           num.missing Proportion
   &lt;chr&gt;                               &lt;int&gt;      &lt;dbl&gt;
 1 frequency                              54      0.127
 2 dose_unit                             219      0.513
 3 medication_ingredients                237      0.555
 4 dose                                  664      1.56 
 5 duration                             1571      3.68 
 6 administration_method               14695     34.4  
 7 medication_name                     16745     39.2  
 8 duration_unit                       20933     49.1  
 9 medication_name_specify             22024     51.6  
10 dose_unit_specify                   33152     77.7  
11 frequency_specify                   33315     78.1  
12 specify_days                        33780     79.2  
13 status                              38680     90.7  
14 administration_method_specify       41806     98.0  
15 specify_hours                       42453     99.5  </code></pre>
</div>
</div>
<p>Lots of missing data on dosage, admin method etc. but majority records have got the active ingredient administered there - this is in varying states in a few columns:</p>
<ul>
<li><p>medication_ingredients - missing 0.5%</p></li>
<li><p>medication_name - missing 39%</p></li>
<li><p>medication_name_specify - missing 51.6%</p></li>
</ul>
<p>Frequency and dose also reasonably low proportion missing also</p>
<p>Most common medications administered:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co">#which medications administered most frequently</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>freq_meds <span class="ot">&lt;-</span> medications <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(medication_ingredients)<span class="sc">%&gt;%</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">Frequency =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Frequency))</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>freq_meds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 771 × 2
   medication_ingredients       Frequency
   &lt;chr&gt;                            &lt;int&gt;
 1 ivermectin, pyrantel pamoate      4084
 2 afoxolaner                        1727
 3 lufenuron, milbemycin oxime       1603
 4 carprofen                         1597
 5 metronidazole                     1337
 6 ivermectin                        1242
 7 oclacitinib                       1128
 8 milbemycin oxime                  1050
 9 fluralaner                         951
10 cefpodoxime proxetil               927
# ℹ 761 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co">#number of medication events per dog</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>meds_per_dog <span class="ot">&lt;-</span> medications<span class="sc">%&gt;%</span><span class="fu">group_by</span>(subject_id) <span class="sc">%&gt;%</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">medication_administrations =</span> <span class="fu">sum</span>(any_medications))<span class="sc">%&gt;%</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(medication_administrations))</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>meds_per_dog</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,881 × 2
   subject_id medication_administrations
   &lt;chr&gt;                           &lt;dbl&gt;
 1 094-000035                        116
 2 094-003644                        107
 3 094-002389                         94
 4 094-003149                         86
 5 094-008046                         78
 6 094-025967                         78
 7 094-000625                         77
 8 094-013089                         77
 9 094-015508                         75
10 094-016741                         75
# ℹ 2,871 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co">#avg medication events per dog</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(meds_per_dog<span class="sc">$</span>medication_administrations)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14.80979</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot of meds with &gt;100 administrations in database</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>freq_meds_100 <span class="ot">&lt;-</span> freq_meds <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Frequency <span class="sc">&gt;=</span> <span class="dv">100</span>)<span class="sc">%&gt;%</span>    </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">medication_ingredients=</span><span class="fu">fct_reorder</span>(medication_ingredients,<span class="fu">desc</span>(Frequency))) </span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="co">#only keep first 20 char of ingredient for plot, have to remove commas first or else NA</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="co">#freq_meds_100$medication_ingredient_trunc &lt;- gsub(",","",freq_meds_100$medication_ingredients)</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a><span class="co">#str_length(freq_meds_100$medication_ingredients)</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a><span class="co">#freq_meds_100$medication_ingredient_trunc &lt;- str_trunc(freq_meds_100$medication_ingredients,10,"right")  </span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>meds100 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>freq_meds_100, <span class="fu">aes</span>(<span class="at">x=</span>medication_ingredients, <span class="at">y=</span>Frequency)) <span class="sc">+</span></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">fill=</span><span class="st">"steelblue"</span>, <span class="at">width=</span>.<span class="dv">4</span>)<span class="sc">+</span></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Drug"</span>,</span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Frequency"</span>,</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Drugs administered to GRLS with &gt;100 administrations"</span></span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">0</span>)))<span class="sc">+</span></span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>,<span class="at">size=</span><span class="dv">4</span>))</span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>meds100</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GRLS-exploratory_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Most commonly administered medications are parasite treatments, NSAIDs and an AB: ivermectin, afoxolaner, lufenuron, carprofen, metronidazole.</p>
<p>These meds require some grouping/organising potentially eg. lufenuron,milbemycin oxime is one medication and milbemycin oxime is seperate (reflects different pharmaceutical products) &lt;- have a think about how to approach this / see what the January data update from Morris is like</p>
<p>2881 dogs have a recorded med administered - range 1-116 mean 14.8 treatments.</p>
<ul>
<li><p>Plan: Group broadly by class of drug initially (eg antimicrobial, endoparasite Tx, ectoparasite tx etc.)</p>
<ul>
<li>if interesting results found can group at lower level eg. type of antimicrobial</li>
<li>create a cumulative exposure variable - number of treatments in X years prior to cancer diagnosis (eg. number of ABs in the 5? years prior to diagnosis?)</li>
</ul></li>
</ul>
</section>
<section id="vaccinations" class="level2">
<h2 class="anchored" data-anchor-id="vaccinations">Vaccinations</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co">#load in medications dataset and explore</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>vaccinations <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file=</span><span class="st">"C:/Users/ctaylor18/GitHub/GRLS_analyses/Data/vaccines.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 81870 Columns: 11
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (8): subject_id, record_date, administered, lot, manufacturer, manufactu...
dbl (3): year_in_study, titer_evaluated, vaccine_ever

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>vaccinations <span class="ot">&lt;-</span> vaccinations <span class="sc">%&gt;%</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), tolower))</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(vaccinations)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 11
  subject_id year_in_study record_date administered lot     manufacturer        
  &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;               
1 094-000019             0 2012-11     2011-1-17    0000000 pfizer animal health
2 094-000019             0 2012-11     2012-8-6     1164152 merial              
3 094-000019             1 2013-12     &lt;NA&gt;         &lt;NA&gt;    &lt;NA&gt;                
4 094-000019             1 2013-12     &lt;NA&gt;         &lt;NA&gt;    &lt;NA&gt;                
5 094-000019             2 2014-12     &lt;NA&gt;         &lt;NA&gt;    &lt;NA&gt;                
6 094-000019             2 2014-12     &lt;NA&gt;         &lt;NA&gt;    &lt;NA&gt;                
# ℹ 5 more variables: manufacturer_other_specify &lt;chr&gt;, type &lt;chr&gt;,
#   type_other_specify &lt;chr&gt;, titer_evaluated &lt;dbl&gt;, vaccine_ever &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co">#how much missing data in type</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>missing.values_vacc <span class="ot">&lt;-</span> vaccinations <span class="sc">%&gt;%</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"key"</span>, <span class="at">value =</span> <span class="st">"val"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">is.missing =</span> <span class="fu">is.na</span>(val)) <span class="sc">%&gt;%</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(key, is.missing) <span class="sc">%&gt;%</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">num.missing =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(is.missing<span class="sc">==</span>T) <span class="sc">%&gt;%</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>is.missing) <span class="sc">%&gt;%</span></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(num.missing)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'key'. You can override using the `.groups`
argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>missing_value_vacc <span class="ot">&lt;-</span> missing.values_vacc <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Proportion =</span> num.missing <span class="sc">/</span> <span class="fu">nrow</span>(vaccinations) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>missing_value_vacc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
# Groups:   key [8]
  key                        num.missing Proportion
  &lt;chr&gt;                            &lt;int&gt;      &lt;dbl&gt;
1 type_other_specify               80278       98.1
2 manufacturer_other_specify       76800       93.8
3 titer_evaluated                  60496       73.9
4 administered                     44679       54.6
5 vaccine_ever                     37239       45.5
6 lot                              32305       39.5
7 manufacturer                     31902       39.0
8 type                             31862       38.9</code></pre>
</div>
</div>
<p>Missing a lot of vaccine type and manufacturer data and even if vaccinated ever (‘vaccine_ever’).</p>
<ul>
<li><p>Vaccine_ever doesnt look correct - theres lots of rows with a vaccine listed in type but a NA for vaccine ever?</p></li>
<li><p>Need to group more broadly into vaccine types eg. rabies, KC, DAPPi, lepto or core/non-core</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co">#which vaccinations administered most frequently</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>freq_vaccs <span class="ot">&lt;-</span> vaccinations <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(type)<span class="sc">%&gt;%</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">Frequency =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Frequency))</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>freq_vaccs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 53 × 2
   type                                                                Frequency
   &lt;chr&gt;                                                                   &lt;int&gt;
 1 &lt;NA&gt;                                                                    31862
 2 leptospirosis 4 (canicola, grippotyphosa, icterohaemorrhagiae, pom…      7450
 3 rabies 3 year                                                            6539
 4 bordetella bronchiseptica oral                                           4312
 5 borelia burgdorferi                                                      3476
 6 canine influenza                                                         3180
 7 canine distemper, adenovirus type -2, parainfluenza, parvovirus          2703
 8 distemper, adenovirus type -2, parainfluenza, parvovirus                 2661
 9 bordetella bronchiseptica and parainfluenza in                           2362
10 bordetella bronchiseptica in                                             2254
# ℹ 43 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="do">### this bit doesnt work currently as need to edit vaccine ever</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="co">#number of medication events per dog</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>vaccs_per_dog <span class="ot">&lt;-</span> vaccinations<span class="sc">%&gt;%</span><span class="fu">group_by</span>(subject_id) <span class="sc">%&gt;%</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">vacc_administrations =</span> <span class="fu">sum</span>(vaccine_ever))<span class="sc">%&gt;%</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(vacc_administrations))</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>vaccs_per_dog</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,044 × 2
   subject_id vacc_administrations
   &lt;chr&gt;                     &lt;dbl&gt;
 1 094-024517                    2
 2 094-000259                    1
 3 094-002550                    1
 4 094-003192                    1
 5 094-004963                    1
 6 094-005292                    1
 7 094-012186                    1
 8 094-012972                    1
 9 094-013640                    1
10 094-015987                    1
# ℹ 3,034 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co">#avg medication events per dog</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(vaccs_per_dog<span class="sc">$</span>vacc_administrations)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
<p>Vaccine columns of most use:</p>
<ul>
<li><p>vaccine_ever (once edit to put a 1 in any row with a character in type)</p></li>
<li><p>type (once grouped more broadly)</p></li>
</ul>
<p>Then create cumulative exposure variables</p>
</section>
<section id="reproductive-history" class="level2">
<h2 class="anchored" data-anchor-id="reproductive-history">Reproductive history</h2>
<p>There are 4x repro related csvs :</p>
<ul>
<li><p>reproductive_history_female.csv</p></li>
<li><p>reproductive_history_heat.csv</p></li>
<li><p>reproductive_history_hormones.csv</p></li>
<li><p>reproductive_history_male.csv</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># female neutering and breeding information</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>repro_hx_female <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"C:/Users/ctaylor18/GitHub/GRLS_analyses/Data/reproductive_history_female.csv"</span>,<span class="at">na.strings=</span><span class="fu">c</span> (<span class="st">""</span>, <span class="st">"NA"</span>))</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>repro_hx_female <span class="ot">&lt;-</span> repro_hx_female <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), tolower))</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="co">#female heats</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>repro_heats_female <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"C:/Users/ctaylor18/GitHub/GRLS_analyses/Data/reproductive_history_heat.csv"</span>,<span class="at">na.strings=</span><span class="fu">c</span> (<span class="st">""</span>, <span class="st">"NA"</span>))</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>repro_heats_female <span class="ot">&lt;-</span> repro_heats_female <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), tolower))</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a><span class="co">#male neutering and breeding info</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>repro_hx_male <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"C:/Users/ctaylor18/GitHub/GRLS_analyses/Data/reproductive_history_male.csv"</span>,<span class="at">na.strings=</span><span class="fu">c</span> (<span class="st">""</span>, <span class="st">"NA"</span>))</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>repro_hx_male <span class="ot">&lt;-</span> repro_hx_male <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), tolower))</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a><span class="co">#hormone therapy</span></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>repro_hx_hormones <span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"C:/Users/ctaylor18/GitHub/GRLS_analyses/Data/reproductive_history_hormones.csv"</span>,<span class="at">na.strings=</span><span class="fu">c</span> (<span class="st">""</span>, <span class="st">"NA"</span>))</span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>repro_hx_hormones <span class="ot">&lt;-</span> repro_hx_hormones <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), tolower))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="repro-history-females" class="level3">
<h3 class="anchored" data-anchor-id="repro-history-females">Repro history females</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co">#how many females in repro hx file</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>F_reproIDs <span class="ot">&lt;-</span> <span class="fu">unique</span>(repro_hx_female<span class="sc">$</span>subject_id)</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>missing.values_repro_f <span class="ot">&lt;-</span> repro_hx_female <span class="sc">%&gt;%</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"key"</span>, <span class="at">value =</span> <span class="st">"val"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">is.missing =</span> <span class="fu">is.na</span>(val)) <span class="sc">%&gt;%</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(key, is.missing) <span class="sc">%&gt;%</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">num.missing =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(is.missing<span class="sc">==</span>T) <span class="sc">%&gt;%</span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>is.missing) <span class="sc">%&gt;%</span></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(num.missing)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'key'. You can override using the `.groups`
argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>missing_value_repro_f <span class="ot">&lt;-</span> missing.values_repro_f <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Proportion =</span> num.missing <span class="sc">/</span> <span class="fu">nrow</span>(repro_hx_female) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>missing_value_repro_f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
# Groups:   key [2]
  key            num.missing Proportion
  &lt;chr&gt;                &lt;int&gt;      &lt;dbl&gt;
1 spayed_on_date        3053       45.1
2 spayed_reason         2971       43.9</code></pre>
</div>
</div>
<p>Repro data for 1504 females</p>
<p>Very little missing data in this dataframe exc date of spay and spay reason</p>
<p>Think date of spay might be missing lots as multi rows for dog per year of study but only one spay date potentially -</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># group records by dog and see how many are missing date of spay</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>spay_date_missing <span class="ot">&lt;-</span> repro_hx_female <span class="sc">%&gt;%</span> <span class="fu">select</span>(subject_id,spayed_on_date) <span class="sc">%&gt;%</span> </span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(subject_id) <span class="sc">%&gt;%</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">neutered_any_year =</span> <span class="fu">any</span>(<span class="sc">!</span><span class="fu">is.na</span>(spayed_on_date)))<span class="sc">%&gt;%</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(neutered_any_year <span class="sc">==</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>So we are actually missing date of neuter for 232 dogs = ~15% (but NB this may include the entire F dogs too - need to cross match with demog csv)</p>
<p>Spay reasons:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>repro_hx_female <span class="sc">%&gt;%</span> </span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(spayed_reason) <span class="sc">%&gt;%</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Frequency =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Frequency))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  spayed_reason  Frequency
  &lt;chr&gt;              &lt;int&gt;
1 elective            3539
2 &lt;NA&gt;                2971
3 medical reason       230
4 behavioral            15
5 unknown               10</code></pre>
</div>
</div>
<p>Lots missing in this spay reason variable</p>
<p>Need to assess how many of the columns have much variation in coding of variables:</p>
<p>bar plot of 0 vs 1 for each varr</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove subject ID and then factors for all rows in DF</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> repro_hx_female<span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">!</span><span class="fu">c</span>(subject_id,year_in_study,record_date,spayed_on_date,spayed_reason))</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="co"># one variable has 0.0 and 0 and 1.0 and 1 as sep categories</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>variables[variables <span class="sc">==</span> <span class="st">"0.0"</span>]<span class="ot">&lt;-</span> <span class="st">"0"</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>variables[variables <span class="sc">==</span> <span class="st">"1.0"</span>]<span class="ot">&lt;-</span> <span class="st">"1"</span></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a><span class="co"># create a factor for each variable</span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> variables <span class="sc">%&gt;%</span> </span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), as.character))<span class="sc">%&gt;%</span></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character, as.factor)</span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a><span class="co">#now plot</span></span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>gathered_data <span class="ot">&lt;-</span> variables <span class="sc">%&gt;%</span></span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"column_name"</span>, <span class="at">value =</span> <span class="st">"value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: attributes are not identical across measure variables; they will be
dropped</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gathered_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(value), <span class="at">fill =</span> <span class="fu">factor</span>(value), <span class="at">group =</span> <span class="fu">interaction</span>(column_name, value))) <span class="sc">+</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>column_name, <span class="at">scales =</span> <span class="st">"free_x"</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Breakdown of variable values in female repro information "</span>,</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Value"</span>,</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GRLS-exploratory_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Potential columns to keep from female repro history csv (based on actually having :</p>
<ul>
<li><p>spayed_on_date</p></li>
<li><p>heat_last_year</p></li>
<li><p>no_pregnancy_ever/ no_pregnancy_last_year</p></li>
<li><p>spayed_while_in_heat (is this a biologically relevant variable to keep?)</p></li>
</ul>
</section>
<section id="repro-history-males" class="level3">
<h3 class="anchored" data-anchor-id="repro-history-males">Repro history males</h3>
<p>1540 male dogs</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co">#how many males in repro hx file</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>M_reproIDs <span class="ot">&lt;-</span> <span class="fu">unique</span>(repro_hx_male<span class="sc">$</span>subject_id)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>missing.values_repro_m <span class="ot">&lt;-</span> repro_hx_male <span class="sc">%&gt;%</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"key"</span>, <span class="at">value =</span> <span class="st">"val"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">is.missing =</span> <span class="fu">is.na</span>(val)) <span class="sc">%&gt;%</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(key, is.missing) <span class="sc">%&gt;%</span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">num.missing =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(is.missing<span class="sc">==</span>T) <span class="sc">%&gt;%</span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>is.missing) <span class="sc">%&gt;%</span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(num.missing)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'key'. You can override using the `.groups`
argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>missing_value_repro_m <span class="ot">&lt;-</span> missing.values_repro_m <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Proportion =</span> num.missing <span class="sc">/</span> <span class="fu">nrow</span>(repro_hx_male) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>missing_value_repro_m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 3
# Groups:   key [11]
   key                                      num.missing Proportion
   &lt;chr&gt;                                          &lt;int&gt;      &lt;dbl&gt;
 1 neutered_on_date                                4130    56.7   
 2 neutered_reason                                 3979    54.6   
 3 intact_breeding_outcome_last_year                  1     0.0137
 4 intact_naturally_bred_count_last_year              1     0.0137
 5 intact_semen_collected_count_last_year             1     0.0137
 6 intact_sired_litters_insemination                  1     0.0137
 7 neutered_breeding_outcome_last_year                1     0.0137
 8 neutered_naturally_bred_count_last_year            1     0.0137
 9 neutered_semen_collected                           1     0.0137
10 neutered_semen_collected_count_last_year           1     0.0137
11 neutered_sired_litters_insemination                1     0.0137</code></pre>
</div>
</div>
<p>Lots of neutering date (56%) and reason (54%) missing. Check if date is missing in similar way as in F repro csv</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># group records by dog and see how many are missing date of neuter</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>neut_date_missing <span class="ot">&lt;-</span> repro_hx_male <span class="sc">%&gt;%</span> <span class="fu">select</span>(subject_id,neutered_on_date) <span class="sc">%&gt;%</span> </span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(subject_id) <span class="sc">%&gt;%</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">neutered_any_year =</span> <span class="fu">any</span>(<span class="sc">!</span><span class="fu">is.na</span>(neutered_on_date)))<span class="sc">%&gt;%</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(neutered_any_year <span class="sc">==</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Missing date for 461 of the 1500 male dogs - ~30% (NB. this will include un-neutered dogs so need to cross-match with demog.csv).</p>
<p>Reason for neutering:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>repro_hx_male <span class="sc">%&gt;%</span> </span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(neutered_reason) <span class="sc">%&gt;%</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Frequency =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Frequency))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  neutered_reason Frequency
  &lt;chr&gt;               &lt;int&gt;
1 &lt;NA&gt;                 3979
2 elective             2942
3 behavioral            179
4 medical reason        169
5 unknown                18</code></pre>
</div>
</div>
<p>May be worth keeping - as ~300 have reasons besides elective neutering</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove subject ID and then factors for all rows in DF</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> repro_hx_male<span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">!</span><span class="fu">c</span>(subject_id,year_in_study,record_date,neutered_on_date,neutered_reason,intact_breeding_outcome_last_year,neutered_breeding_outcome_last_year,intact_naturally_bred_count_last_year,neutered_naturally_bred_count_last_year,neutered_sired_litters_insemination,</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>                                        intact_semen_collected_count_last_year,intact_sired_litters_insemination))</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="co"># one variable has 0.0 and 0 and 1.0 and 1 as sep categories</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>variables[variables <span class="sc">==</span> <span class="st">"0.0"</span>]<span class="ot">&lt;-</span> <span class="st">"0"</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>variables[variables <span class="sc">==</span> <span class="st">"1.0"</span>]<span class="ot">&lt;-</span> <span class="st">"1"</span></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a><span class="co"># create a factor for each variable</span></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> variables <span class="sc">%&gt;%</span> </span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), as.character))<span class="sc">%&gt;%</span></span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character, as.factor)</span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a><span class="co">#now plot</span></span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a>gathered_data <span class="ot">&lt;-</span> variables <span class="sc">%&gt;%</span></span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"column_name"</span>, <span class="at">value =</span> <span class="st">"value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: attributes are not identical across measure variables; they will be
dropped</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gathered_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(value), <span class="at">fill =</span> <span class="fu">factor</span>(value), <span class="at">group =</span> <span class="fu">interaction</span>(column_name, value))) <span class="sc">+</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>column_name, <span class="at">scales =</span> <span class="st">"free_x"</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Breakdown of variable values in male repro information "</span>,</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Value"</span>,</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>plots</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GRLS-exploratory_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>variables2 <span class="ot">&lt;-</span> repro_hx_male<span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(intact_naturally_bred_count_last_year,neutered_naturally_bred_count_last_year,neutered_sired_litters_insemination,</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>                                        intact_semen_collected_count_last_year,intact_sired_litters_insemination))</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>variables2[variables2 <span class="sc">==</span> <span class="st">"0.0"</span>]<span class="ot">&lt;-</span> <span class="st">"0"</span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>variables2[variables2 <span class="sc">==</span> <span class="st">"1.0"</span>]<span class="ot">&lt;-</span> <span class="st">"1"</span></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>variables2 <span class="ot">&lt;-</span> variables2 <span class="sc">%&gt;%</span> </span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), as.character))<span class="sc">%&gt;%</span></span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character, as.factor)</span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a><span class="co">#now plot</span></span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>gathered_data2 <span class="ot">&lt;-</span> variables2 <span class="sc">%&gt;%</span></span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"column_name"</span>, <span class="at">value =</span> <span class="st">"value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: attributes are not identical across measure variables; they will be
dropped</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>plots2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gathered_data2, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(value), <span class="at">fill =</span> <span class="fu">factor</span>(value), <span class="at">group =</span> <span class="fu">interaction</span>(column_name, value))) <span class="sc">+</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>column_name, <span class="at">scales =</span> <span class="st">"free_x"</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Breakdown of further variable values in male repro information "</span>,</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Value"</span>,</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>plots2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GRLS-exploratory_files/figure-html/unnamed-chunk-24-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Vast majority of variables are a 0. However, consider keeping one that accounts for times bred or similar</p>
<p>From male repro hx keep:</p>
<ul>
<li><p>neutered_on_date</p></li>
<li><p>neuter_reason</p></li>
<li><p>neutered and entire females_bred_with_count_ever</p></li>
<li><p>sired_litters variables - insemination and natural probably combine this</p></li>
</ul>
</section>
<section id="repro-history-hormones" class="level3">
<h3 class="anchored" data-anchor-id="repro-history-hormones">Repro history hormones</h3>
<p>How many dogs in this dataset and what info does it have? how much missing data?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>hormone_unique <span class="ot">&lt;-</span> <span class="fu">unique</span>(repro_hx_hormones<span class="sc">$</span>subject_id)</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(hormone_unique)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 153</code></pre>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co">#missing data</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>missing.values_hormones <span class="ot">&lt;-</span> repro_hx_hormones <span class="sc">%&gt;%</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"key"</span>, <span class="at">value =</span> <span class="st">"val"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">is.missing =</span> <span class="fu">is.na</span>(val)) <span class="sc">%&gt;%</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(key, is.missing) <span class="sc">%&gt;%</span></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">num.missing =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(is.missing<span class="sc">==</span>T) <span class="sc">%&gt;%</span></span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>is.missing) <span class="sc">%&gt;%</span></span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>((num.missing)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'key'. You can override using the `.groups`
argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>missing_value_hormones <span class="ot">&lt;-</span> missing.values_hormones <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Proportion =</span> num.missing <span class="sc">/</span> <span class="fu">nrow</span>(repro_hx_hormones) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>missing_value_hormones</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
# Groups:   key [1]
  key     num.missing Proportion
  &lt;chr&gt;         &lt;int&gt;      &lt;dbl&gt;
1 product         148       92.5</code></pre>
</div>
</div>
<p>153 dogs have hormone admin hx - this could represent significant proportion of those who are entire in our dataset (=219)</p>
<p>Lots of missing data for product administered (92% missing) - need to check if there’s not just only one main hormone therapy administered (seems to have lots of misspellings of miberone/milberone/milberon etc. in the records that do have product admin)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co">#number of medication events per dog</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>hormones_per_dog <span class="ot">&lt;-</span> repro_hx_hormones<span class="sc">%&gt;%</span></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(subject_id) <span class="sc">%&gt;%</span></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">hormone_admin =</span> <span class="fu">n</span>())<span class="sc">%&gt;%</span></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(hormone_admin))</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>hormones_per_dog</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 153 × 2
   subject_id hormone_admin
   &lt;chr&gt;              &lt;int&gt;
 1 094-024991             5
 2 094-000269             2
 3 094-023159             2
 4 094-024799             2
 5 094-000020             1
 6 094-000184             1
 7 094-000243             1
 8 094-000284             1
 9 094-000287             1
10 094-000340             1
# ℹ 143 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co">#avg medication events per dog</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>hormones_per_dog <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">mean=</span><span class="fu">mean</span>(hormone_admin),</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">median=</span><span class="fu">median</span>(hormone_admin),</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Min=</span><span class="fu">min</span>(hormone_admin),</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Max=</span><span class="fu">max</span>(hormone_admin)</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>                               )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
   mean median   Min   Max
  &lt;dbl&gt;  &lt;int&gt; &lt;int&gt; &lt;int&gt;
1  1.05      1     1     5</code></pre>
</div>
</div>
<p>Only ~10 records have duration of admin</p>
<p>From this dataset need to create a few variables:</p>
<ul>
<li><p>hormone therapy Y N</p></li>
<li><p>hormone admin date</p></li>
<li><p># of hormone administrations</p></li>
</ul>
</section>
<section id="repro-history-heats-in-females" class="level3">
<h3 class="anchored" data-anchor-id="repro-history-heats-in-females">Repro history heats in females</h3>
<p>How many dogs in this dataset? How much missing data?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>heat_unique <span class="ot">&lt;-</span> <span class="fu">unique</span>(repro_heats_female<span class="sc">$</span>subject_id)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(heat_unique)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 814</code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co">#missing data</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>missing.values_heats <span class="ot">&lt;-</span> repro_heats_female <span class="sc">%&gt;%</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"key"</span>, <span class="at">value =</span> <span class="st">"val"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">is.missing =</span> <span class="fu">is.na</span>(val)) <span class="sc">%&gt;%</span></span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(key, is.missing) <span class="sc">%&gt;%</span></span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">num.missing =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(is.missing<span class="sc">==</span>T) <span class="sc">%&gt;%</span></span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>is.missing) <span class="sc">%&gt;%</span></span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>((num.missing)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'key'. You can override using the `.groups`
argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>missing_value_heats <span class="ot">&lt;-</span> missing.values_heats <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Proportion =</span> num.missing <span class="sc">/</span> <span class="fu">nrow</span>(repro_heats_female) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>missing_value_heats</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
# Groups:   key [2]
  key         num.missing Proportion
  &lt;chr&gt;             &lt;int&gt;      &lt;dbl&gt;
1 heat_date          3268       96.2
2 litter_date        3377       99.4</code></pre>
</div>
</div>
<p>814 dogs in this heats dataset, large amounts of missing data for heat and litter date but remaining variables do not seem to have any missing data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove subject ID and then factors for all rows in DF</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> repro_heats_female<span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">!</span><span class="fu">c</span>(subject_id,year_in_study,record_date,heat_date,litter_date,heat_length))</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="co"># one variable has 0.0 and 0 and 1.0 and 1 as sep categories</span></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>variables[variables <span class="sc">==</span> <span class="st">"0.0"</span>]<span class="ot">&lt;-</span> <span class="st">"0"</span></span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>variables[variables <span class="sc">==</span> <span class="st">"1.0"</span>]<span class="ot">&lt;-</span> <span class="st">"1"</span></span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a><span class="co"># create a factor for each variable</span></span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> variables <span class="sc">%&gt;%</span> </span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), as.character))<span class="sc">%&gt;%</span></span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character, as.factor)</span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a><span class="co">#now plot</span></span>
<span id="cb134-12"><a href="#cb134-12" aria-hidden="true" tabindex="-1"></a>gathered_data <span class="ot">&lt;-</span> variables <span class="sc">%&gt;%</span></span>
<span id="cb134-13"><a href="#cb134-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"column_name"</span>, <span class="at">value =</span> <span class="st">"value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: attributes are not identical across measure variables; they will be
dropped</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co">#bar plot of binary variables</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>binary_var <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gathered_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(value), <span class="at">fill =</span> <span class="fu">factor</span>(value), <span class="at">group =</span> <span class="fu">interaction</span>(column_name, value))) <span class="sc">+</span></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>column_name, <span class="at">scales =</span> <span class="st">"free_x"</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Breakdown of variable values in female heats information "</span>,</span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Value"</span>,</span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a>binary_var</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GRLS-exploratory_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co">#histogram of heat length</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>heat_hist<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(repro_heats_female, <span class="fu">aes</span>(<span class="at">x=</span>heat_length)) <span class="sc">+</span> </span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="dv">1</span>)</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>heat_hist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GRLS-exploratory_files/figure-html/unnamed-chunk-28-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Variables to consider retaining:</p>
<ul>
<li><p>bred</p></li>
<li><p>litter_any</p></li>
<li><p>heat_length</p></li>
</ul>
<p>Unlikely to be able to calculate age at litter or age at heat as 90+ % missing here</p>
</section>
</section>
<section id="poison-exposure" class="level2">
<h2 class="anchored" data-anchor-id="poison-exposure">Poison exposure</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>poisons <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file=</span><span class="st">"C:/Users/ctaylor18/GitHub/GRLS_analyses/Data/poison_exposure.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 714 Columns: 6
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (3): subject_id, record_date, substance
dbl (3): year_in_study, PoisonControlLastYear, PoisonControlMoreThanTwice

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(poisons)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  subject_id year_in_study record_date substance           PoisonControlLastYear
  &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;                               &lt;dbl&gt;
1 094-000035             2 2014-11     rodent poison                           1
2 094-000056             7 2019-10     marijuana/thc                           1
3 094-000081             6 2018-08     plastic                                 1
4 094-000118             6 2019-01     chocolate                               1
5 094-000127             0 2012-10     carpet, plastic                         1
6 094-000137             0 2012-10     coffee, medication…                     1
# ℹ 1 more variable: PoisonControlMoreThanTwice &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>poisons <span class="ot">&lt;-</span> poisons <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), tolower))</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>unique_poisons <span class="ot">&lt;-</span> <span class="fu">unique</span>(poisons<span class="sc">$</span>subject_id)</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(unique_poisons)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 536</code></pre>
</div>
</div>
<p>714 poison control episodes (this includes toxic substances like rat bait but also foreign body material eg. socks), from 536 dogs</p>
<p>How much missing data - none</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co">#missing data</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>missing.values_poisons <span class="ot">&lt;-</span> poisons <span class="sc">%&gt;%</span></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"key"</span>, <span class="at">value =</span> <span class="st">"val"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">is.missing =</span> <span class="fu">is.na</span>(val)) <span class="sc">%&gt;%</span></span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(key, is.missing) <span class="sc">%&gt;%</span></span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">num.missing =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(is.missing<span class="sc">==</span>T) <span class="sc">%&gt;%</span></span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>is.missing) <span class="sc">%&gt;%</span></span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>((num.missing)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'key'. You can override using the `.groups`
argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>missing_value_poisons <span class="ot">&lt;-</span> missing.values_poisons <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Proportion =</span> num.missing <span class="sc">/</span> <span class="fu">nrow</span>(poisons) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>missing_value_poisons</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 3
# Groups:   key [0]
# ℹ 3 variables: key &lt;chr&gt;, num.missing &lt;int&gt;, Proportion &lt;dbl&gt;</code></pre>
</div>
</div>
<p>How many dogs have repeat poison ingestion events:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>multiple_poisons <span class="ot">&lt;-</span> poisons <span class="sc">%&gt;%</span> <span class="fu">filter</span>(PoisonControlMoreThanTwice<span class="sc">&gt;=</span><span class="dv">1</span>)</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(multiple_poisons)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co">#summary stats of # poison episodes</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>poisons_ep <span class="ot">&lt;-</span> poisons <span class="sc">%&gt;%</span> </span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(subject_id)<span class="sc">%&gt;%</span> </span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">poison_episode=</span><span class="fu">n</span>())</span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>poisons_ep <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">mean=</span><span class="fu">mean</span>(poison_episode),</span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">median=</span><span class="fu">median</span>(poison_episode),</span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Min=</span><span class="fu">min</span>(poison_episode),</span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Max=</span><span class="fu">max</span>(poison_episode)</span>
<span id="cb150-10"><a href="#cb150-10" aria-hidden="true" tabindex="-1"></a>                               )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 4
   mean median   Min   Max
  &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt; &lt;int&gt;
1  1.33      1     1     6</code></pre>
</div>
</div>
<p>Few, 11.</p>
<p>What are the major poisons?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>substance <span class="ot">&lt;-</span> poisons <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(substance) <span class="sc">%&gt;%</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">type=</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(type))</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>substance</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 309 × 2
   substance                    type
   &lt;chr&gt;                       &lt;int&gt;
 1 unknown                        41
 2 rodent poison                  40
 3 chocolate                      34
 4 wild mushroom - unspecified    29
 5 insect poison                  20
 6 grapes                         18
 7 plastic                        17
 8 raisins                        15
 9 rocks                          15
10 clothing - sock                12
# ℹ 299 more rows</code></pre>
</div>
</div>
<p>Major poisons - rodent poison, mushrooms, chocolate,insect poisons, raisins/grapes</p>
<p>Dont think poisons csv particularly relevant for HSA.</p>
</section>
<section id="environmental-conditions" class="level2">
<h2 class="anchored" data-anchor-id="environmental-conditions">Environmental conditions</h2>
<p>Several environmental csvs:</p>
<p>-location_history.csv (travel and locations visited BESIDES home or second home)</p>
<p>-environment_conditions.csv (exposures to various enviromental agents eg. aersols, smoke)</p>
<p>-environment_spend_time_location.csv</p>
<p>-activity_overview.csv</p>
<section id="travel-locations" class="level3">
<h3 class="anchored" data-anchor-id="travel-locations">Travel locations</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="co">#travel locations</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>location_history <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"C:/Users/ctaylor18/GitHub/GRLS_analyses/Data/location_history.csv"</span>,<span class="at">na.strings=</span><span class="fu">c</span> (<span class="st">""</span>,<span class="st">"NA"</span>))</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>location_history <span class="ot">&lt;-</span> location_history <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), tolower))</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>environment_exposures<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"C:/Users/ctaylor18/GitHub/GRLS_analyses/Data/environment_conditions.csv"</span>,<span class="at">na.strings=</span><span class="fu">c</span> (<span class="st">""</span>,<span class="st">"NA"</span>))</span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>environment_exposures <span class="ot">&lt;-</span> environment_exposures <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), tolower))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co">#how many dogs have other locations/travel hx</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>travel_IDs <span class="ot">&lt;-</span> <span class="fu">unique</span>(location_history<span class="sc">$</span>subject_id)</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(travel_IDs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2116</code></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co">#missing-ness of data</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>missing.values_travel <span class="ot">&lt;-</span> location_history <span class="sc">%&gt;%</span></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"key"</span>, <span class="at">value =</span> <span class="st">"val"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">is.missing =</span> <span class="fu">is.na</span>(val)) <span class="sc">%&gt;%</span></span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(key, is.missing) <span class="sc">%&gt;%</span></span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">num.missing =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(is.missing<span class="sc">==</span>T) <span class="sc">%&gt;%</span></span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>is.missing) <span class="sc">%&gt;%</span></span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(num.missing)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'key'. You can override using the `.groups`
argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>missing_value_travel <span class="ot">&lt;-</span> missing.values_travel <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Proportion =</span> num.missing <span class="sc">/</span> <span class="fu">nrow</span>(location_history) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>missing_value_travel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
# Groups:   key [8]
  key                num.missing Proportion
  &lt;chr&gt;                    &lt;int&gt;      &lt;dbl&gt;
1 travel_mode_other        31980    96.7   
2 zip                       7834    23.7   
3 travel_start_month        6017    18.2   
4 region_name               2032     6.14  
5 country                   2008     6.07  
6 city                       785     2.37  
7 type                       554     1.68  
8 state                        9     0.0272</code></pre>
</div>
</div>
<p>~2115 of the 3000 dogs have a travel record.</p>
<p>Small amounts of missing data for state type and city visited for dogs</p>
<p>Not sure if this dataset will be particularly useful</p>
<p>…….</p>
</section>
<section id="environmental-conditions-1" class="level3">
<h3 class="anchored" data-anchor-id="environmental-conditions-1">Environmental conditions</h3>
<p>how many dogs in this dataset and level of missingness</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co">#how many dogs have other exposure hx</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>exposure_IDs <span class="ot">&lt;-</span> <span class="fu">unique</span>(environment_exposures<span class="sc">$</span>subject_id)</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(exposure_IDs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3044</code></pre>
</div>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co">#missing-ness of data</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>missing.values_exposure <span class="ot">&lt;-</span> environment_exposures <span class="sc">%&gt;%</span></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"key"</span>, <span class="at">value =</span> <span class="st">"val"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">is.missing =</span> <span class="fu">is.na</span>(val)) <span class="sc">%&gt;%</span></span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(key, is.missing) <span class="sc">%&gt;%</span></span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">num.missing =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(is.missing<span class="sc">==</span>T) <span class="sc">%&gt;%</span></span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>is.missing) <span class="sc">%&gt;%</span></span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(num.missing)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'key'. You can override using the `.groups`
argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>missing_value_exposure <span class="ot">&lt;-</span> missing.values_exposure <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Proportion =</span> num.missing <span class="sc">/</span> <span class="fu">nrow</span>(environment_exposures) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>missing_value_exposure</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
# Groups:   key [1]
  key         num.missing Proportion
  &lt;chr&gt;             &lt;int&gt;      &lt;dbl&gt;
1 record_date       22092         50</code></pre>
</div>
</div>
<p>Record present for whole dataset and mostly only missing data for the record date 50%. Hours of smoke has a string ‘see detail rows’ in 22092 records (~50%) - unclear what this is</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>no_smoke <span class="ot">&lt;-</span> environment_exposures <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(smoke_exposure)<span class="sc">%&gt;%</span><span class="fu">filter</span>(smoke_exposure<span class="sc">==</span><span class="dv">0</span>)</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>smoke <span class="ot">&lt;-</span> environment_exposures <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(smoke_exposure)<span class="sc">%&gt;%</span><span class="fu">filter</span>(smoke_exposure<span class="sc">==</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Examine what each of the variables looks like:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove subject ID and then factors for all rows in DF</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> environment_exposures<span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">!</span><span class="fu">c</span>(subject_id,year_in_study,record_date,to_date,hours_of_smoke))</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a><span class="co"># one variable has 0.0 and 0 and 1.0 and 1 as sep categories</span></span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>variables[variables <span class="sc">==</span> <span class="st">"0.0"</span>]<span class="ot">&lt;-</span> <span class="st">"0"</span></span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>variables[variables <span class="sc">==</span> <span class="st">"1.0"</span>]<span class="ot">&lt;-</span> <span class="st">"1"</span></span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a><span class="co"># create a factor for each variable</span></span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> variables <span class="sc">%&gt;%</span> </span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), as.character))<span class="sc">%&gt;%</span></span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character, as.factor)</span>
<span id="cb168-11"><a href="#cb168-11" aria-hidden="true" tabindex="-1"></a><span class="co">#now plot</span></span>
<span id="cb168-12"><a href="#cb168-12" aria-hidden="true" tabindex="-1"></a>gathered_data <span class="ot">&lt;-</span> variables <span class="sc">%&gt;%</span></span>
<span id="cb168-13"><a href="#cb168-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"column_name"</span>, <span class="at">value =</span> <span class="st">"value"</span>)</span>
<span id="cb168-14"><a href="#cb168-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-15"><a href="#cb168-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-16"><a href="#cb168-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gathered_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(value), <span class="at">fill =</span> <span class="fu">factor</span>(value), <span class="at">group =</span> <span class="fu">interaction</span>(column_name, value))) <span class="sc">+</span></span>
<span id="cb168-17"><a href="#cb168-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb168-18"><a href="#cb168-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>column_name, <span class="at">scales =</span> <span class="st">"free_x"</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb168-19"><a href="#cb168-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Breakdown of variable values in environmental exposures "</span>,</span>
<span id="cb168-20"><a href="#cb168-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Value"</span>,</span>
<span id="cb168-21"><a href="#cb168-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb168-22"><a href="#cb168-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GRLS-exploratory_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co">#smoke hours of exposure histogram</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="co"># remove rows with weird string</span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>smoke_hours <span class="ot">&lt;-</span> environment_exposures <span class="sc">%&gt;%</span> <span class="fu">filter</span>(hours_of_smoke <span class="sc">!=</span> <span class="st">"see detail rows"</span>)</span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>smoke_hours <span class="ot">&lt;-</span> smoke_hours <span class="sc">%&gt;%</span> <span class="fu">mutate_if</span>(is.character, as.numeric) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There were 2 warnings in `mutate()`.
The first warning was:
ℹ In argument: `subject_id = .Primitive("as.double")(subject_id)`.
Caused by warning:
! NAs introduced by coercion
ℹ Run `dplyr::last_dplyr_warnings()` to see the 1 remaining warning.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>smoke_hours_hist<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(smoke_hours, <span class="fu">aes</span>(<span class="at">x=</span>hours_of_smoke)) <span class="sc">+</span> </span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="dv">20</span>)</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>smoke_hours_hist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GRLS-exploratory_files/figure-html/unnamed-chunk-37-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Most of these exposure variables have a good split between 0 and 1 - so could be taken into analyses.</p>
<p>Hours of smoke is largely 0 so not likely to be v useful</p>
<p>Variables to create from this:</p>
<ul>
<li>A dose/level for each environmental variable e.g LMH exposure level or &gt;1 exposure etc</li>
</ul>
<p>First need to check if many dogs have more than 1 exposure recorded for each of the different enviro exposures</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co">#summary stats of # each exposures for each dog</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>subject_counts <span class="ot">&lt;-</span>environment_exposures <span class="sc">%&gt;%</span> </span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(subject_id) <span class="sc">%&gt;%</span></span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">one_count =</span> <span class="fu">sum</span>(<span class="fu">c_across</span>(use_aerosol<span class="sc">:</span>use_incense_or_candles) <span class="sc">==</span> <span class="dv">1</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a>environment_exposures <span class="sc">%&gt;%</span></span>
<span id="cb172-8"><a href="#cb172-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(subject_id) <span class="sc">%&gt;%</span></span>
<span id="cb172-9"><a href="#cb172-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"col"</span>), <span class="sc">~</span><span class="fu">sum</span>(. <span class="sc">==</span> <span class="dv">1</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.names =</span> <span class="st">"count_{.col}"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,044 × 1
   subject_id
   &lt;chr&gt;     
 1 094-000019
 2 094-000020
 3 094-000026
 4 094-000035
 5 094-000043
 6 094-000054
 7 094-000055
 8 094-000056
 9 094-000057
10 094-000063
# ℹ 3,034 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co">#list of environmental variables</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>enviro_vars <span class="ot">&lt;-</span> <span class="fu">colnames</span>(environment_exposures[,<span class="fu">sapply</span>(environment_exposures,is.numeric)])</span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a><span class="co">#group by dog to get the count for # of exposures to each agent</span></span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>exposure_by_dog <span class="ot">&lt;-</span>environment_exposures <span class="sc">%&gt;%</span></span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(subject_id) <span class="sc">%&gt;%</span></span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(enviro_vars), <span class="sc">~</span><span class="fu">sum</span>(. <span class="sc">==</span> <span class="dv">1</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.names =</span> <span class="st">"count_{.col}"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `summarise()`.
ℹ In argument: `across(c(enviro_vars), ~sum(. == 1, na.rm = TRUE), .names =
  "count_{.col}")`.
Caused by warning:
! Using an external vector in selections was deprecated in tidyselect 1.1.0.
ℹ Please use `all_of()` or `any_of()` instead.
  # Was:
  data %&gt;% select(enviro_vars)

  # Now:
  data %&gt;% select(all_of(enviro_vars))

See &lt;https://tidyselect.r-lib.org/reference/faq-external-vector.html&gt;.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>exposure_by_dog <span class="ot">&lt;-</span> exposure_by_dog <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">!</span>(count_year_in_study<span class="sc">:</span>count_to_date))</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>exposure_by_dog</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,044 × 11
   subject_id count_use_aerosol count_use_air_cleaner count_use_hepa_filter
   &lt;chr&gt;                  &lt;int&gt;                 &lt;int&gt;                 &lt;int&gt;
 1 094-000019                22                    19                    21
 2 094-000020                20                    19                    20
 3 094-000026                16                     3                    16
 4 094-000035                 0                     9                     8
 5 094-000043                 9                    14                    18
 6 094-000054                11                     0                     0
 7 094-000055                12                     0                     0
 8 094-000056                 6                     0                    11
 9 094-000057                16                     2                     4
10 094-000063                 4                     8                     8
# ℹ 3,034 more rows
# ℹ 7 more variables: count_use_moth_balls &lt;int&gt;,
#   count_use_incense_or_candles &lt;int&gt;, count_smoke_exposure &lt;int&gt;,
#   count_poison_clinic_visit &lt;int&gt;, count_any_treated_weeds &lt;int&gt;,
#   count_any_treated_insects &lt;int&gt;, count_any_treated_fertilizer &lt;int&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="do">##histograms of each of the exposures</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming your data frame is named 'your_data'</span></span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>exposure_by_dog_long <span class="ot">&lt;-</span> <span class="fu">gather</span>(exposure_by_dog, <span class="at">key =</span> <span class="st">"subject_id"</span>, <span class="at">value =</span> <span class="st">"value"</span>)</span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a histogram with facets</span></span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a>hists<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(exposure_by_dog_long, <span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb178-8"><a href="#cb178-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">3</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb178-9"><a href="#cb178-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>subject_id, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb178-10"><a href="#cb178-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histograms for Each Variable"</span>,</span>
<span id="cb178-11"><a href="#cb178-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Value"</span>,</span>
<span id="cb178-12"><a href="#cb178-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb178-13"><a href="#cb178-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb178-14"><a href="#cb178-14" aria-hidden="true" tabindex="-1"></a>hists</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GRLS-exploratory_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>All the exposure variables besides probably - moth balls and smoke hours could be useful for environmental exposure.</p>
<p>Need to transform the variables so that we can have some form of short vs long term exposure classification, Y or N exposure classification (eg. ever, 1y prior to diagnosis, 5y prior to diagnosis)</p>
</section>
<section id="time-spent-in-different-environments" class="level3">
<h3 class="anchored" data-anchor-id="time-spent-in-different-environments">Time spent in different environments</h3>
<p>Mostly a binary variable sheet of environment they are in indoors (eg. crate 0 1 carpet 0 1) % time spent outside, (chained, fenced,garage,kennel etc.)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>enviro_time <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"C:/Users/ctaylor18/GitHub/GRLS_analyses/Data/environment_spend_time_location.csv"</span>,<span class="at">na.strings=</span><span class="fu">c</span>(<span class="st">""</span>,<span class="st">"NA"</span>))</span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>enviro_time <span class="ot">&lt;-</span> enviro_time <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), tolower))</span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a><span class="co">#how many dogs have other enviro hx</span></span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a>enviro_timee_IDs <span class="ot">&lt;-</span> <span class="fu">unique</span>(enviro_time<span class="sc">$</span>subject_id)</span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(enviro_timee_IDs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3044</code></pre>
</div>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co">#missing-ness of data</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>missing.values_enviro_time <span class="ot">&lt;-</span> enviro_time <span class="sc">%&gt;%</span></span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"key"</span>, <span class="at">value =</span> <span class="st">"val"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">is.missing =</span> <span class="fu">is.na</span>(val)) <span class="sc">%&gt;%</span></span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(key, is.missing) <span class="sc">%&gt;%</span></span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">num.missing =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(is.missing<span class="sc">==</span>T) <span class="sc">%&gt;%</span></span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>is.missing) <span class="sc">%&gt;%</span></span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(num.missing)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'key'. You can override using the `.groups`
argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>missing_value_enviro_time <span class="ot">&lt;-</span> missing.values_enviro_time <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Proportion =</span> num.missing <span class="sc">/</span> <span class="fu">nrow</span>(enviro_time) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>missing_value_enviro_time</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
# Groups:   key [4]
  key                                  num.missing Proportion
  &lt;chr&gt;                                      &lt;int&gt;      &lt;dbl&gt;
1 furniture_type_other_specify               16462    98.6   
2 indoor_other_flooring_specify              15681    93.9   
3 day_outdoor_other_percentage_specify       15309    91.7   
4 spent_most_time_day                            2     0.0120</code></pre>
</div>
</div>
<p>Most records have minimal missing information except for other (0 vs 1) for furniture type and indoor flooring and day outdoor.Spent most time day minimal missing data is very minimal.</p>
<p>Columns that might be of interest:</p>
<ul>
<li>spent_most_time_day</li>
<li>many many columns on type of environment they are based in indoors or outdoors although, these variables are all very not mutually exclusive eg. carpet vs lino flooring indoors - possibly good component for PCA</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> enviro_time <span class="sc">%&gt;%</span> </span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">c</span>(subject_id,year_in_study,record_date,indoor_other_flooring_specify,</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>            day_outdoor_other_percentage_specify,furniture_type_other_specify,</span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a>            day_outdoor_other_percentage,day_outdoor_total_percentage,</span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>            day_outdoor_garage, day_outdoor_kennel</span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a>            ,day_outdoor_fenced, day_outdoor_chain_or_lead))</span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a><span class="co">#have left out the other_specify columns as they are free text and very messy or if % then are numeric</span></span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a><span class="co"># create a factor for each variable</span></span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> variables <span class="sc">%&gt;%</span> </span>
<span id="cb185-10"><a href="#cb185-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), as.character))<span class="sc">%&gt;%</span></span>
<span id="cb185-11"><a href="#cb185-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character, as.factor)</span>
<span id="cb185-12"><a href="#cb185-12" aria-hidden="true" tabindex="-1"></a><span class="co">#now plot</span></span>
<span id="cb185-13"><a href="#cb185-13" aria-hidden="true" tabindex="-1"></a>gathered_data <span class="ot">&lt;-</span> variables <span class="sc">%&gt;%</span></span>
<span id="cb185-14"><a href="#cb185-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"column_name"</span>, <span class="at">value =</span> <span class="st">"value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: attributes are not identical across measure variables; they will be
dropped</code></pre>
</div>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co">#bar plot of binary variables</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>binary_var <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gathered_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(value), <span class="at">fill =</span> <span class="fu">factor</span>(value), <span class="at">group =</span> <span class="fu">interaction</span>(column_name, value))) <span class="sc">+</span></span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>column_name, <span class="at">scales =</span> <span class="st">"free_x"</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Breakdown of variable values environmental locations"</span>,</span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Value"</span>,</span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb187-8"><a href="#cb187-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb187-9"><a href="#cb187-9" aria-hidden="true" tabindex="-1"></a>binary_var</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GRLS-exploratory_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Numeric % data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co">#list of numeric variables</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>time_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"day_outdoor_other_percentage"</span>,<span class="st">"day_outdoor_total_percentage"</span>,</span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"day_outdoor_garage"</span>, <span class="st">"day_outdoor_kennel"</span>,<span class="st">"day_outdoor_fenced"</span>, </span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>           <span class="st">"day_outdoor_chain_or_lead"</span>)</span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a><span class="co">#only numeric variables </span></span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a>exposure_by_dog <span class="ot">&lt;-</span>enviro_time <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">all_of</span>(time_vars))</span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-9"><a href="#cb188-9" aria-hidden="true" tabindex="-1"></a><span class="co"># wide to long data</span></span>
<span id="cb188-10"><a href="#cb188-10" aria-hidden="true" tabindex="-1"></a>exposure_by_dog_long <span class="ot">&lt;-</span> <span class="fu">gather</span>(exposure_by_dog, <span class="at">key =</span> <span class="st">"key"</span>, <span class="at">value =</span> <span class="st">"value"</span>)</span>
<span id="cb188-11"><a href="#cb188-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-12"><a href="#cb188-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a histogram with facets</span></span>
<span id="cb188-13"><a href="#cb188-13" aria-hidden="true" tabindex="-1"></a>hists<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(exposure_by_dog_long, <span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb188-14"><a href="#cb188-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">10</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb188-15"><a href="#cb188-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>key, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb188-16"><a href="#cb188-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Histograms for each % of time variable"</span>,</span>
<span id="cb188-17"><a href="#cb188-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Value"</span>,</span>
<span id="cb188-18"><a href="#cb188-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb188-19"><a href="#cb188-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb188-20"><a href="#cb188-20" aria-hidden="true" tabindex="-1"></a>hists</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GRLS-exploratory_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Variables to keep/modify:</p>
<ul>
<li><p>spent_most_time_day</p></li>
<li><p>? indoor and furniture binary classifiers - doubt we want all - potentially some PCA or similar to determine which of these is imp or could be amalgamated in some way to be important ?</p></li>
</ul>
</section>
</section>
<section id="time-spent-sleeping-in-different-environments" class="level2">
<h2 class="anchored" data-anchor-id="time-spent-sleeping-in-different-environments">Time spent sleeping in different environments</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>enviro_sleep <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"C:/Users/ctaylor18/GitHub/GRLS_analyses/Data/environment_sleep_location.csv"</span>,<span class="at">na.strings=</span><span class="fu">c</span>(<span class="st">""</span>,<span class="st">"NA"</span>))</span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a>enviro_sleep <span class="ot">&lt;-</span> enviro_sleep <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), tolower))</span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a><span class="co">#how many dogs have other enviro hx</span></span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a>enviro_sleep_IDs <span class="ot">&lt;-</span> <span class="fu">unique</span>(enviro_sleep<span class="sc">$</span>subject_id)</span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(enviro_sleep_IDs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3044</code></pre>
</div>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co">#missing-ness of data</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>missing.values_enviro_sleep <span class="ot">&lt;-</span> enviro_sleep <span class="sc">%&gt;%</span></span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"key"</span>, <span class="at">value =</span> <span class="st">"val"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">is.missing =</span> <span class="fu">is.na</span>(val)) <span class="sc">%&gt;%</span></span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(key, is.missing) <span class="sc">%&gt;%</span></span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">num.missing =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(is.missing<span class="sc">==</span>T) <span class="sc">%&gt;%</span></span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>is.missing) <span class="sc">%&gt;%</span></span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(num.missing)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'key'. You can override using the `.groups`
argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>missing_value_enviro_sleep <span class="ot">&lt;-</span> missing.values_enviro_sleep <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Proportion =</span> num.missing <span class="sc">/</span> <span class="fu">nrow</span>(enviro_sleep) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>missing_value_enviro_sleep</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 22 × 3
# Groups:   key [22]
   key                        num.missing Proportion
   &lt;chr&gt;                            &lt;int&gt;      &lt;dbl&gt;
 1 dog_house_bedding_specify        43479      100. 
 2 dog_house_material_specify       43469      100. 
 3 dog_house_bedding                43462       99.9
 4 dog_house_material               43401       99.8
 5 dog_bed_filling_specify          43347       99.7
 6 furniture_finish_specify         43346       99.7
 7 natural_surface_specify          43333       99.7
 8 crate_material_specify           43240       99.4
 9 natural_surface                  43065       99.0
10 dog_bed_foam                     43013       98.9
# ℹ 12 more rows</code></pre>
</div>
</div>
<p>So much missing data for bedding type,crate type etc.</p>
<p>Only variables with reasonable numbers of data:</p>
<ul>
<li><p>sleep_location</p></li>
<li><p>specific_sleep_location</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> enviro_sleep <span class="sc">%&gt;%</span> </span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(sleep_location,specific_sleep_location))</span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a><span class="co">#have left out the other_specify columns as they are free text and very messy or if % then are numeric</span></span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create a factor for each variable</span></span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> variables <span class="sc">%&gt;%</span> </span>
<span id="cb195-6"><a href="#cb195-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), as.character))<span class="sc">%&gt;%</span></span>
<span id="cb195-7"><a href="#cb195-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character, as.factor)</span>
<span id="cb195-8"><a href="#cb195-8" aria-hidden="true" tabindex="-1"></a><span class="co">#now plot</span></span>
<span id="cb195-9"><a href="#cb195-9" aria-hidden="true" tabindex="-1"></a>gathered_data <span class="ot">&lt;-</span> variables <span class="sc">%&gt;%</span></span>
<span id="cb195-10"><a href="#cb195-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"column_name"</span>, <span class="at">value =</span> <span class="st">"value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: attributes are not identical across measure variables; they will be
dropped</code></pre>
</div>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co">#bar plot of categorical variables</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>cat_var <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gathered_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(value), <span class="at">fill =</span> <span class="fu">factor</span>(value), <span class="at">group =</span> <span class="fu">interaction</span>(column_name, value))) <span class="sc">+</span></span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>column_name, <span class="at">scales =</span> <span class="st">"free_x"</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Breakdown of variable values sleep locations"</span>,</span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Value"</span>,</span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span>
<span id="cb197-9"><a href="#cb197-9" aria-hidden="true" tabindex="-1"></a>cat_var</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GRLS-exploratory_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="time-spent-doing-activity" class="level3">
<h3 class="anchored" data-anchor-id="time-spent-doing-activity">Time spent doing activity</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>activity_time <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"C:/Users/ctaylor18/GitHub/GRLS_analyses/Data/activity_overview.csv"</span>,<span class="at">na.strings=</span><span class="fu">c</span>(<span class="st">""</span>,<span class="st">"NA"</span>))</span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>activity_time <span class="ot">&lt;-</span> activity_time <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), tolower))</span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(activity_time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  subject_id year_in_study record_date activity_level swim swim_duration
1 094-000019             0     2012-10       moderate    1          &lt;NA&gt;
2 094-000019             1     2013-10       moderate    1          &lt;NA&gt;
3 094-000019             2     2014-11       moderate    1          &lt;NA&gt;
4 094-000019             3     2015-10       moderate    1          &lt;NA&gt;
5 094-000019             4     2016-11       moderate    1          &lt;NA&gt;
6 094-000019             5     2017-10       moderate    1          &lt;NA&gt;
  swim_pace swim_cold_frequency swim_location_pool swim_location_pond_lake
1      &lt;NA&gt;              rarely                  0                       1
2      &lt;NA&gt;              rarely                  0                       1
3      &lt;NA&gt;              rarely                  0                       1
4      &lt;NA&gt;              weekly                  0                       1
5      &lt;NA&gt;             monthly                  0                       1
6      &lt;NA&gt;             monthly                  0                       1
  swim_location_river_stream_ditch swim_location_ocean swim_warm_frequency
1                                0                   0              weekly
2                                0                   1              weekly
3                                0                   0              weekly
4                                0                   0                &lt;NA&gt;
5                                0                   0                &lt;NA&gt;
6                                0                   0                &lt;NA&gt;
  sun_exposure_duration sun_exposure_shade_access sun_exposure_concrete
1     less than 3 hours      access to full shade                     0
2     less than 3 hours      access to full shade                     0
3     between 3-8 hours      access to full shade                     0
4     less than 3 hours      access to full shade                     0
5     less than 3 hours      access to full shade                     0
6     between 3-8 hours      access to full shade                     0
  sun_exposure_grass sun_exposure_dirt sun_exposure_other_specify
1                  1                 0                       &lt;NA&gt;
2                  1                 0                     gravel
3                  0                 0                     gravel
4                  1                 0                       &lt;NA&gt;
5                  1                 0                       &lt;NA&gt;
6                  1                 0                     gravel</code></pre>
</div>
</div>
<p>16 variables in csv based on owner questionnaire - activity level, if they swim or not, swimming location, swimming temperature, level of sun exposure and where they are exposed to sunshine</p>
<p>Assess missingness of data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="co">#how many dogs have other activity hx</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>activity_time_IDs <span class="ot">&lt;-</span> <span class="fu">unique</span>(activity_time<span class="sc">$</span>subject_id)</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(activity_time_IDs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3044</code></pre>
</div>
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="co">#missing-ness of data</span></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>missing.values_activity_time <span class="ot">&lt;-</span> activity_time <span class="sc">%&gt;%</span></span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"key"</span>, <span class="at">value =</span> <span class="st">"val"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">is.missing =</span> <span class="fu">is.na</span>(val)) <span class="sc">%&gt;%</span></span>
<span id="cb202-5"><a href="#cb202-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(key, is.missing) <span class="sc">%&gt;%</span></span>
<span id="cb202-6"><a href="#cb202-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">num.missing =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb202-7"><a href="#cb202-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(is.missing<span class="sc">==</span>T) <span class="sc">%&gt;%</span></span>
<span id="cb202-8"><a href="#cb202-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>is.missing) <span class="sc">%&gt;%</span></span>
<span id="cb202-9"><a href="#cb202-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(num.missing)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'key'. You can override using the `.groups`
argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>missing_value_activity_time <span class="ot">&lt;-</span> missing.values_activity_time <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Proportion =</span> num.missing <span class="sc">/</span> <span class="fu">nrow</span>(activity_time) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>missing_value_activity_time</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
# Groups:   key [8]
  key                        num.missing Proportion
  &lt;chr&gt;                            &lt;int&gt;      &lt;dbl&gt;
1 swim_duration                    20153   88.7    
2 swim_pace                        20153   88.7    
3 sun_exposure_other_specify       15178   66.8    
4 swim_warm_frequency              11295   49.7    
5 swim_cold_frequency               8547   37.6    
6 activity_level                       3    0.0132 
7 sun_exposure_duration                2    0.00880
8 sun_exposure_shade_access            2    0.00880</code></pre>
</div>
</div>
<p>Large amounts of missing data for length of swim, speed of swimming and temperature of swimming water.</p>
<p>Assess breakdown of binary/categorical variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> activity_time <span class="sc">%&gt;%</span> </span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">c</span>(subject_id,year_in_study,record_date,activity_level, </span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a>            sun_exposure_other_specify,</span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a>            sun_exposure_shade_access,</span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true" tabindex="-1"></a>            sun_exposure_duration,swim_cold_frequency,swim_warm_frequency,</span>
<span id="cb206-6"><a href="#cb206-6" aria-hidden="true" tabindex="-1"></a>            swim_duration,swim_pace))</span>
<span id="cb206-7"><a href="#cb206-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-8"><a href="#cb206-8" aria-hidden="true" tabindex="-1"></a><span class="co"># create a factor for each variable</span></span>
<span id="cb206-9"><a href="#cb206-9" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> variables <span class="sc">%&gt;%</span> </span>
<span id="cb206-10"><a href="#cb206-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), as.character))<span class="sc">%&gt;%</span></span>
<span id="cb206-11"><a href="#cb206-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character, as.factor)</span>
<span id="cb206-12"><a href="#cb206-12" aria-hidden="true" tabindex="-1"></a><span class="co">#now plot</span></span>
<span id="cb206-13"><a href="#cb206-13" aria-hidden="true" tabindex="-1"></a>gathered_data <span class="ot">&lt;-</span> variables <span class="sc">%&gt;%</span></span>
<span id="cb206-14"><a href="#cb206-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"column_name"</span>, <span class="at">value =</span> <span class="st">"value"</span>)</span>
<span id="cb206-15"><a href="#cb206-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-16"><a href="#cb206-16" aria-hidden="true" tabindex="-1"></a><span class="co">#bar plot of binary variables</span></span>
<span id="cb206-17"><a href="#cb206-17" aria-hidden="true" tabindex="-1"></a>binary_var <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gathered_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(value), <span class="at">fill =</span> <span class="fu">factor</span>(value), <span class="at">group =</span> <span class="fu">interaction</span>(column_name, value))) <span class="sc">+</span></span>
<span id="cb206-18"><a href="#cb206-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb206-19"><a href="#cb206-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>column_name, <span class="at">scales =</span> <span class="st">"free_x"</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb206-20"><a href="#cb206-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Breakdown of variable values for activity"</span>,</span>
<span id="cb206-21"><a href="#cb206-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Value"</span>,</span>
<span id="cb206-22"><a href="#cb206-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb206-23"><a href="#cb206-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() </span>
<span id="cb206-24"><a href="#cb206-24" aria-hidden="true" tabindex="-1"></a>binary_var</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GRLS-exploratory_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> activity_time <span class="sc">%&gt;%</span> </span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(activity_level,sun_exposure_duration,sun_exposure_shade_access,swim_cold_frequency,</span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>           swim_warm_frequency,</span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a>            swim_duration,swim_pace))</span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-6"><a href="#cb207-6" aria-hidden="true" tabindex="-1"></a><span class="co"># create a factor for each variable</span></span>
<span id="cb207-7"><a href="#cb207-7" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> variables <span class="sc">%&gt;%</span> </span>
<span id="cb207-8"><a href="#cb207-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), as.character))<span class="sc">%&gt;%</span></span>
<span id="cb207-9"><a href="#cb207-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character, as.factor)</span>
<span id="cb207-10"><a href="#cb207-10" aria-hidden="true" tabindex="-1"></a><span class="co">#now plot</span></span>
<span id="cb207-11"><a href="#cb207-11" aria-hidden="true" tabindex="-1"></a>gathered_data <span class="ot">&lt;-</span> variables <span class="sc">%&gt;%</span></span>
<span id="cb207-12"><a href="#cb207-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"column_name"</span>, <span class="at">value =</span> <span class="st">"value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: attributes are not identical across measure variables; they will be
dropped</code></pre>
</div>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co">#bar plot of categorical variables</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>var2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gathered_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(value), <span class="at">fill =</span> <span class="fu">factor</span>(value), <span class="at">group =</span> <span class="fu">interaction</span>(column_name, value))) <span class="sc">+</span></span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>column_name, <span class="at">scales =</span> <span class="st">"free_x"</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb209-5"><a href="#cb209-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Breakdown of variable values for activity"</span>,</span>
<span id="cb209-6"><a href="#cb209-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Value"</span>,</span>
<span id="cb209-7"><a href="#cb209-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb209-8"><a href="#cb209-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.key.size =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">"cm"</span>))</span>
<span id="cb209-9"><a href="#cb209-9" aria-hidden="true" tabindex="-1"></a>var2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GRLS-exploratory_files/figure-html/unnamed-chunk-46-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Most of the binary variables have a reasonable split between 0vs1 but not sure how useful activity is?</p>
<p>Perhaps keep:</p>
<ul>
<li><p>activity level</p></li>
<li><p>combine swim_cold_frequency and swim_warm_frequency = swim_frequency</p></li>
<li><p>swim_location_pool/pond/river/ocean &lt;- could be worth retaining in case suspect pollution/enviro exposure aspect?</p></li>
</ul>
</section>
</section>
<section id="washing" class="level2">
<h2 class="anchored" data-anchor-id="washing">Washing</h2>
<p>Shampoo washing found to be RF for cancer in the RF studies in an earlier VC PhD thesis.</p>
<p>CSV contains varying information on home or professional washing of dogs (freq and what product categories are used eg. shampoo, perfumed,flea/tick tx)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>wash_time <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"C:/Users/ctaylor18/GitHub/GRLS_analyses/Data/wash_groom.csv"</span>,<span class="at">na.strings=</span><span class="fu">c</span>(<span class="st">""</span>,<span class="st">"NA"</span>))</span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>wash_time <span class="ot">&lt;-</span> wash_time <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), tolower))</span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a><span class="co">#how many dogs have other wash hx</span></span>
<span id="cb210-5"><a href="#cb210-5" aria-hidden="true" tabindex="-1"></a>wash_timee_IDs <span class="ot">&lt;-</span> <span class="fu">unique</span>(wash_time<span class="sc">$</span>subject_id)</span>
<span id="cb210-6"><a href="#cb210-6" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(wash_timee_IDs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3044</code></pre>
</div>
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="co">#missing-ness of data</span></span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>missing.values_wash_time <span class="ot">&lt;-</span> wash_time <span class="sc">%&gt;%</span></span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"key"</span>, <span class="at">value =</span> <span class="st">"val"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">is.missing =</span> <span class="fu">is.na</span>(val)) <span class="sc">%&gt;%</span></span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(key, is.missing) <span class="sc">%&gt;%</span></span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">num.missing =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb212-7"><a href="#cb212-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(is.missing<span class="sc">==</span>T) <span class="sc">%&gt;%</span></span>
<span id="cb212-8"><a href="#cb212-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>is.missing) <span class="sc">%&gt;%</span></span>
<span id="cb212-9"><a href="#cb212-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(num.missing)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'key'. You can override using the `.groups`
argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>missing_value_wash_time <span class="ot">&lt;-</span> missing.values_wash_time <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Proportion =</span> num.missing <span class="sc">/</span> <span class="fu">nrow</span>(wash_time) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>missing_value_wash_time</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 19 × 3
# Groups:   key [19]
   key                                      num.missing Proportion
   &lt;chr&gt;                                          &lt;int&gt;      &lt;dbl&gt;
 1 pro_wash_groom_products_other_specify          21596      98.4 
 2 home_wash_groom_products_other_specify         20835      94.9 
 3 wash_groom_products_other_specify              20082      91.5 
 4 pro_wash_groom_products_flea_tick               3052      13.9 
 5 pro_wash_groom_products_hair_skin_dye           3052      13.9 
 6 pro_wash_groom_products_medicated               3052      13.9 
 7 pro_wash_groom_products_organic                 3052      13.9 
 8 pro_wash_groom_products_other                   3052      13.9 
 9 pro_wash_groom_products_perfumed                3052      13.9 
10 pro_wash_groom_products_regular_shampoo         3052      13.9 
11 wash_groom_products_other                       3044      13.9 
12 home_wash_groom_products_unknown                2440      11.1 
13 home_wash_groom_products_flea_tick               402       1.83
14 home_wash_groom_products_hair_skin_dye           402       1.83
15 home_wash_groom_products_medicated               402       1.83
16 home_wash_groom_products_organic                 402       1.83
17 home_wash_groom_products_other                   402       1.83
18 home_wash_groom_products_perfumed                402       1.83
19 home_wash_groom_products_regular_shampoo         402       1.83</code></pre>
</div>
</div>
<p>Lots of missing data in the pro wash columns - potentially reflects dogs that didnt have a pro-wash or just didnt know what the dogs were washed with</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>remove <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"pro_wash_groom_products_regular_shampoo"</span>,</span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>            <span class="st">"pro_wash_groom_products_flea_tick"</span>, <span class="st">"pro_wash_groom_products_perfumed"</span>,<span class="st">"pro_wash_groom_products_organic"</span>,<span class="st">"pro_wash_groom_products_hair_skin_dye"</span>,</span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a>            <span class="st">"pro_wash_groom_products_medicated"</span>,<span class="st">"pro_wash_groom_products_other"</span>,</span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a>            <span class="st">"pro_wash_groom_products_unknown"</span>,</span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">"pro_wash_groom_products_other_specify"</span>,</span>
<span id="cb216-6"><a href="#cb216-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">"home_wash_groom_products_other_specify"</span>,<span class="st">"wash_groom_products_other_specify"</span>, <span class="st">"pro_wash_groom_frequency"</span>,<span class="st">"home_wash_groom_frequency"</span></span>
<span id="cb216-7"><a href="#cb216-7" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb216-8"><a href="#cb216-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-9"><a href="#cb216-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-10"><a href="#cb216-10" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> wash_time <span class="sc">%&gt;%</span> </span>
<span id="cb216-11"><a href="#cb216-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">c</span>(subject_id,year_in_study,record_date))</span>
<span id="cb216-12"><a href="#cb216-12" aria-hidden="true" tabindex="-1"></a><span class="co">#remove those from list above with loads of missing </span></span>
<span id="cb216-13"><a href="#cb216-13" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> variables <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">all_of</span>(remove))</span>
<span id="cb216-14"><a href="#cb216-14" aria-hidden="true" tabindex="-1"></a><span class="co"># create a factor for each variable</span></span>
<span id="cb216-15"><a href="#cb216-15" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> variables <span class="sc">%&gt;%</span> </span>
<span id="cb216-16"><a href="#cb216-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), as.character))<span class="sc">%&gt;%</span></span>
<span id="cb216-17"><a href="#cb216-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character, as.factor)</span>
<span id="cb216-18"><a href="#cb216-18" aria-hidden="true" tabindex="-1"></a><span class="co">#now plot</span></span>
<span id="cb216-19"><a href="#cb216-19" aria-hidden="true" tabindex="-1"></a>gathered_data <span class="ot">&lt;-</span> variables <span class="sc">%&gt;%</span></span>
<span id="cb216-20"><a href="#cb216-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"column_name"</span>, <span class="at">value =</span> <span class="st">"value"</span>)</span>
<span id="cb216-21"><a href="#cb216-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-22"><a href="#cb216-22" aria-hidden="true" tabindex="-1"></a><span class="co">#bar plot of binary variables</span></span>
<span id="cb216-23"><a href="#cb216-23" aria-hidden="true" tabindex="-1"></a>binary_var <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gathered_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(value), <span class="at">fill =</span> <span class="fu">factor</span>(value), <span class="at">group =</span> <span class="fu">interaction</span>(column_name, value))) <span class="sc">+</span></span>
<span id="cb216-24"><a href="#cb216-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb216-25"><a href="#cb216-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>column_name, <span class="at">scales =</span> <span class="st">"free_x"</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb216-26"><a href="#cb216-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Breakdown of variable values for washing"</span>,</span>
<span id="cb216-27"><a href="#cb216-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Value"</span>,</span>
<span id="cb216-28"><a href="#cb216-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb216-29"><a href="#cb216-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() </span>
<span id="cb216-30"><a href="#cb216-30" aria-hidden="true" tabindex="-1"></a>binary_var</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GRLS-exploratory_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> wash_time <span class="sc">%&gt;%</span> </span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span><span class="fu">c</span>(subject_id,year_in_study,record_date))</span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a><span class="co">#remove those from list above with loads of missing </span></span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> variables <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(pro_wash_groom_frequency, home_wash_groom_frequency))</span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true" tabindex="-1"></a><span class="co"># create a factor for each variable</span></span>
<span id="cb217-6"><a href="#cb217-6" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> variables <span class="sc">%&gt;%</span> </span>
<span id="cb217-7"><a href="#cb217-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), as.character))<span class="sc">%&gt;%</span></span>
<span id="cb217-8"><a href="#cb217-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character, as.factor)</span>
<span id="cb217-9"><a href="#cb217-9" aria-hidden="true" tabindex="-1"></a><span class="co">#now plot</span></span>
<span id="cb217-10"><a href="#cb217-10" aria-hidden="true" tabindex="-1"></a>gathered_data <span class="ot">&lt;-</span> variables <span class="sc">%&gt;%</span></span>
<span id="cb217-11"><a href="#cb217-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">"column_name"</span>, <span class="at">value =</span> <span class="st">"value"</span>)</span>
<span id="cb217-12"><a href="#cb217-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-13"><a href="#cb217-13" aria-hidden="true" tabindex="-1"></a><span class="co">#bar plot of multi option variables</span></span>
<span id="cb217-14"><a href="#cb217-14" aria-hidden="true" tabindex="-1"></a>var2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gathered_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(value), <span class="at">fill =</span> <span class="fu">factor</span>(value), <span class="at">group =</span> <span class="fu">interaction</span>(column_name, value))) <span class="sc">+</span></span>
<span id="cb217-15"><a href="#cb217-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb217-16"><a href="#cb217-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>column_name, <span class="at">scales =</span> <span class="st">"free_x"</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb217-17"><a href="#cb217-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Breakdown of variable values for washing"</span>,</span>
<span id="cb217-18"><a href="#cb217-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Value"</span>,</span>
<span id="cb217-19"><a href="#cb217-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb217-20"><a href="#cb217-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span>
<span id="cb217-21"><a href="#cb217-21" aria-hidden="true" tabindex="-1"></a>var2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GRLS-exploratory_files/figure-html/unnamed-chunk-48-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Variables to keep:</p>
<ul>
<li><p>pro and home wash groom frequency</p></li>
<li><p>consider which of the many types of product might be of interest to keep (shampoo, organic, flea and tick, perfumed etc.)</p></li>
</ul>
<p><u>Family history of neoplasia?</u></p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>