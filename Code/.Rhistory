coxphmulti(dependent,explanatory)%>%
fit2df()
mod
cox_model_34<- coxph(Surv(survival_time_days, status) ~  avg_weight_5y_prior_endpoint_quartiles + avg_purina_BCS_5y_prior_endpoint_quartiles + avg_frequency_5y_prior_endpoint_quartiles + quartile_anti_parasites_5y_prior_endpoint+sex
+avg_activity_duration_sy1_2_quartiles +neutered_reason+
use_incense_or_candles_study_years_rest_of_life, data = cohort_abr_sig)
vif(cox_model_34)
analyse_model(cox_model_34,cohort_abr_sig,cox_model_26)
cox_model_34<- coxph(Surv(survival_time_days, status) ~  avg_weight_5y_prior_endpoint_quartiles + avg_purina_BCS_5y_prior_endpoint_quartiles + avg_frequency_5y_prior_endpoint_quartiles + quartile_anti_parasites_5y_prior_endpoint+sex
+avg_activity_duration_sy1_2_quartiles +neutered_reason+
use_incense_or_candles_study_years_whole_life, data = cohort_abr_sig)
vif(cox_model_34)
analyse_model(cox_model_34,cohort_abr_sig,cox_model_26)
cox_model_35<- coxph(Surv(survival_time_days, status) ~  avg_weight_5y_prior_endpoint_quartiles + avg_purina_BCS_5y_prior_endpoint_quartiles + avg_frequency_5y_prior_endpoint_quartiles + quartile_anti_parasites_5y_prior_endpoint+sex
+avg_activity_duration_sy1_2_quartiles +neutered_reason+
use_incense_or_candles_study_years_whole_life+
use_aerosol_study_years_whole_life, data = cohort_abr_sig)
vif(cox_model_35)
analyse_model(cox_model_35,cohort_abr_sig,cox_model_34)
cox_model_36<- coxph(Surv(survival_time_days, status) ~  avg_weight_5y_prior_endpoint_quartiles + avg_purina_BCS_5y_prior_endpoint_quartiles + avg_frequency_5y_prior_endpoint_quartiles + quartile_anti_parasites_5y_prior_endpoint+sex
+avg_activity_duration_sy1_2_quartiles +neutered_reason+
use_incense_or_candles_study_years_whole_life+
smoke_exposure_study_years_early_life, data = cohort_abr_sig)
vif(cox_model_36)
analyse_model(cox_model_36,cohort_abr_sig,cox_model_34)
cox_model_37<- coxph(Surv(survival_time_days, status) ~  avg_weight_5y_prior_endpoint_quartiles + avg_purina_BCS_5y_prior_endpoint_quartiles + avg_frequency_5y_prior_endpoint_quartiles + quartile_anti_parasites_5y_prior_endpoint+sex
+avg_activity_duration_sy1_2_quartiles +neutered_reason+
use_incense_or_candles_study_years_whole_life +
use_moth_balls_study_years_rest_of_life, data = cohort_abr_sig)
vif(cox_model_37)
analyse_model(cox_model_37,cohort_abr_sig,cox_model_34)
#lifelong
cox_model_40a<- coxph(Surv(survival_time_days, status) ~  avg_weight_5y_prior_endpoint_quartiles + avg_purina_BCS_5y_prior_endpoint_quartiles + avg_frequency_5y_prior_endpoint_quartiles + quartile_anti_parasites_5y_prior_endpoint+sex
+avg_activity_duration_sy1_2_quartiles +neutered_reason+
use_incense_or_candles_study_years_whole_life + lifelong_gastrointestinal
, data = cohort_abr_sig)
#vif(cox_model_40a)
analyse_model(cox_model_40a,cohort_abr_sig,cox_model_34)
#5y prior
cox_model_40b<- coxph(Surv(survival_time_days, status) ~  avg_weight_5y_prior_endpoint_quartiles + avg_purina_BCS_5y_prior_endpoint_quartiles + avg_frequency_5y_prior_endpoint_quartiles + quartile_anti_parasites_5y_prior_endpoint+sex
+avg_activity_duration_sy1_2_quartiles +neutered_reason+
use_incense_or_candles_study_years_whole_life+
gastrointestinal
, data = cohort_abr_sig)
#vif(cox_model_40b)
analyse_model(cox_model_40b,cohort_abr_sig,cox_model_34)
#all cause
cox_model_40c<- coxph(Surv(survival_time_days, status) ~  avg_weight_5y_prior_endpoint_quartiles + avg_purina_BCS_5y_prior_endpoint_quartiles + avg_frequency_5y_prior_endpoint_quartiles + quartile_anti_parasites_5y_prior_endpoint+sex
+avg_activity_duration_sy1_2_quartiles +neutered_reason+
use_incense_or_candles_study_years_whole_life+
gastrointestinal
, data = cohort_abr_sig)
#vif(cox_model_40b)
analyse_model(cox_model_40c,cohort_abr_sig,cox_model_34)
cox_model_41<- coxph(Surv(survival_time_days, status) ~  avg_weight_5y_prior_endpoint_quartiles + avg_purina_BCS_5y_prior_endpoint_quartiles + avg_frequency_5y_prior_endpoint_quartiles + quartile_anti_parasites_5y_prior_endpoint+sex
+avg_activity_duration_sy1_2_quartiles +neutered_reason+
use_incense_or_candles_study_years_whole_life+ lifelong_gastrointestinal + inflammatory_other
, data = cohort_abr_sig)
#vif(cox_model_40a)
analyse_model(cox_model_41,cohort_abr_sig,cox_model_40a)
analyse_model(cox_model_40a,cohort_abr_sig,cox_model_34)
cox_model_41<- coxph(Surv(survival_time_days, status) ~  avg_weight_5y_prior_endpoint_quartiles + avg_purina_BCS_5y_prior_endpoint_quartiles + avg_frequency_5y_prior_endpoint_quartiles + quartile_anti_parasites_5y_prior_endpoint+sex
+avg_activity_duration_sy1_2_quartiles +neutered_reason+
use_incense_or_candles_study_years_whole_life+ lifelong_gastrointestinal + inflammatory_other
, data = cohort_abr_sig)
#vif(cox_model_40a)
analyse_model(cox_model_41,cohort_abr_sig,cox_model_40a)
#5y
cox_model_42a<- coxph(Surv(survival_time_days, status) ~  avg_weight_5y_prior_endpoint_quartiles + avg_purina_BCS_5y_prior_endpoint_quartiles + avg_frequency_5y_prior_endpoint_quartiles + quartile_anti_parasites_5y_prior_endpoint+sex
+avg_activity_duration_sy1_2_quartiles +neutered_reason+
use_incense_or_candles_study_years_whole_life+ gastrointestinal + orthopaedic
, data = cohort_abr_sig)
#vif(cox_model_40a)
analyse_model(cox_model_42a,cohort_abr_sig,cox_model_40a)
cox_model_43<- coxph(Surv(survival_time_days, status) ~  avg_weight_5y_prior_endpoint_quartiles + avg_purina_BCS_5y_prior_endpoint_quartiles + avg_frequency_5y_prior_endpoint_quartiles + quartile_anti_parasites_5y_prior_endpoint+sex
+avg_activity_duration_sy1_2_quartiles +neutered_reason+
use_incense_or_candles_study_years_whole_life+gastrointestinal + immune_mediated
, data = cohort_abr_sig)
#vif(cox_model_40a)
analyse_model(cox_model_43,cohort_abr_sig,cox_model_40a)
cox_model_44<- coxph(Surv(survival_time_days, status) ~  avg_weight_5y_prior_endpoint_quartiles + avg_purina_BCS_5y_prior_endpoint_quartiles + avg_frequency_5y_prior_endpoint_quartiles + quartile_anti_parasites_5y_prior_endpoint+sex
+avg_activity_duration_sy1_2_quartiles +neutered_reason+
use_incense_or_candles_study_years_whole_life+gastrointestinal + chronic_inflam_present.x
, data = cohort_abr_sig)
#vif(cox_model_40a)
analyse_model(cox_model_44,cohort_abr_sig,cox_model_40a)
cox_model_45a<- coxph(Surv(survival_time_days, status) ~  avg_weight_5y_prior_endpoint_quartiles + avg_purina_BCS_5y_prior_endpoint_quartiles + avg_frequency_5y_prior_endpoint_quartiles + quartile_anti_parasites_5y_prior_endpoint+sex
+avg_activity_duration_sy1_2_quartiles +neutered_reason+
use_incense_or_candles_study_years_whole_life+gastrointestinal + benign_cancers_count
, data = cohort_abr_sig)
cox_model_45a<- coxph(Surv(survival_time_days, status) ~  avg_weight_5y_prior_endpoint_quartiles + avg_purina_BCS_5y_prior_endpoint_quartiles + avg_frequency_5y_prior_endpoint_quartiles + quartile_anti_parasites_5y_prior_endpoint+sex
+avg_activity_duration_sy1_2_quartiles +neutered_reason+
use_incense_or_candles_study_years_whole_life+gastrointestinal + benign_cancers_YN
, data = cohort_abr_sig)
analyse_model(cox_model_45a,cohort_abr_sig,cox_model_40a)
cox_model_45b<- coxph(Surv(survival_time_days, status) ~  avg_weight_5y_prior_endpoint_quartiles + avg_purina_BCS_5y_prior_endpoint_quartiles + avg_frequency_5y_prior_endpoint_quartiles + quartile_anti_parasites_5y_prior_endpoint+sex
+avg_activity_duration_sy1_2_quartiles +neutered_reason+
use_incense_or_candles_study_years_whole_life+gastrointestinal + all_cancers_count_no_HSA
, data = cohort_abr_sig)
analyse_model(cox_model_45b,cohort_abr_sig,cox_model_40a)
cox_model_45c<- coxph(Surv(survival_time_days, status) ~  avg_weight_5y_prior_endpoint_quartiles + avg_purina_BCS_5y_prior_endpoint_quartiles + avg_frequency_5y_prior_endpoint_quartiles + quartile_anti_parasites_5y_prior_endpoint+sex
+avg_activity_duration_sy1_2_quartiles +neutered_reason+
use_incense_or_candles_study_years_whole_life+gastrointestinal + malig_cancers_count_no_HSA
, data = cohort_abr_sig)
analyse_model(cox_model_45c,cohort_abr_sig,cox_model_40a)
cox_model_45d<- coxph(Surv(survival_time_days, status) ~  avg_weight_5y_prior_endpoint_quartiles + avg_purina_BCS_5y_prior_endpoint_quartiles + avg_frequency_5y_prior_endpoint_quartiles + quartile_anti_parasites_5y_prior_endpoint+sex
+avg_activity_duration_sy1_2_quartiles +neutered_reason+
use_incense_or_candles_study_years_whole_life+gastrointestinal + malig_cancers_YN_no_HSA
, data = cohort_abr_sig)
analyse_model(cox_model_45d,cohort_abr_sig,cox_model_40a)
#NSAID ever
cox_model_46<- coxph(Surv(survival_time_days, status) ~  avg_weight_5y_prior_endpoint_quartiles + avg_purina_BCS_5y_prior_endpoint_quartiles + avg_frequency_5y_prior_endpoint_quartiles + quartile_anti_parasites_5y_prior_endpoint+sex
+avg_activity_duration_sy1_2_quartiles +neutered_reason+
use_incense_or_candles_study_years_whole_life+gastrointestinal + all_cancers_count_no_HSA
+ NSAID_ever
, data = cohort_abr_sig)
analyse_model(cox_model_46,cohort_abr_sig,cox_model_45c)
#fenbendazole ever or 5y
cox_model_47a<- coxph(Surv(survival_time_days, status) ~  avg_weight_5y_prior_endpoint_quartiles + avg_purina_BCS_5y_prior_endpoint_quartiles + avg_frequency_5y_prior_endpoint_quartiles + quartile_anti_parasites_5y_prior_endpoint+sex
+avg_activity_duration_sy1_2_quartiles +neutered_reason+
use_incense_or_candles_study_years_whole_life+gastrointestinal + all_cancers_count_no_HSA
+ fenbendazole_ever
, data = cohort_abr_sig)
analyse_model(cox_model_47a,cohort_abr_sig,cox_model_45c)
cox_model_47b<- coxph(Surv(survival_time_days, status) ~  avg_weight_5y_prior_endpoint_quartiles + avg_purina_BCS_5y_prior_endpoint_quartiles + avg_frequency_5y_prior_endpoint_quartiles + quartile_anti_parasites_5y_prior_endpoint+sex
+avg_activity_duration_sy1_2_quartiles +neutered_reason+
use_incense_or_candles_study_years_whole_life+gastrointestinal + all_cancers_count_no_HSA
+ fenbendazole_5y
, data = cohort_abr_sig)
analyse_model(cox_model_47b,cohort_abr_sig,cox_model_45c)
explanatory <- c("avg_weight_5y_prior_endpoint_quartiles", "avg_purina_BCS_5y_prior_endpoint_quartiles","avg_frequency_5y_prior_endpoint_quartiles","quartile_anti_parasites_5y_prior_endpoint", "sex", "use_incense_or_candles_study_years_whole_life","avg_activity_duration_sy1_2_quartiles","neutered_reason","gastrointestinal","all_cancers_count_no_HSA")
dependent = 'Surv(survival_time_days,status)'
# Summarize the Cox model output in a table
mod <- cohort_abr_sig %>%
coxphmulti(dependent,explanatory)%>%
fit2df()
mod
View(mod)
explanatory <- c("avg_weight_5y_prior_endpoint_quartiles", "avg_purina_BCS_5y_prior_endpoint_quartiles","avg_frequency_5y_prior_endpoint_quartiles","quartile_anti_parasites_5y_prior_endpoint", "sex", "use_incense_or_candles_study_years_whole_life","avg_activity_duration_sy1_2_quartiles","neutered_reason","gastrointestinal","malig_cancers_count_no_HSA")
dependent = 'Surv(survival_time_days,status)'
# Summarize the Cox model output in a table
mod <- cohort_abr_sig %>%
coxphmulti(dependent,explanatory)%>%
fit2df()
mod
View(mod)
explanatory <- c("avg_weight_5y_prior_endpoint_quartiles", "avg_frequency_5y_prior_endpoint_quartiles","quartile_anti_parasites_5y_prior_endpoint", "sex","all_cancers_count_no_HSA")
dependent = 'Surv(survival_time_days,status)'
# Summarize the Cox model output in a table
mod <- cohort_abr_sig %>%
coxphmulti(dependent,explanatory)%>%
fit2df()
mod
View(mod)
# Exclude frailty from the explanatory variables for finalfit output
dependent = 'Surv(survival_time_days,status)'
explanatory_fixed = c("avg_weight_5y_prior_endpoint_quartiles", "avg_frequency_5y_prior_endpoint_quartiles","quartile_anti_parasites_5y_prior_endpoint", "sex","all_cancers_count_no_HSA")
# Generate the finalfit table for fixed effects only
HSA_multivar_cox_ph_table <- cohort_abr_sig %>%
finalfit(dependent, explanatory_fixed)
# Print the table
print(knitr::kable(HSA_multivar_cox_ph_table, row.names=FALSE, align=c("l", "l", "r", "r", "r")))
cox_model_f<- coxph(Surv(survival_time_days, status) ~  avg_weight_5y_prior_endpoint_quartiles + avg_frequency_5y_prior_endpoint_quartiles + quartile_anti_parasites_5y_prior_endpoint+sex+all_cancers_count_no_HSA
, data = cohort_abr_sig)
library(gtsummary)
tbl_regression(cox_model_f, exponentiate = TRUE)
ggforest(cox_model_f, data = cohort_abr_sig, fontsize = 1) + ggtitle("Factors associated with time to HSA diagnosis")
dependent = "Surv(survival_time_days, status)"
explanatory = c("avg_weight_5y_prior_endpoint_quartiles" ,"avg_frequency_5y_prior_endpoint_quartiles","quartile_anti_parasites_5y_prior_endpoint", "sex","all_cancers_count_no_HSA"
)
ph_schoen <- cohort_abr_sig %>%
coxphmulti(dependent, explanatory) %>%
cox.zph() %>%
{zph_result <<- .} %>%
plot(var=5)
zph_result
dependent_os = "Surv(survival_time_months, status)"
explanatory = c("avg_weight_5y_prior_endpoint_quartiles")
cohort_abr %>%
surv_plot(dependent_os, explanatory, pval = TRUE)
dependent_os = "Surv(survival_time_months, status)"
explanatory = c("avg_frequency_5y_prior_endpoint_quartiles")
cohort_abr %>%
surv_plot(dependent_os, explanatory, pval = TRUE)
dependent_os = "Surv(survival_time_months, status)"
explanatory = c("quartile_anti_parasites_5y_prior_endpoint")
cohort_abr %>%
surv_plot(dependent_os, explanatory, pval = TRUE)
dependent_os = "Surv(survival_time_months, status)"
explanatory = c("sex")
cohort_abr %>%
surv_plot(dependent_os, explanatory, pval = TRUE)
dependent_os = "Surv(survival_time_months, status)"
explanatory = c("all_cancers_count_no_HSA")
cohort_abr %>%
surv_plot(dependent_os, explanatory, pval = TRUE)
check_levels <- function(df) {
sapply(df, function(x) length(unique(na.omit(x))) >= 2)
}
# Example usage
result <- check_levels(cohort_no_not_rec)
# Print columns that do not meet the condition
names(result[result == FALSE])
source('C:/Users/ctaylor18/GitHub/HSA-VC-survival-analyses/HSA-VC-survival-analyses/code/functions/univar_cox_ph_table_funct.R')
cohort_no_not_rec$status_factor <- as.factor(as.character(cohort_no_not_rec$had_HSA))
cohort_no_not_rec$status <-as.numeric(cohort_no_not_rec$had_HSA)
cohort_no_not_rec$survival_time_months <- as.numeric(cohort_no_not_rec$survival_time_months)
cohort_no_not_rec$survival_time_days <- as.numeric(cohort_no_not_rec$survival_time_months)
explanatory = c("MDI_quintile","owner_MDI_quintile","area_type_mode_5yrs_prior","house_type_mode_5yrs_prior",
"water_source_mode_5yrs_prior", "pipes_metal_any_mode_5yrs_prior", "pipes_plastic_any_mode_5yrs_prior",
"heating_fuel_primary_mode_5yrs_prior", "cooking_fuel_primary_mode_5yrs_prior", "heating_fuel_secondary_mode_5yrs_prior",
"cooking_fuel_secondary_mode_5yrs_prior", "region_mode_5y_prior"
,"chronic_inflam_present_lifetime","number_comorbs_present_lifetime","chronic_inflam_present.x","chronic_inflam_present_5y","number_comorbs_present_5y","chronic_inflam_present_no_min_year","number_comorbs_present_no_min_year","intestinal_parasitism","tick_borne_parasitism","other_parasitism","all_parasitism","infectious","immune_mediated","cardiovascular","gastrointestinal","inflammatory_other","orthopaedic","chronic_inflammatory","lifelong_comorb_present.x","lifelong_orthopaedic","lifelong_immune_mediated","lifelong_cardiovascular","lifelong_gastrointestinal","lifelong_inflammatory_other","lifelong_chronic_inflammatory","number_lifelong_comorbs_present",
"USDA_30min_sy1_2", "activity_1h_min_sy1_2",
"activity_KC_2h_min_sy1_2", "avg_activity_duration_sy1_2_quartiles",#"avg_activity_intensity_sy1_2_terciles",
"avg_activity_freq_sy1_2_terciles",
"avg_activity_freq_sy3_terciles", "avg_activity_intensity_sy3_quartiles", "avg_intensity_5y_prior_endpoint_quartiles", "avg_frequency_5y_prior_endpoint_quartiles",
"use_aerosol_study_years_early_life", "use_air_cleaner_study_years_early_life", "use_hepa_filter_study_years_early_life",
"use_moth_balls_study_years_early_life", "use_incense_or_candles_study_years_early_life", "smoke_exposure_study_years_early_life",
#      "any_treated_weeds_study_years_early_life", "any_treated_insects_study_years_early_life", #"any_treated_fertilizer_study_years_early_life",
#    "use_aerosol_sum_early_life", "use_air_cleaner_sum_early_life", "use_hepa_filter_sum_early_life", "use_moth_balls_sum_early_life",
#   "use_incense_or_candles_sum_early_life",
#"smoke_exposure_sum_early_life",
#"any_treated_weeds_sum_early_life",
#         "any_treated_insects_sum_early_life", #"any_treated_fertilizer_sum_early_life",
"use_aerosol_study_years_rest_of_life",
"use_air_cleaner_study_years_rest_of_life", "use_hepa_filter_study_years_rest_of_life", "use_moth_balls_study_years_rest_of_life",
"use_incense_or_candles_study_years_rest_of_life", "smoke_exposure_study_years_rest_of_life", "any_treated_weeds_study_years_rest_of_life",
"any_treated_insects_study_years_rest_of_life", "any_treated_fertilizer_study_years_rest_of_life", #"use_aerosol_sum_rest_of_life",
#            "use_air_cleaner_sum_rest_of_life", "use_hepa_filter_sum_rest_of_life", "use_moth_balls_sum_rest_of_life",
#   "use_incense_or_candles_sum_rest_of_life",
# "smoke_exposure_sum_rest_of_life",
# "any_treated_weeds_sum_rest_of_life",
# "any_treated_insects_sum_rest_of_life", "any_treated_fertilizer_sum_rest_of_life",
"use_aerosol_study_years_whole_life",
"use_air_cleaner_study_years_whole_life", "use_hepa_filter_study_years_whole_life", "use_moth_balls_study_years_whole_life",
"use_incense_or_candles_study_years_whole_life", "smoke_exposure_study_years_whole_life", "any_treated_weeds_study_years_whole_life",
"any_treated_insects_study_years_whole_life", "any_treated_fertilizer_study_years_whole_life",# "use_aerosol_sum_whole_life",
#  "use_air_cleaner_sum_whole_life", "use_hepa_filter_sum_whole_life", "use_moth_balls_sum_whole_life",# "use_incense_or_candles_sum_whole_life",
# "smoke_exposure_sum_whole_life",
#"any_treated_weeds_sum_whole_life", "any_treated_insects_sum_whole_life",
# "any_treated_fertilizer_sum_whole_life",
"hours_of_smoke_early_life_total_dosage_terciles", "hours_of_smoke_rest_of_life_total_dosage_terciles",
"hours_of_smoke_whole_life_total_dosage_terciles", "in.the.garage_YN_study_years_early_life", "in.the.house_YN_study_years_early_life",
"outside_YN_study_years_early_life",  "in.the.house_YN_sum_early_life_terciles",
"in.the.garage_YN_study_years_rest_of_life", "in.the.house_YN_study_years_rest_of_life", "outside_YN_study_years_rest_of_life",
"in.the.house_YN_sum_rest_of_life_quartiles",
"in.the.garage_YN_study_years_whole_life", "in.the.house_YN_study_years_whole_life", "outside_YN_study_years_whole_life",
"in.the.house_YN_sum_whole_life_quartiles",
"majority_sleep_location_lifetime",  "main_lifestyle_category",
"main_lifestyle_category_mode_5yrs_prior", "sleep_location_mode_5yrs_prior",
"use_aerosol_exposed_5yrs_prior", "use_air_cleaner_exposed_5yrs_prior", "use_hepa_filter_exposed_5yrs_prior",
"use_moth_balls_exposed_5yrs_prior", "use_incense_or_candles_exposed_5yrs_prior", "smoke_exposure_exposed_5yrs_prior",
"any_treated_weeds_exposed_5yrs_prior", "any_treated_insects_exposed_5yrs_prior", "any_treated_fertilizer_exposed_5yrs_prior",
"hours_of_smoke_exposure_hours_5yrs_prior_terciles", "sex", "neuter", "mismating_ever",
"neutered_reason", "neutered_ever_bred", "spayed_while_in_heat", "spayed_while_pregnant", "prevent_heat_ever",
"no_pregnancy_ever", "intact_sired_litters_natural_ever", "neutered_females_bred_with_count_ever",
"neutered_sired_litters_natural_ever", "heats_before_neutering", "heats_before_neutering_terciles",
"preg_pre_neuter",# "mated_pre_neuter",
"num_breeding_before_neutering_terciles", "ever_bred_from",
"avg_weight_5y_prior_endpoint_quartiles", "avg_height_5y_prior_endpoint_quartiles",
"avg_purina_BCS_5y_prior_endpoint_quartiles", "mode_purina_BCS_5y_prior_endpoint", "mode_BCS_classify", "half_anti_microbials_lifetime", "half_dietary_supplements_lifetime",
"half_enteric_lifetime", "half_fluid_metabolites_lifetime", "half_hormones_and_related_lifetime", "half_immunologicals_lifetime",
"half_misc_lifetime", "half_neurological_lifetime", "half_anti_parasites_lifetime", "half_anti_septics_lifetime",
"half_cardio_respiratory_lifetime", "half_diuretics_lifetime", "half_anti_hist_lifetime",
"quartile_anti_inflam_lifetime", "quartile_anti_microbials_lifetime", "quartile_dietary_supplements_lifetime",
#not enough data for quartiles "quartile_enteric_lifetime", "quartile_fluid_metabolites_lifetime",
"quartile_hormones_and_related_lifetime",
"quartile_immunologicals_lifetime", "quartile_misc_lifetime", "quartile_neurological_lifetime",
"quartile_anti_parasites_lifetime",
#not enough data for quartiles "quartile_anti_septics_lifetime", "quartile_cardio_respiratory_lifetime",   "quartile_diuretics_lifetime", "quartile_anti_hist_lifetime",
"half_anti_inflam_5y_prior_endpoint", "half_anti_microbials_5y_prior_endpoint", "half_enteric_5y_prior_endpoint",
"half_immunologicals_5y_prior_endpoint", "half_misc_5y_prior_endpoint", "half_neurological_5y_prior_endpoint",
"half_anti_parasites_5y_prior_endpoint", "half_dietary_supplements_5y_prior_endpoint",
"half_anti_septics_5y_prior_endpoint", "half_hormones_and_related_5y_prior_endpoint",
"half_cardio_respiratory_5y_prior_endpoint", "half_fluid_metabolites_5y_prior_endpoint",
"half_diuretics_5y_prior_endpoint", "half_anti_hist_5y_prior_endpoint",
"quartile_anti_inflam_5y_prior_endpoint", "quartile_anti_microbials_5y_prior_endpoint",
# "quartile_enteric_5y_prior_endpoint",
"quartile_immunologicals_5y_prior_endpoint",
"quartile_misc_5y_prior_endpoint", "quartile_neurological_5y_prior_endpoint",
"quartile_anti_parasites_5y_prior_endpoint", "quartile_dietary_supplements_5y_prior_endpoint",
#      "quartile_anti_septics_5y_prior_endpoint",
"quartile_hormones_and_related_5y_prior_endpoint",
#   "quartile_cardio_respiratory_5y_prior_endpoint", #"quartile_fluid_metabolites_5y_prior_endpoint",
#    "quartile_diuretics_5y_prior_endpoint", "quartile_anti_hist_5y_prior_endpoint",
#"quartile_anti_viral_5y_prior_endpoint",
"age_at_final_date_quartiles","age_at_neuter_years_quartiles",
"malig_cancers_count","benign_cancers_count","all_cancers_count","all_cancers_YN","benign_cancers_YN","malig_cancers_YN","all_cancers_count_no_HSA","malig_cancers_count_no_HSA","malig_cancers_YN_no_HSA","all_cancers_YN_no_HSA","NSAID_5y","NSAID_ever","steroid_5y","steroid_ever","fenbendazole_5y","fenbendazole_ever"  )
dependent = "status_factor"
results <- cohort_no_not_rec %>%
summary_factorlist(dependent, explanatory,
p=TRUE, add_dependent_label=TRUE,na_include = FALSE) -> t1
knitr::kable(t1, row.names=FALSE, align=c("l", "l", "r", "r", "r"))
results_df <- as.data.frame(results)
# Write the results to CSV
write.csv(results_df, "C:/Users/ctaylor18/GitHub/GRLS_analyses/Output/HSA_cross_table_case_control_output_no_missing.csv", row.names = FALSE)
#save as worddoc
# Install and load the required packages
library(officer)
library(flextable)
# Create a Word document
doc <- read_docx()
# Convert finalfit output to a flextable
results_flextable <- flextable(results_df)
# Add the flextable to the Word document
doc <- doc %>%
body_add_flextable(results_flextable) %>%
body_add_par("Finalfit Regression Results", style = "heading 1")
# Save the Word document
print(doc, target = "C:/Users/ctaylor18/GitHub/GRLS_analyses/Output/HSA_cross_table_case_control_output_no_missing.docx")
perform_univariable_analysis(
data = cohort_no_not_rec,
dependent_var = "status",
dependent_var_factor="status_factor",
explanatory_vars = c("MDI_quintile","owner_MDI_quintile","area_type_mode_5yrs_prior","house_type_mode_5yrs_prior",
"water_source_mode_5yrs_prior", "pipes_metal_any_mode_5yrs_prior", "pipes_plastic_any_mode_5yrs_prior",
"heating_fuel_primary_mode_5yrs_prior", "cooking_fuel_primary_mode_5yrs_prior", "heating_fuel_secondary_mode_5yrs_prior",
"cooking_fuel_secondary_mode_5yrs_prior", "region_mode_5y_prior",  #"number_comorbs_present_lifetime",
# "study_year_first_chronic_inflam", #"chronic_inflam_present_5y", #"number_comorbs_present_5y",
# "chronic_inflam_present_no_min_year", "number_comorbs_present_no_min_year",  "diagnosis_after_comorb",  "time_between_first_comorb_and_endpoint",
"num_lifetime_chronic_inflam", "intestinal_parasitism","tick_borne_parasitism","other_parasitism","all_parasitism","infectious","orthopaedic","immune_mediated","cardiovascular","gastrointestinal","inflammatory_other","chronic_inflammatory",
"USDA_30min_sy1_2", "activity_1h_min_sy1_2",
"activity_KC_2h_min_sy1_2", "avg_activity_duration_sy1_2_quartiles",#"avg_activity_intensity_sy1_2_terciles",
"avg_activity_freq_sy1_2_terciles",
"avg_activity_freq_sy3_terciles", "avg_activity_intensity_sy3_quartiles", "avg_intensity_5y_prior_endpoint_quartiles", "avg_frequency_5y_prior_endpoint_quartiles",
"use_aerosol_study_years_early_life", "use_air_cleaner_study_years_early_life", "use_hepa_filter_study_years_early_life",
"use_moth_balls_study_years_early_life", "use_incense_or_candles_study_years_early_life", "smoke_exposure_study_years_early_life",
#      "any_treated_weeds_study_years_early_life", "any_treated_insects_study_years_early_life", #"any_treated_fertilizer_study_years_early_life",
#    "use_aerosol_sum_early_life", "use_air_cleaner_sum_early_life", "use_hepa_filter_sum_early_life", "use_moth_balls_sum_early_life",
#   "use_incense_or_candles_sum_early_life",
#"smoke_exposure_sum_early_life",
#"any_treated_weeds_sum_early_life",
#         "any_treated_insects_sum_early_life", #"any_treated_fertilizer_sum_early_life",
"use_aerosol_study_years_rest_of_life",
"use_air_cleaner_study_years_rest_of_life", "use_hepa_filter_study_years_rest_of_life", "use_moth_balls_study_years_rest_of_life",
"use_incense_or_candles_study_years_rest_of_life", "smoke_exposure_study_years_rest_of_life", "any_treated_weeds_study_years_rest_of_life",
"any_treated_insects_study_years_rest_of_life", "any_treated_fertilizer_study_years_rest_of_life", #"use_aerosol_sum_rest_of_life",
#            "use_air_cleaner_sum_rest_of_life", "use_hepa_filter_sum_rest_of_life", "use_moth_balls_sum_rest_of_life",
#   "use_incense_or_candles_sum_rest_of_life",
# "smoke_exposure_sum_rest_of_life",
# "any_treated_weeds_sum_rest_of_life",
# "any_treated_insects_sum_rest_of_life", "any_treated_fertilizer_sum_rest_of_life",
"use_aerosol_study_years_whole_life",
"use_air_cleaner_study_years_whole_life", "use_hepa_filter_study_years_whole_life", "use_moth_balls_study_years_whole_life",
"use_incense_or_candles_study_years_whole_life", "smoke_exposure_study_years_whole_life", "any_treated_weeds_study_years_whole_life",
"any_treated_insects_study_years_whole_life", "any_treated_fertilizer_study_years_whole_life",# "use_aerosol_sum_whole_life",
#  "use_air_cleaner_sum_whole_life", "use_hepa_filter_sum_whole_life", "use_moth_balls_sum_whole_life",# "use_incense_or_candles_sum_whole_life",
# "smoke_exposure_sum_whole_life",
#"any_treated_weeds_sum_whole_life", "any_treated_insects_sum_whole_life",
# "any_treated_fertilizer_sum_whole_life",
"hours_of_smoke_early_life_total_dosage_terciles", "hours_of_smoke_rest_of_life_total_dosage_terciles",
"hours_of_smoke_whole_life_total_dosage_terciles", "in.the.garage_YN_study_years_early_life", "in.the.house_YN_study_years_early_life",
"outside_YN_study_years_early_life",  "in.the.house_YN_sum_early_life_terciles",
"in.the.garage_YN_study_years_rest_of_life", "in.the.house_YN_study_years_rest_of_life", "outside_YN_study_years_rest_of_life",
"in.the.house_YN_sum_rest_of_life_quartiles",
"in.the.garage_YN_study_years_whole_life", "in.the.house_YN_study_years_whole_life", "outside_YN_study_years_whole_life",
"in.the.house_YN_sum_whole_life_quartiles",
"majority_sleep_location_lifetime",  "main_lifestyle_category",
"main_lifestyle_category_mode_5yrs_prior", "sleep_location_mode_5yrs_prior",
"use_aerosol_exposed_5yrs_prior", "use_air_cleaner_exposed_5yrs_prior", "use_hepa_filter_exposed_5yrs_prior",
"use_moth_balls_exposed_5yrs_prior", "use_incense_or_candles_exposed_5yrs_prior", "smoke_exposure_exposed_5yrs_prior",
"any_treated_weeds_exposed_5yrs_prior", "any_treated_insects_exposed_5yrs_prior", "any_treated_fertilizer_exposed_5yrs_prior",
"hours_of_smoke_exposure_hours_5yrs_prior_terciles", "sex", "neuter", "mismating_ever",
"neutered_reason", "neutered_ever_bred", "spayed_while_in_heat", "spayed_while_pregnant", "prevent_heat_ever",
"no_pregnancy_ever", "intact_sired_litters_natural_ever", "neutered_females_bred_with_count_ever",
"neutered_sired_litters_natural_ever", "heats_before_neutering", "heats_before_neutering_terciles",
"preg_pre_neuter",# "mated_pre_neuter",
"num_breeding_before_neutering_terciles", "ever_bred_from",
"avg_weight_5y_prior_endpoint_quartiles", "avg_height_5y_prior_endpoint_quartiles",
"avg_purina_BCS_5y_prior_endpoint_quartiles", "mode_purina_BCS_5y_prior_endpoint", "mode_BCS_classify", "half_anti_microbials_lifetime", "half_dietary_supplements_lifetime",
"half_enteric_lifetime", "half_fluid_metabolites_lifetime", "half_hormones_and_related_lifetime", "half_immunologicals_lifetime",
"half_misc_lifetime", "half_neurological_lifetime", "half_anti_parasites_lifetime", "half_anti_septics_lifetime",
"half_cardio_respiratory_lifetime", "half_diuretics_lifetime", "half_anti_hist_lifetime",
"quartile_anti_inflam_lifetime", "quartile_anti_microbials_lifetime", "quartile_dietary_supplements_lifetime",
#not enough data for quartiles "quartile_enteric_lifetime", "quartile_fluid_metabolites_lifetime",
"quartile_hormones_and_related_lifetime",
"quartile_immunologicals_lifetime", "quartile_misc_lifetime", "quartile_neurological_lifetime",
"quartile_anti_parasites_lifetime",
#not enough data for quartiles "quartile_anti_septics_lifetime", "quartile_cardio_respiratory_lifetime",   "quartile_diuretics_lifetime", "quartile_anti_hist_lifetime",
"half_anti_inflam_5y_prior_endpoint", "half_anti_microbials_5y_prior_endpoint", "half_enteric_5y_prior_endpoint",
"half_immunologicals_5y_prior_endpoint", "half_misc_5y_prior_endpoint", "half_neurological_5y_prior_endpoint",
"half_anti_parasites_5y_prior_endpoint", "half_dietary_supplements_5y_prior_endpoint",
"half_anti_septics_5y_prior_endpoint", "half_hormones_and_related_5y_prior_endpoint",
"half_cardio_respiratory_5y_prior_endpoint", "half_fluid_metabolites_5y_prior_endpoint",
"half_diuretics_5y_prior_endpoint", "half_anti_hist_5y_prior_endpoint",
"quartile_anti_inflam_5y_prior_endpoint", "quartile_anti_microbials_5y_prior_endpoint",
# "quartile_enteric_5y_prior_endpoint",
"quartile_immunologicals_5y_prior_endpoint",
"quartile_misc_5y_prior_endpoint", "quartile_neurological_5y_prior_endpoint",
"quartile_anti_parasites_5y_prior_endpoint", "quartile_dietary_supplements_5y_prior_endpoint",
#      "quartile_anti_septics_5y_prior_endpoint",
"quartile_hormones_and_related_5y_prior_endpoint",
#   "quartile_cardio_respiratory_5y_prior_endpoint", #"quartile_fluid_metabolites_5y_prior_endpoint",
#    "quartile_diuretics_5y_prior_endpoint", "quartile_anti_hist_5y_prior_endpoint",
#"quartile_anti_viral_5y_prior_endpoint",
"age_at_final_date_quartiles","age_at_neuter_years_quartiles"),
output_csv = "C:/Users/ctaylor18/GitHub/GRLS_analyses/Output/HSA_GRLS_time_to_HSA_cox_ph_univar_no_missing.csv",
output_doc = "C:/Users/ctaylor18/GitHub/GRLS_analyses/Output/HSA_GRLS_time_to_HSA_cox_ph_univar_no_missing.docx"
)
perform_univariable_analysis(
data = cohort_no_not_rec,
dependent_var = "status",
dependent_var_factor="status_factor",
explanatory_vars = c("MDI_quintile","owner_MDI_quintile","area_type_mode_5yrs_prior","house_type_mode_5yrs_prior",
"water_source_mode_5yrs_prior", "pipes_metal_any_mode_5yrs_prior", "pipes_plastic_any_mode_5yrs_prior",
"heating_fuel_primary_mode_5yrs_prior", "cooking_fuel_primary_mode_5yrs_prior", "heating_fuel_secondary_mode_5yrs_prior",
"cooking_fuel_secondary_mode_5yrs_prior", "region_mode_5y_prior",  #"number_comorbs_present_lifetime",
# "study_year_first_chronic_inflam", #"chronic_inflam_present_5y", #"number_comorbs_present_5y",
# "chronic_inflam_present_no_min_year", "number_comorbs_present_no_min_year",  "diagnosis_after_comorb",  "time_between_first_comorb_and_endpoint",
"intestinal_parasitism","tick_borne_parasitism","other_parasitism","all_parasitism","infectious","orthopaedic","immune_mediated","cardiovascular","gastrointestinal","inflammatory_other","chronic_inflammatory",
"USDA_30min_sy1_2", "activity_1h_min_sy1_2",
"activity_KC_2h_min_sy1_2", "avg_activity_duration_sy1_2_quartiles",#"avg_activity_intensity_sy1_2_terciles",
"avg_activity_freq_sy1_2_terciles",
"avg_activity_freq_sy3_terciles", "avg_activity_intensity_sy3_quartiles", "avg_intensity_5y_prior_endpoint_quartiles", "avg_frequency_5y_prior_endpoint_quartiles",
"use_aerosol_study_years_early_life", "use_air_cleaner_study_years_early_life", "use_hepa_filter_study_years_early_life",
"use_moth_balls_study_years_early_life", "use_incense_or_candles_study_years_early_life", "smoke_exposure_study_years_early_life",
#      "any_treated_weeds_study_years_early_life", "any_treated_insects_study_years_early_life", #"any_treated_fertilizer_study_years_early_life",
#    "use_aerosol_sum_early_life", "use_air_cleaner_sum_early_life", "use_hepa_filter_sum_early_life", "use_moth_balls_sum_early_life",
#   "use_incense_or_candles_sum_early_life",
#"smoke_exposure_sum_early_life",
#"any_treated_weeds_sum_early_life",
#         "any_treated_insects_sum_early_life", #"any_treated_fertilizer_sum_early_life",
"use_aerosol_study_years_rest_of_life",
"use_air_cleaner_study_years_rest_of_life", "use_hepa_filter_study_years_rest_of_life", "use_moth_balls_study_years_rest_of_life",
"use_incense_or_candles_study_years_rest_of_life", "smoke_exposure_study_years_rest_of_life", "any_treated_weeds_study_years_rest_of_life",
"any_treated_insects_study_years_rest_of_life", "any_treated_fertilizer_study_years_rest_of_life", #"use_aerosol_sum_rest_of_life",
#            "use_air_cleaner_sum_rest_of_life", "use_hepa_filter_sum_rest_of_life", "use_moth_balls_sum_rest_of_life",
#   "use_incense_or_candles_sum_rest_of_life",
# "smoke_exposure_sum_rest_of_life",
# "any_treated_weeds_sum_rest_of_life",
# "any_treated_insects_sum_rest_of_life", "any_treated_fertilizer_sum_rest_of_life",
"use_aerosol_study_years_whole_life",
"use_air_cleaner_study_years_whole_life", "use_hepa_filter_study_years_whole_life", "use_moth_balls_study_years_whole_life",
"use_incense_or_candles_study_years_whole_life", "smoke_exposure_study_years_whole_life", "any_treated_weeds_study_years_whole_life",
"any_treated_insects_study_years_whole_life", "any_treated_fertilizer_study_years_whole_life",# "use_aerosol_sum_whole_life",
#  "use_air_cleaner_sum_whole_life", "use_hepa_filter_sum_whole_life", "use_moth_balls_sum_whole_life",# "use_incense_or_candles_sum_whole_life",
# "smoke_exposure_sum_whole_life",
#"any_treated_weeds_sum_whole_life", "any_treated_insects_sum_whole_life",
# "any_treated_fertilizer_sum_whole_life",
"hours_of_smoke_early_life_total_dosage_terciles", "hours_of_smoke_rest_of_life_total_dosage_terciles",
"hours_of_smoke_whole_life_total_dosage_terciles", "in.the.garage_YN_study_years_early_life", "in.the.house_YN_study_years_early_life",
"outside_YN_study_years_early_life",  "in.the.house_YN_sum_early_life_terciles",
"in.the.garage_YN_study_years_rest_of_life", "in.the.house_YN_study_years_rest_of_life", "outside_YN_study_years_rest_of_life",
"in.the.house_YN_sum_rest_of_life_quartiles",
"in.the.garage_YN_study_years_whole_life", "in.the.house_YN_study_years_whole_life", "outside_YN_study_years_whole_life",
"in.the.house_YN_sum_whole_life_quartiles",
"majority_sleep_location_lifetime",  "main_lifestyle_category",
"main_lifestyle_category_mode_5yrs_prior", "sleep_location_mode_5yrs_prior",
"use_aerosol_exposed_5yrs_prior", "use_air_cleaner_exposed_5yrs_prior", "use_hepa_filter_exposed_5yrs_prior",
"use_moth_balls_exposed_5yrs_prior", "use_incense_or_candles_exposed_5yrs_prior", "smoke_exposure_exposed_5yrs_prior",
"any_treated_weeds_exposed_5yrs_prior", "any_treated_insects_exposed_5yrs_prior", "any_treated_fertilizer_exposed_5yrs_prior",
"hours_of_smoke_exposure_hours_5yrs_prior_terciles", "sex", "neuter", "mismating_ever",
"neutered_reason", "neutered_ever_bred", "spayed_while_in_heat", "spayed_while_pregnant", "prevent_heat_ever",
"no_pregnancy_ever", "intact_sired_litters_natural_ever", "neutered_females_bred_with_count_ever",
"neutered_sired_litters_natural_ever", "heats_before_neutering", "heats_before_neutering_terciles",
"preg_pre_neuter",# "mated_pre_neuter",
"num_breeding_before_neutering_terciles", "ever_bred_from",
"avg_weight_5y_prior_endpoint_quartiles", "avg_height_5y_prior_endpoint_quartiles",
"avg_purina_BCS_5y_prior_endpoint_quartiles", "mode_purina_BCS_5y_prior_endpoint", "mode_BCS_classify", "half_anti_microbials_lifetime", "half_dietary_supplements_lifetime",
"half_enteric_lifetime", "half_fluid_metabolites_lifetime", "half_hormones_and_related_lifetime", "half_immunologicals_lifetime",
"half_misc_lifetime", "half_neurological_lifetime", "half_anti_parasites_lifetime", "half_anti_septics_lifetime",
"half_cardio_respiratory_lifetime", "half_diuretics_lifetime", "half_anti_hist_lifetime",
"quartile_anti_inflam_lifetime", "quartile_anti_microbials_lifetime", "quartile_dietary_supplements_lifetime",
#not enough data for quartiles "quartile_enteric_lifetime", "quartile_fluid_metabolites_lifetime",
"quartile_hormones_and_related_lifetime",
"quartile_immunologicals_lifetime", "quartile_misc_lifetime", "quartile_neurological_lifetime",
"quartile_anti_parasites_lifetime",
#not enough data for quartiles "quartile_anti_septics_lifetime", "quartile_cardio_respiratory_lifetime",   "quartile_diuretics_lifetime", "quartile_anti_hist_lifetime",
"half_anti_inflam_5y_prior_endpoint", "half_anti_microbials_5y_prior_endpoint", "half_enteric_5y_prior_endpoint",
"half_immunologicals_5y_prior_endpoint", "half_misc_5y_prior_endpoint", "half_neurological_5y_prior_endpoint",
"half_anti_parasites_5y_prior_endpoint", "half_dietary_supplements_5y_prior_endpoint",
"half_anti_septics_5y_prior_endpoint", "half_hormones_and_related_5y_prior_endpoint",
"half_cardio_respiratory_5y_prior_endpoint", "half_fluid_metabolites_5y_prior_endpoint",
"half_diuretics_5y_prior_endpoint", "half_anti_hist_5y_prior_endpoint",
"quartile_anti_inflam_5y_prior_endpoint", "quartile_anti_microbials_5y_prior_endpoint",
# "quartile_enteric_5y_prior_endpoint",
"quartile_immunologicals_5y_prior_endpoint",
"quartile_misc_5y_prior_endpoint", "quartile_neurological_5y_prior_endpoint",
"quartile_anti_parasites_5y_prior_endpoint", "quartile_dietary_supplements_5y_prior_endpoint",
#      "quartile_anti_septics_5y_prior_endpoint",
"quartile_hormones_and_related_5y_prior_endpoint",
#   "quartile_cardio_respiratory_5y_prior_endpoint", #"quartile_fluid_metabolites_5y_prior_endpoint",
#    "quartile_diuretics_5y_prior_endpoint", "quartile_anti_hist_5y_prior_endpoint",
#"quartile_anti_viral_5y_prior_endpoint",
"age_at_final_date_quartiles","age_at_neuter_years_quartiles"),
output_csv = "C:/Users/ctaylor18/GitHub/GRLS_analyses/Output/HSA_GRLS_time_to_HSA_cox_ph_univar_no_missing.csv",
output_doc = "C:/Users/ctaylor18/GitHub/GRLS_analyses/Output/HSA_GRLS_time_to_HSA_cox_ph_univar_no_missing.docx"
)
lrt_pvalues <-read.csv("C:/Users/ctaylor18/GitHub/GRLS_analyses/Output/HSA_GRLS_time_to_HSA_cox_ph_univar_no_missing.csv")
multivar_variables <- lrt_pvalues %>%
filter(lrt_pvalue <= 0.2) %>%
distinct(variable)
cols_to_keep = multivar_variables$variable
cols_to_keep <- append(cols_to_keep, "status")
cols_to_keep <- append(cols_to_keep, "survival_time_days")
cols_to_keep <- append(cols_to_keep, "status_factor")
cohort_no_not_rec_sig <- cohort_no_not_rec[,cols_to_keep]
lrt_pvalues$pval <- sprintf("%.20f", lrt_pvalues$lrt_pvalue)
source("C:/Users/ctaylor18/GitHub/HSA-VC-enviro-analyses/functions/corr_matrix_creation.R")
#use sig variables list generated above
create_corr_matrix(cohort_no_not_rec_sig,c(1:63), "C:/Users/ctaylor18/GitHub/GRLS_analyses/Output/hsa_corr_matrix_quartiles_survival_no_missing.csv", "C:/Users/ctaylor18/GitHub/GRLS_analyses/Output/hsa_corr_matrix_quartiles_survival2_no_missing.csv","C:/Users/ctaylor18/GitHub/GRLS_analyses/Output/hsa_corr_matrix_quartiles_survival_corrvalue_no_missing.csv","C:/Users/ctaylor18/GitHub/GRLS_analyses/Output/hsa_corr_matrix_quartiles_survival_no_missing.png")
corr_values <- read.csv("C:/Users/ctaylor18/GitHub/GRLS_analyses/Output/hsa_corr_matrix_quartiles_survival_corrvalue_no_missing.csv")
#ditch rows where variable 1 and 2 values are same as in another row :
corr_values2 <- corr_values %>%
dplyr::select(-c(X))
corr_values3 <- corr_values2 %>%
mutate(Var1_sorted = pmin(Variable1, Variable2),
Var2_sorted = pmax(Variable1, Variable2)) %>%
distinct(Var1_sorted, Var2_sorted, Correlation, .keep_all = TRUE) %>%
dplyr::select(-Var1_sorted, -Var2_sorted)  # Remove helper columns
print(corr_values3)
