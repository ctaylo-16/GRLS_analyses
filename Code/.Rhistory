avg_activity_intensity_sy3 <= 20 ~ "slow_walks",
avg_activity_intensity_sy3 >20 & avg_activity_intensity_sy3<= 40 ~ "average_walks",
avg_activity_intensity_sy3 >40 & avg_activity_intensity_sy3<= 60 ~ "brisk_walks",
avg_activity_intensity_sy3 >60 & avg_activity_intensity_sy3 <= 80 ~ "jogs",
avg_activity_intensity_sy3 >80 & avg_activity_intensity_sy3<= 100 ~ "runs"
))
#5y prior endpoint  freq
cohort_abr <- cohort_abr %>%
mutate(avg_frequency_5y_prior_endpoint = as.numeric(as.character(avg_activity_freq_sy3))) %>%
mutate(avg_frequency_5y_prior_endpoint_splits = case_when(
avg_frequency_5y_prior_endpoint <= 20 ~ "rarely",
avg_frequency_5y_prior_endpoint >20 & avg_frequency_5y_prior_endpoint<= 40 ~ "monthly",
avg_frequency_5y_prior_endpoint >40 & avg_frequency_5y_prior_endpoint<= 60 ~ "weekly",
avg_frequency_5y_prior_endpoint >60 & avg_frequency_5y_prior_endpoint <= 80 ~ "daily",
avg_frequency_5y_prior_endpoint >80 &avg_frequency_5y_prior_endpoint<= 100 ~ "multi_daily"
))
#swap not_recorded for NA and exclude from univar this way
cohort_no_not_rec <- cohort_abr %>%
mutate(across(
where(~ is.character(.) | is.factor(.)),
~ factor(na_if(as.character(.), "not_recorded"))
))
dependent <- "had_HSA"
# All other variables as explanatory variables
explanatory = c(
#demog
"age_at_final_date_GB","age_at_final_date_bio", "age_at_final_date_quartiles","age_at_neuter_years_quartiles","sex_neuter",
"sex", "neuter", "mismating_ever",
"neutered_reason", "neutered_ever_bred", "spayed_while_in_heat", "spayed_while_pregnant", "prevent_heat_ever",
"no_pregnancy_ever", "intact_sired_litters_natural_ever", "neutered_females_bred_with_count_ever",
"neutered_sired_litters_natural_ever", "heats_before_neutering", "heats_before_neutering_terciles",
"preg_pre_neuter",
"num_breeding_before_neutering_terciles", "ever_bred_from",
"avg_weight_5y_prior_endpoint_quartiles","avg_weight_5y_prior_endpoint_kg_biological", "avg_height_5y_prior_endpoint_quartiles",
"avg_purina_BCS_5y_prior_endpoint_quartiles", "mode_purina_BCS_5y_prior_endpoint", "mode_BCS_classify",
#lifestyle/activity
"main_lifestyle_category",
"main_lifestyle_category_mode_5yrs_prior", "USDA_30min_sy1_2", "activity_1h_min_sy1_2",
"activity_KC_2h_min_sy1_2", "avg_activity_duration_sy1_2_quartile",
"avg_activity_intensity_sy3_quartile", "avg_intensity_5y_prior_endpoint_quartile", "avg_frequency_5y_prior_endpoint_quartile", "avg_activity_duration_sy1_2_splits",
"avg_activity_freq_sy1_2_splits",
"avg_activity_freq_sy3_splits", "avg_activity_intensity_sy3_splits",  "avg_frequency_5y_prior_endpoint_splits",
#home/environmental
"MDI_quintile","owner_MDI_quintile","area_type_mode_5yrs_prior","house_type_mode_5yrs_prior",
"water_source_mode_5yrs_prior", "pipes_metal_any_mode_5yrs_prior", "pipes_plastic_any_mode_5yrs_prior",
"heating_fuel_primary_mode_5yrs_prior", "cooking_fuel_primary_mode_5yrs_prior", "heating_fuel_secondary_mode_5yrs_prior",
"cooking_fuel_secondary_mode_5yrs_prior", "region_mode_5y_prior","use_aerosol_study_years_early_life", "use_air_cleaner_study_years_early_life", "use_hepa_filter_study_years_early_life",
"use_moth_balls_study_years_early_life", "use_incense_or_candles_study_years_early_life", "smoke_exposure_study_years_early_life",  "use_aerosol_study_years_rest_of_life",
"use_air_cleaner_study_years_rest_of_life", "use_hepa_filter_study_years_rest_of_life", "use_moth_balls_study_years_rest_of_life",
"use_incense_or_candles_study_years_rest_of_life", "smoke_exposure_study_years_rest_of_life", "any_treated_weeds_study_years_rest_of_life",
"any_treated_insects_study_years_rest_of_life", "any_treated_fertilizer_study_years_rest_of_life","use_aerosol_study_years_whole_life",
"use_air_cleaner_study_years_whole_life", "use_hepa_filter_study_years_whole_life", "use_moth_balls_study_years_whole_life",
"use_incense_or_candles_study_years_whole_life", "smoke_exposure_study_years_whole_life", "any_treated_weeds_study_years_whole_life",
"any_treated_insects_study_years_whole_life", "any_treated_fertilizer_study_years_whole_life", "hours_of_smoke_early_life_total_dosage_terciles", "hours_of_smoke_rest_of_life_total_dosage_terciles",
"hours_of_smoke_whole_life_total_dosage_terciles", "in.the.garage_YN_study_years_early_life", "in.the.house_YN_study_years_early_life",
"outside_YN_study_years_early_life",
"in.the.garage_YN_study_years_rest_of_life", "in.the.house_YN_study_years_rest_of_life", "outside_YN_study_years_rest_of_life",
"in.the.house_YN_sum_rest_of_life_quartile",
"in.the.garage_YN_study_years_whole_life", "in.the.house_YN_study_years_whole_life", "outside_YN_study_years_whole_life",
"in.the.house_YN_sum_whole_life_quartile",
"majority_sleep_location_lifetime","sleep_location_mode_5yrs_prior",
"use_aerosol_exposed_5yrs_prior", "use_air_cleaner_exposed_5yrs_prior", "use_hepa_filter_exposed_5yrs_prior",
"use_moth_balls_exposed_5yrs_prior", "use_incense_or_candles_exposed_5yrs_prior", "smoke_exposure_exposed_5yrs_prior",
"any_treated_weeds_exposed_5yrs_prior", "any_treated_insects_exposed_5yrs_prior", "any_treated_fertilizer_exposed_5yrs_prior",
#comorbidities
"chronic_inflam_present_lifetime","number_comorbs_present_lifetime","chronic_inflam_present.x","chronic_inflam_present_5y","number_comorbs_present_5y","chronic_inflam_present_no_min_year","number_comorbs_present_no_min_year","intestinal_parasitism","tick_borne_parasitism","other_parasitism","all_parasitism","infectious","immune_mediated","cardiovascular","gastrointestinal","inflammatory_other","orthopaedic","chronic_inflammatory","lifelong_comorb_present.x","lifelong_orthopaedic","lifelong_immune_mediated","lifelong_cardiovascular","lifelong_gastrointestinal","lifelong_inflammatory_other","lifelong_chronic_inflammatory","number_lifelong_comorbs_present","malig_cancers_count","benign_cancers_count","all_cancers_count","all_cancers_YN","benign_cancers_YN","malig_cancers_YN","all_cancers_count_no_HSA","malig_cancers_count_no_HSA","malig_cancers_YN_no_HSA","all_cancers_YN_no_HSA","lymphoma_present","carcinoma_present","sarcoma_present","melanoma_present","adenocarcinoma_present","mast_cell_tumor_present",
#medications
"half_anti_microbials_lifetime", "half_dietary_supplements_lifetime",
"half_enteric_lifetime", "half_fluid_metabolites_lifetime", "half_hormones_and_related_lifetime", "half_immunologicals_lifetime",
"half_misc_lifetime", "half_neurological_lifetime", "half_anti_parasites_lifetime", "half_anti_septics_lifetime",
"half_cardio_respiratory_lifetime", "half_diuretics_lifetime", "half_anti_hist_lifetime",
"quartile_anti_inflam_lifetime", "quartile_anti_microbials_lifetime", "quartile_dietary_supplements_lifetime",
"quartile_hormones_and_related_lifetime",
"quartile_immunologicals_lifetime", "quartile_misc_lifetime", "quartile_neurological_lifetime",
"quartile_anti_parasites_lifetime",
"half_anti_inflam_5y_prior_endpoint", "half_anti_microbials_5y_prior_endpoint", "half_enteric_5y_prior_endpoint",
"half_immunologicals_5y_prior_endpoint", "half_misc_5y_prior_endpoint", "half_neurological_5y_prior_endpoint",
"half_anti_parasites_5y_prior_endpoint", "half_dietary_supplements_5y_prior_endpoint",
"half_anti_septics_5y_prior_endpoint", "half_hormones_and_related_5y_prior_endpoint",
"half_cardio_respiratory_5y_prior_endpoint", "half_fluid_metabolites_5y_prior_endpoint",
"half_diuretics_5y_prior_endpoint", "half_anti_hist_5y_prior_endpoint",
"quartile_anti_inflam_5y_prior_endpoint", "quartile_anti_microbials_5y_prior_endpoint",  "quartile_immunologicals_5y_prior_endpoint",
"quartile_misc_5y_prior_endpoint", "quartile_neurological_5y_prior_endpoint",
"quartile_anti_parasites_5y_prior_endpoint", "quartile_dietary_supplements_5y_prior_endpoint",
"quartile_hormones_and_related_5y_prior_endpoint", "NSAID_5y","NSAID_ever","steroid_5y","steroid_ever","fenbendazole_5y","fenbendazole_ever"
)
# Create a univariable logistic regression table
univar_table <- cohort_abr %>%summary_factorlist(dependent, explanatory,
p=TRUE,  add_dependent_label=TRUE,column = TRUE)
#column = TRUE does case and contorl counts for each variable category rather than rowise
univar_table2 <- cohort_abr %>%summary_factorlist(dependent, explanatory,
p=TRUE,  add_dependent_label=TRUE,na_include = TRUE,column=TRUE)
# View the results
print(univar_table)
write.csv(univar_table,"C:/Users/ctaylor18/GitHub/GRLS_analyses/Output/HSA_cross_table_case_control_output.csv")
#save as worddoc
# Install and load the required packages
library(officer)
library(flextable)
# Create a Word document
doc <- read_docx()
# Convert finalfit output to a flextable
results_flextable <- flextable(univar_table)
# Add the flextable to the Word document
doc <- doc %>%
body_add_flextable(results_flextable) %>%
body_add_par("Finalfit Regression Results", style = "heading 1")
# Save the Word document
print(doc, target = "C:/Users/ctaylor18/GitHub/GRLS_analyses/Output/HSA_cross_table_case_control_output.docx")
source("C:/Users/ctaylor18/GitHub/HSA-VC-enviro-analyses/functions/univar_log_reg_auto.R")
cohort_abr$had_HSA <- as.factor(cohort_abr$had_HSA)
#leaving out the continuous variables as missing data causing issues
#"max_tumour_cm_value" "age_at_diagnosis_cont"
cohort_abr2 <- cohort_abr %>%
dplyr::select(  #demog
"age_at_final_date_GB","age_at_final_date_bio", "age_at_final_date_quartiles","age_at_neuter_years_quartiles","sex_neuter",
"sex", "neuter", "mismating_ever",
"neutered_reason", "neutered_ever_bred", "spayed_while_in_heat", "spayed_while_pregnant", "prevent_heat_ever",
"no_pregnancy_ever", "intact_sired_litters_natural_ever", "neutered_females_bred_with_count_ever",
"neutered_sired_litters_natural_ever", "heats_before_neutering", "heats_before_neutering_terciles",
"preg_pre_neuter",
"num_breeding_before_neutering_terciles", "ever_bred_from",
"avg_weight_5y_prior_endpoint_quartiles","avg_weight_5y_prior_endpoint_kg_biological", "avg_height_5y_prior_endpoint_quartiles",
"avg_purina_BCS_5y_prior_endpoint_quartiles", "mode_purina_BCS_5y_prior_endpoint", "mode_BCS_classify",
#lifestyle/activity
"main_lifestyle_category",
"main_lifestyle_category_mode_5yrs_prior", "USDA_30min_sy1_2", "activity_1h_min_sy1_2",
"activity_KC_2h_min_sy1_2", "avg_activity_duration_sy1_2_quartile",
"avg_activity_intensity_sy3_quartile", "avg_intensity_5y_prior_endpoint_quartile", "avg_frequency_5y_prior_endpoint_quartile", "avg_activity_duration_sy1_2_splits",
"avg_activity_freq_sy1_2_splits",
"avg_activity_freq_sy3_splits", "avg_activity_intensity_sy3_splits",  "avg_frequency_5y_prior_endpoint_splits",
#home/environmental
"MDI_quintile","owner_MDI_quintile","area_type_mode_5yrs_prior","house_type_mode_5yrs_prior",
"water_source_mode_5yrs_prior", "pipes_metal_any_mode_5yrs_prior", "pipes_plastic_any_mode_5yrs_prior",
"heating_fuel_primary_mode_5yrs_prior", "cooking_fuel_primary_mode_5yrs_prior", "heating_fuel_secondary_mode_5yrs_prior",
"cooking_fuel_secondary_mode_5yrs_prior", "region_mode_5y_prior","use_aerosol_study_years_early_life", "use_air_cleaner_study_years_early_life", "use_hepa_filter_study_years_early_life",
"use_moth_balls_study_years_early_life", "use_incense_or_candles_study_years_early_life", "smoke_exposure_study_years_early_life",  "use_aerosol_study_years_rest_of_life",
"use_air_cleaner_study_years_rest_of_life", "use_hepa_filter_study_years_rest_of_life", "use_moth_balls_study_years_rest_of_life",
"use_incense_or_candles_study_years_rest_of_life", "smoke_exposure_study_years_rest_of_life", "any_treated_weeds_study_years_rest_of_life",
"any_treated_insects_study_years_rest_of_life", "any_treated_fertilizer_study_years_rest_of_life","use_aerosol_study_years_whole_life",
"use_air_cleaner_study_years_whole_life", "use_hepa_filter_study_years_whole_life", "use_moth_balls_study_years_whole_life",
"use_incense_or_candles_study_years_whole_life", "smoke_exposure_study_years_whole_life", "any_treated_weeds_study_years_whole_life",
"any_treated_insects_study_years_whole_life", "any_treated_fertilizer_study_years_whole_life", "hours_of_smoke_early_life_total_dosage_terciles", "hours_of_smoke_rest_of_life_total_dosage_terciles",
"hours_of_smoke_whole_life_total_dosage_terciles", "in.the.garage_YN_study_years_early_life", "in.the.house_YN_study_years_early_life",
"outside_YN_study_years_early_life",
"in.the.garage_YN_study_years_rest_of_life", "in.the.house_YN_study_years_rest_of_life", "outside_YN_study_years_rest_of_life",
"in.the.house_YN_sum_rest_of_life_quartile",
"in.the.garage_YN_study_years_whole_life", "in.the.house_YN_study_years_whole_life", "outside_YN_study_years_whole_life",
"in.the.house_YN_sum_whole_life_quartile",
"majority_sleep_location_lifetime","sleep_location_mode_5yrs_prior",
"use_aerosol_exposed_5yrs_prior", "use_air_cleaner_exposed_5yrs_prior", "use_hepa_filter_exposed_5yrs_prior",
"use_moth_balls_exposed_5yrs_prior", "use_incense_or_candles_exposed_5yrs_prior", "smoke_exposure_exposed_5yrs_prior",
"any_treated_weeds_exposed_5yrs_prior", "any_treated_insects_exposed_5yrs_prior", "any_treated_fertilizer_exposed_5yrs_prior",
#comorbidities
"chronic_inflam_present_lifetime","number_comorbs_present_lifetime","chronic_inflam_present.x","chronic_inflam_present_5y","number_comorbs_present_5y","chronic_inflam_present_no_min_year","number_comorbs_present_no_min_year","intestinal_parasitism","tick_borne_parasitism","other_parasitism","all_parasitism","infectious","immune_mediated","cardiovascular","gastrointestinal","inflammatory_other","orthopaedic","chronic_inflammatory","lifelong_comorb_present.x","lifelong_orthopaedic","lifelong_immune_mediated","lifelong_cardiovascular","lifelong_gastrointestinal","lifelong_inflammatory_other","lifelong_chronic_inflammatory","number_lifelong_comorbs_present","malig_cancers_count","benign_cancers_count","all_cancers_count","all_cancers_YN","benign_cancers_YN","malig_cancers_YN","all_cancers_count_no_HSA","malig_cancers_count_no_HSA","malig_cancers_YN_no_HSA","all_cancers_YN_no_HSA","lymphoma_present","carcinoma_present","sarcoma_present","melanoma_present","adenocarcinoma_present","mast_cell_tumor_present",
#medications
"half_anti_microbials_lifetime", "half_dietary_supplements_lifetime",
"half_enteric_lifetime", "half_fluid_metabolites_lifetime", "half_hormones_and_related_lifetime", "half_immunologicals_lifetime",
"half_misc_lifetime", "half_neurological_lifetime", "half_anti_parasites_lifetime", "half_anti_septics_lifetime",
"half_cardio_respiratory_lifetime", "half_diuretics_lifetime", "half_anti_hist_lifetime",
"quartile_anti_inflam_lifetime", "quartile_anti_microbials_lifetime", "quartile_dietary_supplements_lifetime",
"quartile_hormones_and_related_lifetime",
"quartile_immunologicals_lifetime", "quartile_misc_lifetime", "quartile_neurological_lifetime",
"quartile_anti_parasites_lifetime",
"half_anti_inflam_5y_prior_endpoint", "half_anti_microbials_5y_prior_endpoint", "half_enteric_5y_prior_endpoint",
"half_immunologicals_5y_prior_endpoint", "half_misc_5y_prior_endpoint", "half_neurological_5y_prior_endpoint",
"half_anti_parasites_5y_prior_endpoint", "half_dietary_supplements_5y_prior_endpoint",
"half_anti_septics_5y_prior_endpoint", "half_hormones_and_related_5y_prior_endpoint",
"half_cardio_respiratory_5y_prior_endpoint", "half_fluid_metabolites_5y_prior_endpoint",
"half_diuretics_5y_prior_endpoint", "half_anti_hist_5y_prior_endpoint",
"quartile_anti_inflam_5y_prior_endpoint", "quartile_anti_microbials_5y_prior_endpoint",  "quartile_immunologicals_5y_prior_endpoint",
"quartile_misc_5y_prior_endpoint", "quartile_neurological_5y_prior_endpoint",
"quartile_anti_parasites_5y_prior_endpoint", "quartile_dietary_supplements_5y_prior_endpoint",
"quartile_hormones_and_related_5y_prior_endpoint", "NSAID_5y","NSAID_ever","steroid_5y","steroid_ever","fenbendazole_5y","fenbendazole_ever","had_HSA")
cohort_abr2<- cohort_abr2%>%
mutate_all(~factor(ifelse(is.na(.), "not_recorded", as.character(.))))
cohort_abr2 <- cohort_abr2%>%
mutate(heats_before_neutering_terciles = factor(heats_before_neutering_terciles, levels = c("0", "1-<=2", ">2-<=4", ">4-12","Intact Female","Male","not_recorded")))
#neuter reason levels
cohort_abr2<- cohort_abr2%>%
mutate(neutered_reason = factor(neutered_reason, levels = c("Elective",  "Medical Reason", "Entire","Unknown","not_recorded")))
cohort_abr2 <- cohort_abr2%>%
mutate(mode_purina_BCS_5y_prior_endpoint = factor(mode_purina_BCS_5y_prior_endpoint, levels = c("5", "3", "4", "6","7","8","9","not_recorded")))
#change BCS to be over underweight
cohort_abr2 <- cohort_abr2 %>%
mutate(mode_BCS_classify = case_when(
mode_purina_BCS_5y_prior_endpoint == "1" ~"underweight",
mode_purina_BCS_5y_prior_endpoint == "2" ~"underweight",
mode_purina_BCS_5y_prior_endpoint == "3" ~"underweight",
mode_purina_BCS_5y_prior_endpoint == "4" ~"ideal",
mode_purina_BCS_5y_prior_endpoint == "5" ~"ideal",
mode_purina_BCS_5y_prior_endpoint == "6" ~"overweight",
mode_purina_BCS_5y_prior_endpoint == "7" ~"overweight",
mode_purina_BCS_5y_prior_endpoint == "8" ~"overweight",
mode_purina_BCS_5y_prior_endpoint == "9" ~"overweight",
mode_purina_BCS_5y_prior_endpoint == "not_recorded" ~"not_recorded",
))
#set age levels
cohort_abr2 <- cohort_abr2%>%
mutate(age_at_final_date_quartiles = factor(age_at_final_date_quartiles, levels = c("0.74-<8.47 years", ">=8.47-<10.68 years", ">=10.68-<11.64 years", ">=11.64-14.51 years")))
cohort_abr2 <- cohort_abr2%>%
mutate(age_at_final_date_bio = factor(age_at_final_date_bio, levels = c(">5-<8y","<5y",  ">8-<11y", ">11-<13y",">13y")))
cohort_abr2 <- cohort_abr2%>%
mutate(age_at_final_date_GB = factor(age_at_final_date_GB, levels = c(">7-<9y","<5y", ">5-<7y",  ">9-<11y",">11-<13y",">13y")))
#manually assign height, weight, BCS factor levles and age at neuter and age at diagnosis
#height
cohort_abr2 <- cohort_abr2%>%
mutate(avg_weight_5y_prior_endpoint_quartiles = factor(avg_weight_5y_prior_endpoint_quartiles, levels = c("12.47-<20.83kg", ">=20.83-<23.23kg", ">=23.23-26.98kg", ">=26.98-37.01","not_recorded")))
cohort_abr2 <- cohort_abr2%>%
mutate(avg_weight_5y_prior_endpoint_kg_biological = factor(avg_weight_5y_prior_endpoint_kg_biological, levels = c(">15-<=25kg","<15kg",">25-<=35kg",">35","not_recorded")))
#bcs
cohort_abr2 <- cohort_abr2%>%
mutate(avg_purina_BCS_5y_prior_endpoint_quartiles = factor(avg_purina_BCS_5y_prior_endpoint_quartiles, levels = c("3.3-<5", ">=5-<5.28", ">=5.28-<5.86", ">=5.86 - 9","not_recorded")))
#neut age
cohort_abr2<- cohort_abr2 %>%
mutate(age_at_neuter_years_quartiles = factor(age_at_neuter_years_quartiles, levels = c("0.15-<0.52y", ">=0.52-<0.83y", ">=0.83-2.44y", ">=2.44-9.59y","Entire","not_recorded")))
#diagnosis age
cohort_abr2 <- cohort_abr2%>%
mutate(age_at_final_date_quartiles = factor(age_at_final_date_quartiles, levels = c("0.74-<8.47 years", ">=8.47-<10.68 years", ">=10.68-<11.64 years", ">=11.64-14.51 years","not_recorded")))
#breed tercile levels
cohort_abr2 <- cohort_abr2%>%
mutate(num_breeding_before_neutering_terciles = factor(num_breeding_before_neutering_terciles, levels = c(">0-<3",">=3-<9",">=9-142","not_bred","not_recorded")))
cols_to_modify <- 145:193 # replace with your actual column indices
for (i in cols_to_modify) {
current_levels <- levels(cohort_abr2[[i]])
if ("no_medication_records_for_this_time_period" %in% current_levels) {
new_levels <- c(setdiff(current_levels, "no_medication_records_for_this_time_period"), "no_medication_records_for_this_time_period")
cohort_abr2[[i]] <- factor(cohort_abr2[[i]], levels = new_levels)
}
}
#need to set the activity splits into ordinal format
cohort_abr2 <- cohort_abr2%>%
mutate(avg_activity_freq_sy3_splits = factor(avg_activity_freq_sy3_splits, levels = c("rarely","monthly","weekly","daily","multi_daily","not_recorded")))
cohort_abr2 <- cohort_abr2%>%
mutate(avg_activity_freq_sy1_2_splits = factor(avg_activity_freq_sy1_2_splits, levels = c("never","less_than_weekly","min_weekly","daily","multi_daily","not_recorded")))
cohort_abr2 <- cohort_abr2%>%
mutate(avg_activity_duration_sy1_2_splits = factor(avg_activity_duration_sy1_2_splits, levels = c("less_than_30min","between_30_60_min","between_60_90_min","between_90_120_min","more_than_120_min","not_recorded")))
cohort_abr2 <- cohort_abr2%>%
mutate(avg_activity_intensity_sy3_splits = factor(avg_activity_intensity_sy3_splits, levels = c("slow_walks","average_walks","brisk_walks","jogs","runs","not_recorded")))
cohort_abr2 <- cohort_abr2%>%
mutate(avg_frequency_5y_prior_endpoint_splits = factor(avg_frequency_5y_prior_endpoint_splits, levels = c("rarely","monthly","weekly","daily","multi_daily","not_recorded")))
# Now run the function
univar_results <- univar_logistic_regression(cohort_abr2, "had_HSA", explanatory)
source("C:/Users/ctaylor18/GitHub/HSA-VC-enviro-analyses/functions/univar_log_reg_auto.R")
cohort_abr$had_HSA <- as.factor(cohort_abr$had_HSA)
#leaving out the continuous variables as missing data causing issues
#"max_tumour_cm_value" "age_at_diagnosis_cont"
cohort_abr2 <- cohort_abr %>%
dplyr::select(  #demog
"age_at_final_date_GB","age_at_final_date_bio", "age_at_final_date_quartiles","age_at_neuter_years_quartiles","sex_neuter",
"sex", "neuter", "mismating_ever",
"neutered_reason", "neutered_ever_bred", "spayed_while_in_heat", "spayed_while_pregnant", "prevent_heat_ever",
"no_pregnancy_ever", "intact_sired_litters_natural_ever", "neutered_females_bred_with_count_ever",
"neutered_sired_litters_natural_ever", "heats_before_neutering", "heats_before_neutering_terciles",
"preg_pre_neuter",
"num_breeding_before_neutering_terciles", "ever_bred_from",
"avg_weight_5y_prior_endpoint_quartiles", "avg_height_5y_prior_endpoint_quartiles",
"avg_purina_BCS_5y_prior_endpoint_quartiles", "mode_purina_BCS_5y_prior_endpoint", "mode_BCS_classify",
#lifestyle/activity
"main_lifestyle_category",
"main_lifestyle_category_mode_5yrs_prior", "USDA_30min_sy1_2", "activity_1h_min_sy1_2",
"activity_KC_2h_min_sy1_2", "avg_activity_duration_sy1_2_quartile",
"avg_activity_intensity_sy3_quartile", "avg_intensity_5y_prior_endpoint_quartile", "avg_frequency_5y_prior_endpoint_quartile", "avg_activity_duration_sy1_2_splits",
"avg_activity_freq_sy1_2_splits",
"avg_activity_freq_sy3_splits", "avg_activity_intensity_sy3_splits",  "avg_frequency_5y_prior_endpoint_splits",
#home/environmental
"MDI_quintile","owner_MDI_quintile","area_type_mode_5yrs_prior","house_type_mode_5yrs_prior",
"water_source_mode_5yrs_prior", "pipes_metal_any_mode_5yrs_prior", "pipes_plastic_any_mode_5yrs_prior",
"heating_fuel_primary_mode_5yrs_prior", "cooking_fuel_primary_mode_5yrs_prior", "heating_fuel_secondary_mode_5yrs_prior",
"cooking_fuel_secondary_mode_5yrs_prior", "region_mode_5y_prior","use_aerosol_study_years_early_life", "use_air_cleaner_study_years_early_life", "use_hepa_filter_study_years_early_life",
"use_moth_balls_study_years_early_life", "use_incense_or_candles_study_years_early_life", "smoke_exposure_study_years_early_life",  "use_aerosol_study_years_rest_of_life",
"use_air_cleaner_study_years_rest_of_life", "use_hepa_filter_study_years_rest_of_life", "use_moth_balls_study_years_rest_of_life",
"use_incense_or_candles_study_years_rest_of_life", "smoke_exposure_study_years_rest_of_life", "any_treated_weeds_study_years_rest_of_life",
"any_treated_insects_study_years_rest_of_life", "any_treated_fertilizer_study_years_rest_of_life","use_aerosol_study_years_whole_life",
"use_air_cleaner_study_years_whole_life", "use_hepa_filter_study_years_whole_life", "use_moth_balls_study_years_whole_life",
"use_incense_or_candles_study_years_whole_life", "smoke_exposure_study_years_whole_life", "any_treated_weeds_study_years_whole_life",
"any_treated_insects_study_years_whole_life", "any_treated_fertilizer_study_years_whole_life", "hours_of_smoke_early_life_total_dosage_terciles", "hours_of_smoke_rest_of_life_total_dosage_terciles",
"hours_of_smoke_whole_life_total_dosage_terciles", "in.the.garage_YN_study_years_early_life", "in.the.house_YN_study_years_early_life",
"outside_YN_study_years_early_life",
"in.the.garage_YN_study_years_rest_of_life", "in.the.house_YN_study_years_rest_of_life", "outside_YN_study_years_rest_of_life",
"in.the.house_YN_sum_rest_of_life_quartile",
"in.the.garage_YN_study_years_whole_life", "in.the.house_YN_study_years_whole_life", "outside_YN_study_years_whole_life",
"in.the.house_YN_sum_whole_life_quartile",
"majority_sleep_location_lifetime","sleep_location_mode_5yrs_prior",
"use_aerosol_exposed_5yrs_prior", "use_air_cleaner_exposed_5yrs_prior", "use_hepa_filter_exposed_5yrs_prior",
"use_moth_balls_exposed_5yrs_prior", "use_incense_or_candles_exposed_5yrs_prior", "smoke_exposure_exposed_5yrs_prior",
"any_treated_weeds_exposed_5yrs_prior", "any_treated_insects_exposed_5yrs_prior", "any_treated_fertilizer_exposed_5yrs_prior",
#comorbidities
"chronic_inflam_present_lifetime","number_comorbs_present_lifetime","chronic_inflam_present.x","chronic_inflam_present_5y","number_comorbs_present_5y","chronic_inflam_present_no_min_year","number_comorbs_present_no_min_year","intestinal_parasitism","tick_borne_parasitism","other_parasitism","all_parasitism","infectious","immune_mediated","cardiovascular","gastrointestinal","inflammatory_other","orthopaedic","chronic_inflammatory","lifelong_comorb_present.x","lifelong_orthopaedic","lifelong_immune_mediated","lifelong_cardiovascular","lifelong_gastrointestinal","lifelong_inflammatory_other","lifelong_chronic_inflammatory","number_lifelong_comorbs_present","malig_cancers_count","benign_cancers_count","all_cancers_count","all_cancers_YN","benign_cancers_YN","malig_cancers_YN","all_cancers_count_no_HSA","malig_cancers_count_no_HSA","malig_cancers_YN_no_HSA","all_cancers_YN_no_HSA","lymphoma_present","carcinoma_present","sarcoma_present","melanoma_present","adenocarcinoma_present","mast_cell_tumor_present",
#medications
"half_anti_microbials_lifetime", "half_dietary_supplements_lifetime",
"half_enteric_lifetime", "half_fluid_metabolites_lifetime", "half_hormones_and_related_lifetime", "half_immunologicals_lifetime",
"half_misc_lifetime", "half_neurological_lifetime", "half_anti_parasites_lifetime", "half_anti_septics_lifetime",
"half_cardio_respiratory_lifetime", "half_diuretics_lifetime", "half_anti_hist_lifetime",
"quartile_anti_inflam_lifetime", "quartile_anti_microbials_lifetime", "quartile_dietary_supplements_lifetime",
"quartile_hormones_and_related_lifetime",
"quartile_immunologicals_lifetime", "quartile_misc_lifetime", "quartile_neurological_lifetime",
"quartile_anti_parasites_lifetime",
"half_anti_inflam_5y_prior_endpoint", "half_anti_microbials_5y_prior_endpoint", "half_enteric_5y_prior_endpoint",
"half_immunologicals_5y_prior_endpoint", "half_misc_5y_prior_endpoint", "half_neurological_5y_prior_endpoint",
"half_anti_parasites_5y_prior_endpoint", "half_dietary_supplements_5y_prior_endpoint",
"half_anti_septics_5y_prior_endpoint", "half_hormones_and_related_5y_prior_endpoint",
"half_cardio_respiratory_5y_prior_endpoint", "half_fluid_metabolites_5y_prior_endpoint",
"half_diuretics_5y_prior_endpoint", "half_anti_hist_5y_prior_endpoint",
"quartile_anti_inflam_5y_prior_endpoint", "quartile_anti_microbials_5y_prior_endpoint",  "quartile_immunologicals_5y_prior_endpoint",
"quartile_misc_5y_prior_endpoint", "quartile_neurological_5y_prior_endpoint",
"quartile_anti_parasites_5y_prior_endpoint", "quartile_dietary_supplements_5y_prior_endpoint",
"quartile_hormones_and_related_5y_prior_endpoint", "NSAID_5y","NSAID_ever","steroid_5y","steroid_ever","fenbendazole_5y","fenbendazole_ever","had_HSA")
cohort_abr2<- cohort_abr2%>%
mutate_all(~factor(ifelse(is.na(.), "not_recorded", as.character(.))))
cohort_abr2 <- cohort_abr2%>%
mutate(heats_before_neutering_terciles = factor(heats_before_neutering_terciles, levels = c("0", "1-<=2", ">2-<=4", ">4-12","Intact Female","Male","not_recorded")))
#neuter reason levels
cohort_abr2<- cohort_abr2%>%
mutate(neutered_reason = factor(neutered_reason, levels = c("Elective",  "Medical Reason", "Entire","Unknown","not_recorded")))
cohort_abr2 <- cohort_abr2%>%
mutate(mode_purina_BCS_5y_prior_endpoint = factor(mode_purina_BCS_5y_prior_endpoint, levels = c("5", "3", "4", "6","7","8","9","not_recorded")))
#change BCS to be over underweight
cohort_abr2 <- cohort_abr2 %>%
mutate(mode_BCS_classify = case_when(
mode_purina_BCS_5y_prior_endpoint == "1" ~"underweight",
mode_purina_BCS_5y_prior_endpoint == "2" ~"underweight",
mode_purina_BCS_5y_prior_endpoint == "3" ~"underweight",
mode_purina_BCS_5y_prior_endpoint == "4" ~"ideal",
mode_purina_BCS_5y_prior_endpoint == "5" ~"ideal",
mode_purina_BCS_5y_prior_endpoint == "6" ~"overweight",
mode_purina_BCS_5y_prior_endpoint == "7" ~"overweight",
mode_purina_BCS_5y_prior_endpoint == "8" ~"overweight",
mode_purina_BCS_5y_prior_endpoint == "9" ~"overweight",
mode_purina_BCS_5y_prior_endpoint == "not_recorded" ~"not_recorded",
))
#set age levels
cohort_abr2 <- cohort_abr2%>%
mutate(age_at_final_date_quartiles = factor(age_at_final_date_quartiles, levels = c("0.74-<8.47 years", ">=8.47-<10.68 years", ">=10.68-<11.64 years", ">=11.64-14.51 years")))
cohort_abr2 <- cohort_abr2%>%
mutate(age_at_final_date_bio = factor(age_at_final_date_bio, levels = c(">5-<8y","<5y",  ">8-<11y", ">11-<13y",">13y")))
cohort_abr2 <- cohort_abr2%>%
mutate(age_at_final_date_GB = factor(age_at_final_date_GB, levels = c(">7-<9y","<5y", ">5-<7y",  ">9-<11y",">11-<13y",">13y")))
#manually assign height, weight, BCS factor levles and age at neuter and age at diagnosis
#height
cohort_abr2 <- cohort_abr2%>%
mutate(avg_weight_5y_prior_endpoint_quartiles = factor(avg_weight_5y_prior_endpoint_quartiles, levels = c("12.47-<20.83kg", ">=20.83-<23.23kg", ">=23.23-26.98kg", ">=26.98-37.01","not_recorded")))
cohort_abr2 <- cohort_abr2%>%
mutate(avg_weight_5y_prior_endpoint_kg_biological = factor(avg_weight_5y_prior_endpoint_kg_biological, levels = c(">15-<=25kg","<15kg",">25-<=35kg",">35","not_recorded")))
#bcs
cohort_abr2 <- cohort_abr2%>%
mutate(avg_purina_BCS_5y_prior_endpoint_quartiles = factor(avg_purina_BCS_5y_prior_endpoint_quartiles, levels = c("3.3-<5", ">=5-<5.28", ">=5.28-<5.86", ">=5.86 - 9","not_recorded")))
#neut age
cohort_abr2<- cohort_abr2 %>%
mutate(age_at_neuter_years_quartiles = factor(age_at_neuter_years_quartiles, levels = c("0.15-<0.52y", ">=0.52-<0.83y", ">=0.83-2.44y", ">=2.44-9.59y","Entire","not_recorded")))
#diagnosis age
cohort_abr2 <- cohort_abr2%>%
mutate(age_at_final_date_quartiles = factor(age_at_final_date_quartiles, levels = c("0.74-<8.47 years", ">=8.47-<10.68 years", ">=10.68-<11.64 years", ">=11.64-14.51 years","not_recorded")))
#breed tercile levels
cohort_abr2 <- cohort_abr2%>%
mutate(num_breeding_before_neutering_terciles = factor(num_breeding_before_neutering_terciles, levels = c(">0-<3",">=3-<9",">=9-142","not_bred","not_recorded")))
cols_to_modify <- 145:193 # replace with your actual column indices
for (i in cols_to_modify) {
current_levels <- levels(cohort_abr2[[i]])
if ("no_medication_records_for_this_time_period" %in% current_levels) {
new_levels <- c(setdiff(current_levels, "no_medication_records_for_this_time_period"), "no_medication_records_for_this_time_period")
cohort_abr2[[i]] <- factor(cohort_abr2[[i]], levels = new_levels)
}
}
#need to set the activity splits into ordinal format
cohort_abr2 <- cohort_abr2%>%
mutate(avg_activity_freq_sy3_splits = factor(avg_activity_freq_sy3_splits, levels = c("rarely","monthly","weekly","daily","multi_daily","not_recorded")))
cohort_abr2 <- cohort_abr2%>%
mutate(avg_activity_freq_sy1_2_splits = factor(avg_activity_freq_sy1_2_splits, levels = c("never","less_than_weekly","min_weekly","daily","multi_daily","not_recorded")))
cohort_abr2 <- cohort_abr2%>%
mutate(avg_activity_duration_sy1_2_splits = factor(avg_activity_duration_sy1_2_splits, levels = c("less_than_30min","between_30_60_min","between_60_90_min","between_90_120_min","more_than_120_min","not_recorded")))
cohort_abr2 <- cohort_abr2%>%
mutate(avg_activity_intensity_sy3_splits = factor(avg_activity_intensity_sy3_splits, levels = c("slow_walks","average_walks","brisk_walks","jogs","runs","not_recorded")))
cohort_abr2 <- cohort_abr2%>%
mutate(avg_frequency_5y_prior_endpoint_splits = factor(avg_frequency_5y_prior_endpoint_splits, levels = c("rarely","monthly","weekly","daily","multi_daily","not_recorded")))
# Now run the function
univar_results <- univar_logistic_regression(cohort_abr2, "had_HSA", explanatory)
source("C:/Users/ctaylor18/GitHub/HSA-VC-enviro-analyses/functions/univar_log_reg_auto.R")
cohort_abr$had_HSA <- as.factor(cohort_abr$had_HSA)
#leaving out the continuous variables as missing data causing issues
#"max_tumour_cm_value" "age_at_diagnosis_cont"
cohort_abr2 <- cohort_abr %>%
dplyr::select(  #demog
"age_at_final_date_GB","age_at_final_date_bio", "age_at_final_date_quartiles","age_at_neuter_years_quartiles","sex_neuter",
"sex", "neuter", "mismating_ever",
"neutered_reason", "neutered_ever_bred", "spayed_while_in_heat", "spayed_while_pregnant", "prevent_heat_ever",
"no_pregnancy_ever", "intact_sired_litters_natural_ever", "neutered_females_bred_with_count_ever",
"neutered_sired_litters_natural_ever", "heats_before_neutering", "heats_before_neutering_terciles",
"preg_pre_neuter",
"num_breeding_before_neutering_terciles", "ever_bred_from",
"avg_weight_5y_prior_endpoint_quartiles", "avg_height_5y_prior_endpoint_quartiles",
"avg_purina_BCS_5y_prior_endpoint_quartiles", "mode_purina_BCS_5y_prior_endpoint", "mode_BCS_classify",
#lifestyle/activity
"main_lifestyle_category",
"main_lifestyle_category_mode_5yrs_prior", "USDA_30min_sy1_2", "activity_1h_min_sy1_2",
"activity_KC_2h_min_sy1_2", "avg_activity_duration_sy1_2_quartile",
"avg_activity_intensity_sy3_quartile", "avg_intensity_5y_prior_endpoint_quartile", "avg_frequency_5y_prior_endpoint_quartile", "avg_activity_duration_sy1_2_splits",
"avg_activity_freq_sy1_2_splits",
"avg_activity_freq_sy3_splits", "avg_activity_intensity_sy3_splits",  "avg_frequency_5y_prior_endpoint_splits",
#home/environmental
"MDI_quintile","owner_MDI_quintile","area_type_mode_5yrs_prior","house_type_mode_5yrs_prior",
"water_source_mode_5yrs_prior", "pipes_metal_any_mode_5yrs_prior", "pipes_plastic_any_mode_5yrs_prior",
"heating_fuel_primary_mode_5yrs_prior", "cooking_fuel_primary_mode_5yrs_prior", "heating_fuel_secondary_mode_5yrs_prior",
"cooking_fuel_secondary_mode_5yrs_prior", "region_mode_5y_prior","use_aerosol_study_years_early_life", "use_air_cleaner_study_years_early_life", "use_hepa_filter_study_years_early_life",
"use_moth_balls_study_years_early_life", "use_incense_or_candles_study_years_early_life", "smoke_exposure_study_years_early_life",  "use_aerosol_study_years_rest_of_life",
"use_air_cleaner_study_years_rest_of_life", "use_hepa_filter_study_years_rest_of_life", "use_moth_balls_study_years_rest_of_life",
"use_incense_or_candles_study_years_rest_of_life", "smoke_exposure_study_years_rest_of_life", "any_treated_weeds_study_years_rest_of_life",
"any_treated_insects_study_years_rest_of_life", "any_treated_fertilizer_study_years_rest_of_life","use_aerosol_study_years_whole_life",
"use_air_cleaner_study_years_whole_life", "use_hepa_filter_study_years_whole_life", "use_moth_balls_study_years_whole_life",
"use_incense_or_candles_study_years_whole_life", "smoke_exposure_study_years_whole_life", "any_treated_weeds_study_years_whole_life",
"any_treated_insects_study_years_whole_life", "any_treated_fertilizer_study_years_whole_life", "hours_of_smoke_early_life_total_dosage_terciles", "hours_of_smoke_rest_of_life_total_dosage_terciles",
"hours_of_smoke_whole_life_total_dosage_terciles", "in.the.garage_YN_study_years_early_life", "in.the.house_YN_study_years_early_life",
"outside_YN_study_years_early_life",
"in.the.garage_YN_study_years_rest_of_life", "in.the.house_YN_study_years_rest_of_life", "outside_YN_study_years_rest_of_life",
"in.the.house_YN_sum_rest_of_life_quartile",
"in.the.garage_YN_study_years_whole_life", "in.the.house_YN_study_years_whole_life", "outside_YN_study_years_whole_life",
"in.the.house_YN_sum_whole_life_quartile",
"majority_sleep_location_lifetime","sleep_location_mode_5yrs_prior",
"use_aerosol_exposed_5yrs_prior", "use_air_cleaner_exposed_5yrs_prior", "use_hepa_filter_exposed_5yrs_prior",
"use_moth_balls_exposed_5yrs_prior", "use_incense_or_candles_exposed_5yrs_prior", "smoke_exposure_exposed_5yrs_prior",
"any_treated_weeds_exposed_5yrs_prior", "any_treated_insects_exposed_5yrs_prior", "any_treated_fertilizer_exposed_5yrs_prior",
#comorbidities
"chronic_inflam_present_lifetime","number_comorbs_present_lifetime","chronic_inflam_present.x","chronic_inflam_present_5y","number_comorbs_present_5y","chronic_inflam_present_no_min_year","number_comorbs_present_no_min_year","intestinal_parasitism","tick_borne_parasitism","other_parasitism","all_parasitism","infectious","immune_mediated","cardiovascular","gastrointestinal","inflammatory_other","orthopaedic","chronic_inflammatory","lifelong_comorb_present.x","lifelong_orthopaedic","lifelong_immune_mediated","lifelong_cardiovascular","lifelong_gastrointestinal","lifelong_inflammatory_other","lifelong_chronic_inflammatory","number_lifelong_comorbs_present","malig_cancers_count","benign_cancers_count","all_cancers_count","all_cancers_YN","benign_cancers_YN","malig_cancers_YN","all_cancers_count_no_HSA","malig_cancers_count_no_HSA","malig_cancers_YN_no_HSA","all_cancers_YN_no_HSA","lymphoma_present","carcinoma_present","sarcoma_present","melanoma_present","adenocarcinoma_present","mast_cell_tumor_present",
#medications
"half_anti_microbials_lifetime", "half_dietary_supplements_lifetime",
"half_enteric_lifetime", "half_fluid_metabolites_lifetime", "half_hormones_and_related_lifetime", "half_immunologicals_lifetime",
"half_misc_lifetime", "half_neurological_lifetime", "half_anti_parasites_lifetime", "half_anti_septics_lifetime",
"half_cardio_respiratory_lifetime", "half_diuretics_lifetime", "half_anti_hist_lifetime",
"quartile_anti_inflam_lifetime", "quartile_anti_microbials_lifetime", "quartile_dietary_supplements_lifetime",
"quartile_hormones_and_related_lifetime",
"quartile_immunologicals_lifetime", "quartile_misc_lifetime", "quartile_neurological_lifetime",
"quartile_anti_parasites_lifetime",
"half_anti_inflam_5y_prior_endpoint", "half_anti_microbials_5y_prior_endpoint", "half_enteric_5y_prior_endpoint",
"half_immunologicals_5y_prior_endpoint", "half_misc_5y_prior_endpoint", "half_neurological_5y_prior_endpoint",
"half_anti_parasites_5y_prior_endpoint", "half_dietary_supplements_5y_prior_endpoint",
"half_anti_septics_5y_prior_endpoint", "half_hormones_and_related_5y_prior_endpoint",
"half_cardio_respiratory_5y_prior_endpoint", "half_fluid_metabolites_5y_prior_endpoint",
"half_diuretics_5y_prior_endpoint", "half_anti_hist_5y_prior_endpoint",
"quartile_anti_inflam_5y_prior_endpoint", "quartile_anti_microbials_5y_prior_endpoint",  "quartile_immunologicals_5y_prior_endpoint",
"quartile_misc_5y_prior_endpoint", "quartile_neurological_5y_prior_endpoint",
"quartile_anti_parasites_5y_prior_endpoint", "quartile_dietary_supplements_5y_prior_endpoint",
"quartile_hormones_and_related_5y_prior_endpoint", "NSAID_5y","NSAID_ever","steroid_5y","steroid_ever","fenbendazole_5y","fenbendazole_ever","had_HSA")
cohort_abr2<- cohort_abr2%>%
mutate_all(~factor(ifelse(is.na(.), "not_recorded", as.character(.))))
cohort_abr2 <- cohort_abr2%>%
mutate(heats_before_neutering_terciles = factor(heats_before_neutering_terciles, levels = c("0", "1-<=2", ">2-<=4", ">4-12","Intact Female","Male","not_recorded")))
#neuter reason levels
cohort_abr2<- cohort_abr2%>%
mutate(neutered_reason = factor(neutered_reason, levels = c("Elective",  "Medical Reason", "Entire","Unknown","not_recorded")))
cohort_abr2 <- cohort_abr2%>%
mutate(mode_purina_BCS_5y_prior_endpoint = factor(mode_purina_BCS_5y_prior_endpoint, levels = c("5", "3", "4", "6","7","8","9","not_recorded")))
#change BCS to be over underweight
cohort_abr2 <- cohort_abr2 %>%
mutate(mode_BCS_classify = case_when(
mode_purina_BCS_5y_prior_endpoint == "1" ~"underweight",
mode_purina_BCS_5y_prior_endpoint == "2" ~"underweight",
mode_purina_BCS_5y_prior_endpoint == "3" ~"underweight",
mode_purina_BCS_5y_prior_endpoint == "4" ~"ideal",
mode_purina_BCS_5y_prior_endpoint == "5" ~"ideal",
mode_purina_BCS_5y_prior_endpoint == "6" ~"overweight",
mode_purina_BCS_5y_prior_endpoint == "7" ~"overweight",
mode_purina_BCS_5y_prior_endpoint == "8" ~"overweight",
mode_purina_BCS_5y_prior_endpoint == "9" ~"overweight",
mode_purina_BCS_5y_prior_endpoint == "not_recorded" ~"not_recorded",
))
#set age levels
cohort_abr2 <- cohort_abr2%>%
mutate(age_at_final_date_quartiles = factor(age_at_final_date_quartiles, levels = c("0.74-<8.47 years", ">=8.47-<10.68 years", ">=10.68-<11.64 years", ">=11.64-14.51 years")))
cohort_abr2 <- cohort_abr2%>%
mutate(age_at_final_date_bio = factor(age_at_final_date_bio, levels = c(">5-<8y","<5y",  ">8-<11y", ">11-<13y",">13y")))
cohort_abr2 <- cohort_abr2%>%
mutate(age_at_final_date_GB = factor(age_at_final_date_GB, levels = c(">7-<9y","<5y", ">5-<7y",  ">9-<11y",">11-<13y",">13y")))
#manually assign height, weight, BCS factor levles and age at neuter and age at diagnosis
#height
cohort_abr2 <- cohort_abr2%>%
mutate(avg_weight_5y_prior_endpoint_quartiles = factor(avg_weight_5y_prior_endpoint_quartiles, levels = c("12.47-<20.83kg", ">=20.83-<23.23kg", ">=23.23-26.98kg", ">=26.98-37.01","not_recorded")))
#cohort_abr2 <- cohort_abr2%>%
# mutate(avg_weight_5y_prior_endpoint_kg_biological = factor(avg_weight_5y_prior_endpoint_kg_biological, levels = c(">15-<=25kg","<15kg",">25-<=35kg",">35","not_recorded")))
#bcs
cohort_abr2 <- cohort_abr2%>%
mutate(avg_purina_BCS_5y_prior_endpoint_quartiles = factor(avg_purina_BCS_5y_prior_endpoint_quartiles, levels = c("3.3-<5", ">=5-<5.28", ">=5.28-<5.86", ">=5.86 - 9","not_recorded")))
#neut age
cohort_abr2<- cohort_abr2 %>%
mutate(age_at_neuter_years_quartiles = factor(age_at_neuter_years_quartiles, levels = c("0.15-<0.52y", ">=0.52-<0.83y", ">=0.83-2.44y", ">=2.44-9.59y","Entire","not_recorded")))
#diagnosis age
cohort_abr2 <- cohort_abr2%>%
mutate(age_at_final_date_quartiles = factor(age_at_final_date_quartiles, levels = c("0.74-<8.47 years", ">=8.47-<10.68 years", ">=10.68-<11.64 years", ">=11.64-14.51 years","not_recorded")))
#breed tercile levels
cohort_abr2 <- cohort_abr2%>%
mutate(num_breeding_before_neutering_terciles = factor(num_breeding_before_neutering_terciles, levels = c(">0-<3",">=3-<9",">=9-142","not_bred","not_recorded")))
cols_to_modify <- 145:193 # replace with your actual column indices
for (i in cols_to_modify) {
current_levels <- levels(cohort_abr2[[i]])
if ("no_medication_records_for_this_time_period" %in% current_levels) {
new_levels <- c(setdiff(current_levels, "no_medication_records_for_this_time_period"), "no_medication_records_for_this_time_period")
cohort_abr2[[i]] <- factor(cohort_abr2[[i]], levels = new_levels)
}
}
#need to set the activity splits into ordinal format
cohort_abr2 <- cohort_abr2%>%
mutate(avg_activity_freq_sy3_splits = factor(avg_activity_freq_sy3_splits, levels = c("rarely","monthly","weekly","daily","multi_daily","not_recorded")))
cohort_abr2 <- cohort_abr2%>%
mutate(avg_activity_freq_sy1_2_splits = factor(avg_activity_freq_sy1_2_splits, levels = c("never","less_than_weekly","min_weekly","daily","multi_daily","not_recorded")))
cohort_abr2 <- cohort_abr2%>%
mutate(avg_activity_duration_sy1_2_splits = factor(avg_activity_duration_sy1_2_splits, levels = c("less_than_30min","between_30_60_min","between_60_90_min","between_90_120_min","more_than_120_min","not_recorded")))
cohort_abr2 <- cohort_abr2%>%
mutate(avg_activity_intensity_sy3_splits = factor(avg_activity_intensity_sy3_splits, levels = c("slow_walks","average_walks","brisk_walks","jogs","runs","not_recorded")))
cohort_abr2 <- cohort_abr2%>%
mutate(avg_frequency_5y_prior_endpoint_splits = factor(avg_frequency_5y_prior_endpoint_splits, levels = c("rarely","monthly","weekly","daily","multi_daily","not_recorded")))
# Now run the function
univar_results <- univar_logistic_regression(cohort_abr2, "had_HSA", explanatory)
table(cohort_abr$had_HSA,cohort_abr$avg_weight_5y_prior_endpoint_kg_biological)
